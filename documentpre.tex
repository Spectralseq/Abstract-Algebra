\usepackage[utf8]{inputenc}
\usepackage[colorlinks,linkcolor=blue,hyperfootnotes=false]{hyperref}
\usepackage{graphicx}
\usepackage{multicol}
\usepackage{amsmath,amssymb,amsthm,amsfonts}
\usepackage{textgreek,bm,upgreek,mathrsfs}
\usepackage{array} %表格列宽操作
\usepackage{longtable} %表格列宽对齐
\usepackage{arydshln} %提供画线的虚线格式
%\usepackage{textcomp}
\usepackage{stmaryrd}
\expandafter\def\csname opt@stmaryrd.sty\endcsname
{only,shortleftarrow,shortrightarrow}
\usepackage{extpfeil}
\usepackage{extarrows}
\usepackage[bottom]{footmisc}
\usepackage{enumitem}
\usepackage{epigraph}
\usepackage[many]{tcolorbox}
\usepackage[english]{babel}
\usepackage[margin=1in]{geometry}
\usepackage{setspace}
\usepackage{microtype} 
\usepackage{float}
\usepackage[framemethod=tikz]{mdframed} 
\usepackage[tikz]{bclogo}
\usepackage{wrapfig}
\usepackage{color}
\usepackage{epigraph}
\usepackage[many]{tcolorbox}
\usepackage{tikz-cd}
\usepackage{tikz}
\usepackage{fancyhdr}
\usepackage{titlesec}%定义section的格式
\usepackage{tocloft}
\usepackage{titletoc}%定义目录样式
\usepackage{sectsty}%定义section的格式
\usepackage{booktabs}
\usepackage[
ordering=Kac,
edge-length=1cm,
root-radius=.06cm]{dynkin-diagrams}
\usepackage{bbold}
\usepackage[T1]{fontenc}
\usepackage{palatino}
\usepackage{newpxmath}
\usepackage{l3draw,xparse}
\usepackage{accents}%创建新的widetilde
\usepackage{scalerel} %放大数学字体
\usepackage{calligra,mathrsfs}%for sheaf Hom
\usepackage{mathtools}%def new widetilde

\usetikzlibrary{calc}
\linespread{1.15}
\SetSymbolFont{stmry}{bold}{U}{stmry}{m}{n}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{bending}
\geometry{left=2.5cm,right=2.5cm,top=3cm,bottom=3cm}
\pagestyle{fancy}
\setlength{\headheight}{15.0pt}
\fancyhf{}
\fancyhead[LE,RO]{\thepage}
\fancyhead[RE]{\bf\nouppercase{\rightmark}}
\fancyhead[LO]{\bf\nouppercase{\leftmark}}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
\renewcommand{\sectionautorefname}{\S}

\makeatletter%define roman numbers
\newcommand{\rmnum}[1]{\romannumeral #1}
\newcommand{\Rmnum}[1]{\expandafter\@slowromancap\romannumeral #1@}
\makeatother

\DeclareMathAlphabet{\mathbbb}{U}{bbold}{m}{n}
\DeclareMathAlphabet{\mathbb}{U}{msb}{m}{n}

%\titlecontents{chapter}% <section-type>增加Chapter到目录中
%  [0pt]% <left>
%  {\bfseries}% <above-code>
%  {\color{blue}\chaptername\ \thecontentslabel.\hspace{7pt}}% %<numbered-entry-format>
%  {}% <numberless-entry-format>
%  {\hfill\contentspage}% <filler-page-format>

%调整tikz箭头格式---------------------------------
\usetikzlibrary{arrows.meta} % not arrows, but arrows.meta
\tikzset{
  commutative diagrams/.cd,
  arrow style=tikz,
  diagrams={>={Computer Modern Rightarrow[length=4pt,width=3pt]}},
  diagrams={nodes={inner sep=2pt}}
}
%------------------------------------------------

%改变下标基线--------------------------------------
\usepackage{subdepth}
\begingroup
  \catcode`\_=\active
  \gdef_#1{\ensuremath{\sb{\smash{#1}}}}
\endgroup
\mathcode`\_=\string"8000
\catcode`\_=12
%%--------------------------------------------------

\chapterfont{\centering}%chapter居中
\sectionfont{\centering}%section居中

\def\C{\mathbb{C}}
\def\F{\mathbb{F}}
\def\K{\mathbb{K}}
\def\R{\mathbb{R}}
\def\A{\mathbb{A}}
\def\B{\mathbb{B}}
\def\Q{\mathbb{Q}}
\def\Z{\mathbb{Z}}
\def\N{\mathbb{N}}
\def\E{\mathrm{E}}
\def\T{\mathbb{T}}
\def\H{\mathbb{H}}
\def\V{\mathbb{V}}
\def\RP{\mathbb{RP}}
\def\CP{\mathbb{CP}}
\def\P{\mathbb{P}}
\def\X{\mathfrak{X}}
\def\Y{\mathfrak{Y}}
\def\m{\mathfrak{m}}
\def\n{\mathfrak{n}}
\def\p{\mathfrak{p}}
\def\q{\mathfrak{q}}
\def\a{\mathfrak{a}}
\def\b{\mathfrak{b}}
\def\c{\mathfrak{c}}
\def\g{\mathfrak{g}}
\def\h{\mathfrak{h}}
\def\d{\mathfrak{d}}
\def\s{\mathfrak{s}}
\def\z{\mathfrak{z}}
\def\l{\mathfrak{l}}
\def\r{\mathfrak{r}}
\def\t{\mathfrak{t}}
\def\f{\mathfrak{f}}
\def\x{\mathfrak{x}}

\def\k{\mathfrak{k}}

\def\st{\mathfrak{st}}
\def\aff{\mathfrak{aff}}
\def\GL{\mathrm{GL}}
\def\PGL{\mathrm{PGL}}
\def\SL{\mathrm{SL}}
\def\O{\mathrm{O}}
\def\SO{\mathrm{SO}}
\def\Sp{\mathrm{Sp}}
\def\U{\mathrm{U}}
\def\SU{\mathrm{SU}}
\def\gl{\mathfrak{gl}}
\def\sl{\mathfrak{sl}}
\def\o{\mathfrak{o}}
\def\so{\mathfrak{so}}
\def\u{\mathfrak{u}}
\def\su{\mathfrak{su}}

\def\dom{\mathrm{dom}}
\def\codom{\mathrm{codom}}
\def\End{\mathrm{End}}
\def\Hom{\mathrm{Hom}}
\def\Mor{\mathrm{Mor}}
\def\Obj{\mathrm{Obj}}
\def\Aut{\mathrm{Aut}}
\def\det{\mathrm{det}}
\def\ker{\operatorname{ker}}
\def\coker{\operatorname{coker}}
\def\im{\operatorname{im}}
\def\coim{\operatorname{coim}}
\def\id{\operatorname{id}}
\def\supp{\mathrm{supp}}
\def\conv{\mathrm{conv}}
\def\mult{\mathrm{mult}}
\def\Int{\operatorname{Int}}
\def\Homgr{\mathrm{Homgr}}
\def\Sh{\mathrm{Sh}}
\def\Lib{\mathrm{Lib}}
\def\Lie{\mathfrak{Lie}}
\def\Ad{\mathrm{Ad}}
\def\ad{\mathrm{ad}}
\def\Der{\mathrm{Der}}
\def\nil{\mathfrak{nil}}
\def\rad{\mathfrak{rad}}
\def\eff{\mathfrak{eff}}
\def\reg{\mathrm{reg}}
\def\aff{\mathfrak{aff}}
\def\div{\mathrm{div}}
\def\Sym{\mathrm{Sym}}
\def\Stab{\mathrm{Stab}}
\def\Tor{\mathrm{Tor}}
\def\Ext{\mathrm{Ext}}
\def\tr{\mathrm{tr}}
\def\pd{\mathrm{pd}}
\def\gr{\mathrm{gr}}
\def\lcm{\mathrm{lcm}}
\def\codim{\mathrm{codim}}
\def\gldim{\mathrm{gldim}}
\def\rank{\mathrm{rank}}
\def\char{\mathrm{char}}
\def\cl{\mathrm{cl}}
\def\Cl{\mathrm{Cl}}
\def\height{\mathrm{ht}}
\def\coht{\mathrm{coht}}
\def\depth{\mathrm{depth}}
\def\sgn{\mathrm{sgn}}
\def\res{\mathrm{res}}
\def\Res{\mathrm{Res}}
\def\Alt{\mathrm{Alt}}
\def\Gal{\mathrm{Gal}}
\def\Inv{\mathrm{Inv}}
\def\Inn{\mathrm{Inn}}
\def\Ann{\mathrm{Ann}}
\def\Ass{\mathrm{Ass}}
\def\Spec{\mathrm{Spec}}
\def\Spf{\mathrm{Spf}}
\def\Proj{\mathrm{Proj}}
\def\Max{\mathrm{Max}}
\def\Ind{\mathrm{Ind}}
\def\CoInd{\mathrm{CoInd}}
\def\Div{\mathrm{Div}}
\def\Pic{\mathrm{Pic}}
\def\sep{\mathrm{sep}}
\def\isep{\mathrm{isep}}
\def\Soc{\mathrm{Soc}}
\def\Rad{\mathrm{Rad}}
\def\red{\mathrm{red}}
\def\dev{\mathrm{dev}}
\def\opp{\mathrm{opp}}
\def\Nor{\mathrm{Nor}}
\def\Cyl{\mathrm{Cyl}}
\def\Cone{\mathrm{Cone}}
\def\Aff{\mathrm{Aff}}
\def\rat{\mathrm{rat}}

\def\sub{\subseteq}
\def\sups{\supseteq}
\def\emp{\varnothing}
\def\dcheck{\check{ }\hspace{4pt}\check{}}
\def\eps{\varepsilon}
\def\llim{\varprojlim\limits}
\def\rlim{\varinjlim\limits}
\def\And{\hspace{8pt}\text{and}\hspace{8pt}}
\def\for{\hspace{8pt}\text{for}\hspace{6pt}}


\renewcommand{\Re}{\operatorname{Re}}
\renewcommand{\Im}{\operatorname{Im}}
\renewcommand{\i}{\mathrm{i}}
\newcommand{\hash}{\raisebox{\depth}{\#}}

\DeclareMathOperator{\sHom}{\mathscr{H}\hspace*{-4.25pt}\mathscr{o\!m}}
\DeclareMathOperator{\sExt}{\mathscr{E}\hspace*{-2.6pt}\mathscr{x}\hspace*{-1pt}\mathscr{t}}
\DeclareMathOperator{\sEnd}{\mathscr{E}\hspace*{-2pt}\mathscr{n}\hspace*{-2.4pt}\mathscr{d}}
\DeclareMathOperator{\sProj}{\mathscr{P}\hspace*{-0.5pt}\textit{roj}}


\newcommand{\intprod}{\mathbin{\raisebox{\depth}{\scalebox{1}[-1]{$\lnot$}}}}%defining interior product

\newcommand{\bigw}{\scalebox{.95}[1]{\boldmath{$\bigwedge$}\hspace{-1pt}}}%define a nice wedge product


%调整图片和方程编号方式
\makeatletter
\@addtoreset{figure}{subsection}
\makeatother
\renewcommand{\thefigure}{\arabic{section}.\arabic{subsection}.\arabic{figure}}
\counterwithin*{figure}{subsection}

\renewcommand{\theequation}{\arabic{section}.\arabic{subsection}.\arabic{equation}}
\counterwithin*{equation}{subsection}



%---------------------------------------------------------
\makeatletter
\let\save@mathaccent\mathaccent
\newcommand*\if@single[3]{%
  \setbox0\hbox{${\mathaccent"0362{#1}}^H$}%
  \setbox2\hbox{${\mathaccent"0362{\kern0pt#1}}^H$}%
  \ifdim\ht0=\ht2 #3\else #2\fi
  }
%The bar will be moved to the right by a half of \macc@kerna, which is computed by amsmath:
\newcommand*\rel@kern[1]{\kern#1\dimexpr\macc@kerna}
%If there's a superscript following the bar, then no negative kern may follow the bar;
%an additional {} makes sure that the superscript is high enough in this case:
\newcommand*\widebar[1]{\@ifnextchar^{{\wide@bar{#1}{0}}}{\wide@bar{#1}{1}}}
%Use a separate algorithm for single symbols:
\newcommand*\wide@bar[2]{\if@single{#1}{\wide@bar@{#1}{#2}{1}}{\wide@bar@{#1}{#2}{2}}}
\newcommand*\wide@bar@[3]{%
  \begingroup
  \def\mathaccent##1##2{%
%Enable nesting of accents:
    \let\mathaccent\save@mathaccent
%If there's more than a single symbol, use the first character instead (see below):
    \if#32 \let\macc@nucleus\first@char \fi
%Determine the italic correction:
    \setbox\z@\hbox{$\macc@style{\macc@nucleus}_{}$}%
    \setbox\tw@\hbox{$\macc@style{\macc@nucleus}{}_{}$}%
    \dimen@\wd\tw@
    \advance\dimen@-\wd\z@
%Now \dimen@ is the italic correction of the symbol.
    \divide\dimen@ 3
    \@tempdima\wd\tw@
    \advance\@tempdima-\scriptspace
%Now \@tempdima is the width of the symbol.
    \divide\@tempdima 10
    \advance\dimen@-\@tempdima
%Now \dimen@ = (italic correction / 3) - (Breite / 10)
    \ifdim\dimen@>\z@ \dimen@0pt\fi
%The bar will be shortened in the case \dimen@<0 !
    \rel@kern{0.6}\kern-\dimen@
    \if#31
      \overline{\rel@kern{-0.6}\kern\dimen@\macc@nucleus\rel@kern{0.4}\kern\dimen@}%
      \advance\dimen@0.4\dimexpr\macc@kerna
%Place the combined final kern (-\dimen@) if it is >0 or if a superscript follows:
      \let\final@kern#2%
      \ifdim\dimen@<\z@ \let\final@kern1\fi
      \if\final@kern1 \kern-\dimen@\fi
    \else
      \overline{\rel@kern{-0.6}\kern\dimen@#1}%
    \fi
  }%
  \macc@depth\@ne
  \let\math@bgroup\@empty \let\math@egroup\macc@set@skewchar
  \mathsurround\z@ \frozen@everymath{\mathgroup\macc@group\relax}%
  \macc@set@skewchar\relax
  \let\mathaccentV\macc@nested@a
%The following initialises \macc@kerna and calls \mathaccent:
  \if#31
    \macc@nested@a\relax111{#1}%
  \else
%If the argument consists of more than one symbol, and if the first token is
%a letter, use that letter for the computations:
    \def\gobble@till@marker##1\endmarker{}%
    \futurelet\first@char\gobble@till@marker#1\endmarker
    \ifcat\noexpand\first@char A\else
      \def\first@char{}%
    \fi
    \macc@nested@a\relax111{\first@char}%
  \fi
  \endgroup
}
\makeatother
%---------------------------------------------------------

%---------------------------------------------------------
\ExplSyntaxOn%defining shuffle prodcut
\fp_new:N \l__expl_shuffle_fp
\cs_new_protected:Nn \expl_shuffle:
 {
  \draw_begin:
  \draw_linewidth:n { \l__expl_shuffle_fp }
  \draw_cap_round:
  \draw_join_round:
  \draw_path_moveto:n { 0.0ex , 1.0ex }
  \draw_path_lineto:n { 0.0ex , 0.0ex }
  \draw_path_lineto:n { 1.75ex , 0.0ex }
  \draw_path_lineto:n { 1.75ex , 1.0ex }
  \draw_path_use_clear:n { stroke }
  \draw_path_moveto:n { 0.875ex , 0.0ex }
  \draw_path_lineto:n { 0.875ex , 1.0ex }
  \draw_path_use_clear:n { stroke }
  \draw_end:
 }
\NewDocumentCommand{\shuffle}{}
 {
  \mathrel
   {
    \fp_set:Nn \l__expl_shuffle_fp { 0.08ex }
    \text{$\mspace{1mu}$ \expl_shuffle: $\mspace{1mu}$}
   }
 }
\ExplSyntaxOff 
%---------------------------------------------------------


%定义bighat----------------------------------------------------
\makeatletter
\def\pgf@stroke@inner@line{%
  \let\pgf@temp@save=\pgf@strokecolor@global
  \pgfsys@beginscope%
  {%
    \pgfsys@roundcap% <-- I add this
    \pgfsys@setlinewidth{\pgfinnerlinewidth}%
    \pgfsetstrokecolor{\pgfinnerstrokecolor}%
    \pgfsyssoftpath@invokecurrentpath%
    \pgfsys@stroke%
  }%
  \pgfsys@endscope%
  \global\let\pgf@strokecolor@global=\pgf@temp@save
}
\makeatother

\DeclareMathSymbol{\widetildesym}{\mathord}{largesymbols}{"65}
    \newcommand\lowerwidetildesym{%
      \text{\smash{\raisebox{-1.3ex}{%
        $\widetildesym$}}}}
            \newcommand\bigtilde[1]{%
              \mathchoice
                {\accentset{\displaystyle\lowerwidetildesym}{#1}}
        {\accentset{\textstyle\lowerwidetildesym}{#1}}
        {\accentset{\scriptstyle\lowerwidetildesym}{#1}}
        {\accentset{\scriptscriptstyle\lowerwidetildesym}{#1}}
}%定义bigtilde

\DeclareMathSymbol{\widehatsym}{\mathord}{largesymbols}{"62}
    \newcommand\lowerwidehatsym{%
      \text{\smash{\raisebox{-1.3ex}{%
        $\widehatsym$}}}}
            \newcommand\bighat[1]{%
              \mathchoice
                {\accentset{\displaystyle\lowerwidehatsym}{#1}}
        {\accentset{\textstyle\lowerwidehatsym}{#1}}
        {\accentset{\scriptstyle\lowerwidehatsym}{#1}}
        {\accentset{\scriptscriptstyle\lowerwidehatsym}{#1}}
}
%--------------------------------------------------------------

%定义graded ring的正部和负部-------------------------------------------------------
\newcommand\lpar[2]{{{#1}_{\!#2}}^{\hspace*{-5pt}\substack{\leqslant\\[-0.6ex]~}}}
\newcommand\rpar[2]{{{#1}_{\!#2}}^{\hspace*{-5pt}\substack{\geqslant\\[-0.6ex]~}}}
%---------------------------------------------------------------------------------

