\chapter{\texorpdfstring{$D$}{D}-modules and perverse sheaves}
\section{Elementary properties of \texorpdfstring{$D$}{D}-modules}
In this section we introduce several standard operations for $D$-modules over smooth algebraic varieties over $\C$ and present some fundamental results concerning them such as Kashiwara's equivalence theorem. Our main reference is \cite{hotta_Dmodule}.
\subsection{Differential operators}
Let $X$ be a smooth (non-singular) algebraic variety over the complex number field $\C$ and $\mathscr{O}_X$ be the sheaf of rings of regular functions (structure sheaf) on it. We denote by $\Theta_X$ the \textbf{sheaf of vector fields} (\textbf{tangent sheaf}) on $X$:
\begin{align*}
\Theta_X&=\sDer_{\C_X}(\mathscr{O}_X)=\sHom_{\mathscr{O}_X}(\Omega_X^1,\mathscr{O}_X)\\
&=\{P\in\sEnd_{\C_X}(\mathscr{O}_X):\text{$P(fg)=P(f)g+fP(g)$ for $f,g\in\mathscr{O}_X$}\}.
\end{align*}
Hereafter, if there is no risk of confusion, we use the notation $f\in\mathscr{O}_X$ for a local section $f$ of $\mathscr{O}_X$. Since $X$ is smooth, the sheaf $\Theta_X$ is locally free of rank $n=\dim(X)$ over $\mathscr{O}_X$. We will identify $\mathscr{O}_X$ with a subsheaf of $\sEnd_{\C_X}(\mathscr{O}_X)$ by identifying $f\in\mathscr{O}_X$ with $()\in\sEnd_{\C_X}(\mathscr{O}_X)$. We define the sheaf $\mathscr{D}_X$ of \textbf{differential operators} on $X$ as the subalgebra of $\sEnd_{\C_X}(\mathscr{O}_X)$ generated by $\mathscr{O}_X$ and $\Theta_X$. For any point of $X$ we can take its affine open neighborhood $U$ and a local coordinate system $\{x_i,\partial_i\}$ on it satisfying
\[x_i\in\mathscr{O}_X(U),\quad \Theta_U=\bigoplus_{i=1}^{n}\mathscr{O}_U\partial_i,\quad [\partial_i,\partial_j]=0,\quad [\partial_i,x_j]=\delta_{ij}.\]
Hence we have 
\[\mathscr{D}_U=\mathscr{D}_X|_U=\bigoplus_{\alpha\in\N^n}\mathscr{O}_U\partial^\alpha.\]
The ring $\mathscr{D}_X$ is generated by $\mathscr{O}_X$ and $\Theta_X$, and their fundamental relations are the following:
\begin{itemize}
    \item $\mathscr{O}_X\to\mathscr{D}_X$ is a ring homomorphism.
    \item $\Theta_X\to\mathscr{D}_X$ is left $\mathscr{O}_X$-linear.
    \item $\Theta_X\to\mathscr{D}_X$ is a Lie algebra homomorphism.
    \item $[v,f]=v(f)$ for $v\in\Theta_X$ and $f\in\mathscr{O}_X$.
\end{itemize}
where we denote by $v(f)$ the element of $\mathscr{O}_X$ obtained by differentiating $f$ with respect to $v$. To be more precise, we formulate the above as follows:

\begin{proposition}\label{D-module ring D_X generating relation}
Let $\mathscr{A}$ be a sheaf of rings on $X$, and $\iota:\mathscr{O}_X\to\mathscr{A}$, $\varphi:\Theta_X\to\mathscr{A}$ be sheaf morphisms such that
\begin{enumerate}
    \item[(a)] $\iota:\mathscr{O}_X\to\mathscr{A}$ is a ring homomorphism;
    \item[(b)] $\varphi:\Theta_X\to\mathscr{A}$ is left $\mathscr{O}_X$-linear;
    \item[(c)] $\varphi:\Theta_X\to\mathscr{A}$ is a Lie algebra homomorphism;
    \item[(d)] $[\varphi(v),\iota(f)]=\iota(v(f))$ for $v\in\Theta_X$, $f\in\mathscr{O}_X$.
\end{enumerate}
Then there exists a unique ring homomorpism $\Phi:\mathscr{D}_X\to\mathscr{A}$ such that the following diagram is commutative:
\[\begin{tikzcd}
\mathscr{O}_X\ar[d]\ar[rd,"\iota"]\\
\mathscr{D}_X\ar[r,"\Phi"]&\mathscr{A}\\
\Theta_X\ar[u]\ar[ru,swap,"\varphi"]
\end{tikzcd}\]
\end{proposition}
\begin{proof}
Since the question is local, we can choose local coordinate system, so by the assumptions on $\iota$ and $\varphi$, we have
\[\Phi(\sum c_\alpha\partial^\alpha)=\sum_\alpha \iota(c_\alpha)\varphi(\partial_1^{\alpha_1})\cdots\varphi(\partial_n^{\alpha_n}).\]
Conversely, if we define $\Phi$ as above, then it is easy to see that $\Phi$ is a ring homomorphism.
\end{proof}

The ring $\mathscr{D}_X$ is non-commutative, so the study of its structure is more complicated than algebraic geometry (the study of commutative rings). However, we can derive objects in the theory of commutative algrbra from $\mathscr{D}_X$ as follows.\par
Let $U$ be an affine open subset of $X$ with local coordinates $\{x_i,\partial_i\}$. For a differential operator $P=\sum a_\alpha\partial^\alpha$, the \textbf{total symbol} of $P$ is defined to be
\[\sigma(P)(x,\xi):=\sum a_\alpha(x)\xi^\alpha.\]
This is a function in $(x,\xi)=(x_1,\dots,x_n,\xi_1,\dots,\xi_n)$, which depends on the choice of a coordinate system. Let $Q=\sum b_\alpha \partial^\alpha$ be another differential operator and $\sigma(Q)(x,\xi)=\sum b_\alpha(x)\xi^\alpha$ be its total symbol, then the total symbol of $PQ$ is given by the formula
\begin{equation}\label{D-module total symbol of composition Leibniz rule}
\sigma(PQ)(x,\xi)=\sum_\alpha\frac{1}{\alpha!}\partial^\alpha_\xi\sigma(P)(x,\xi)\cdot\partial^\alpha_x\sigma(Q)(x,\xi).
\end{equation}
Since $\sigma(P)(x,\xi)$ is a polynomial in $\xi$, we have $\partial^\alpha_\xi\sigma(P)(x,\xi)=0$ except for finitely many $\alpha$, and thus the right hand side of (\ref{D-module total symbol of composition Leibniz rule}) is a finite sum over $\alpha$, and it is easily deduced from Leibniz's rule
\begin{equation}\label{D-module higher differential Leibniz rule}
\partial^\alpha(fg)=\sum_\beta\binom{\alpha}{\beta}(\partial^\beta f)(\partial^{\alpha-\beta}g).
\end{equation}
We now define an order filtration $F_p(\mathscr{D}_X)$ of $\mathscr{D}_X$ by
\[F_p(\mathscr{D}_X)=\{P\in\mathscr{D}_X:\text{$P=\sum_{|\alpha|\leq p}a_\alpha \partial^\alpha$}\}.\]
Although this definition uses a coordinate system, the following proposition shows that it does not depend on the choice of this coordinate system.
\begin{proposition}\label{D-module ring D_X filtration prop}
We have $F_p(\mathscr{D}_X)=0$ for $p<0$, and for $p\geq 0$, 
\[F_p(\mathscr{D}_X)=\{P\in\mathscr{D}_X:[P,\mathscr{O}_X]\sub F_{p-1}(\mathscr{D}_X)\}.\]
Moreover, $F_0(\mathscr{D}_X)=\mathscr{O}_X$ and $F_1\mathscr{D}_X=\mathscr{O}_X\oplus\Theta_X$.
\end{proposition}
\begin{proof}
If locally we write $P=\sum_\alpha a_\alpha\partial^\alpha$ and $f\in\mathscr{O}_X$, then the operator $[P,f]$ is given by
\begin{align*}
[P,f](g)&=P(fg)-fP(g)=\sum_\alpha\Big[a_\alpha\sum_\beta\binom{\alpha}{\beta}(\partial^\beta f)(\partial^{\alpha-\beta}g)-fa_\alpha(\partial^\alpha g)\Big]\\
&=\sum_{\alpha}a_\alpha\sum_{0\prec \beta\preceq\alpha}\binom{\alpha}{\beta}(\partial^\beta f)(\partial^{\alpha-\beta}g),
\end{align*}
which shows that $[P,\mathscr{O}_X]$ belongs to $F_{p-1}\mathscr{D}_X$ if and only if $P\in F_p(\mathscr{D}_X)$.
\end{proof} 

\begin{proposition}\label{D-module ring D_X filtration commutator prop}
The collection $\{F_p(\mathscr{D}_X)\}$ is an exhaustive increasing filtration of $\mathscr{D}_X$ and each $F_p(\mathscr{D}_X)$ is a locally free module over $\mathscr{O}_X$. Moreover, we have
\[(F_p(\mathscr{D}_X))(F_q(\mathscr{D}_X))=F_{p+q}(\mathscr{D}_X),\quad [F_p(\mathscr{D}_X),F_q(\mathscr{D}_X)]\sub F_{p+q-1}\mathscr{D}_X.\]
\end{proposition}
\begin{proof}
The first assertion is clear, and the second one can be checked locally. In fact, let $P\in F_p(\mathscr{D}_X)$ and $Q\in F_q(\mathscr{D}_X)$ be two differential operators and write $\sigma_j(W)=\sum_{|\alpha|=j}c_\alpha(x)\xi^\alpha$ for a differential operator $W$. We then have
\begin{equation}\label{D-module ring D_X filtration commutator prop-1}
\begin{aligned}
\sigma(PQ)=&\sigma_p(P)\sigma_q(Q)+\Big(\sigma_{p-1}(P)\sigma_q(Q)+\sigma_p(P)\sigma_{q-1}(Q)+\sum_i\frac{\partial \sigma_p(P)}{\partial\xi_i}\frac{\partial \sigma_q(Q)}{\partial x_i}\Big)\\
&+\text{terms of degree less than $p+q-1$ in $\xi$},
\end{aligned}
\end{equation}
whence the assertions.
\end{proof}

Let us now consider the graded ring
\[\gr(\mathscr{D}_X)=\bigoplus_{p=0}^{\infty}\gr_p(\mathscr{D}_X).\]
By \cref{D-module ring D_X filtration commutator prop}, this is a sheaf of commutative algebras of finite type over $\mathscr{O}_X$. Since $\gr_0(\mathscr{D}_X)=\mathscr{O}_X$ and $\gr_1(\mathscr{D}_X)=\Theta_X$, we obtain an $\mathscr{O}_X$-algebra homomorphism
\begin{equation}\label{D-module ring D_X graded ring isomorphism}
\bm{S}_{\mathscr{O}_X}(\Theta_X)\to\gr(\mathscr{D}_X)
\end{equation}
Take an affine chart $U$ with a coordinate system $\{x_i,\partial_i\}$ and set $\xi_i:=\partial_i$ mod $F_0\mathscr{D}_U=\mathscr{O}_U$, we then have
\[\gr(\mathscr{D}_U)=\mathscr{O}_U[\xi_1,\dots,\xi_n],\]
so the homomorphism (\ref{D-module ring D_X graded ring isomorphism}), which is given by $\xi^\alpha\mapsto\partial^\alpha$, is an isomorphism. We denote by $\sigma_p$ the homomorphism defined by
\[\sigma_p:F_p(\mathscr{D}_X)\to \gr_p(\mathscr{D}_X)\sub \gr(\mathscr{D}_X)\cong \bm{S}_{\mathscr{O}_X}(\Theta_X).\]
By using local coordinates, we have
\[\sigma_p(P)=\sum_{|\alpha|=p}a_\alpha(x)\xi^\alpha\in \bm{S}_{\mathscr{O}_X}^p(\Theta_X)\]
for $P=\sum_\alpha a_\alpha\partial^\alpha$. The corresponding section $\sigma_p(P)$ is called the \textbf{principal symbol} of $P$.

\begin{proposition}\label{D-module section ring of D_X is Noe}
Assume that $A=\mathscr{D}_X(U)$ for some affine open subset $U$ of $X$ or $A=\mathscr{D}_{X,x}$ for some $x\in X$. Then $A$ is a left (and right) Noetherian ring.
\end{proposition}
\begin{proof}
We have seen that $A$ admits a Hausdorff and complete filtration so that the associated graded ring is (commutative and) Noetherian. The assertion thus follows from \cref{filtration complete ring gr(A) Noe imply A Noe}.
\end{proof}

We have thus succeeded to derive an element of the commutative algebra $\bm{S}_{\mathscr{O}_X}(\Theta_X)$, namely the principal symbol, from a differential operator. Although the principal symbol is only a part of a differential operator (indeed, it is the part of the highest degree of the total symbol), it carries a great deal of information on $\mathscr{D}_X$, as seen in the following.\par

Let $\pi:T^*X\to X$ denote the cotangent bundle of $X$. Then we may regard $\xi_1,\dots,\xi_n$ as the coordinate system of the cotangent space $\bigoplus_{i=1}^{n}\C dx_i$, and hence $\bm{S}_{\mathscr{O}_X}(\Theta_X)$ is canonically identified with the sheaf $\pi_*(\mathscr{O}_{T^*X})$. A section of $\bm{S}_{\mathscr{O}_X}(\Theta_X)$ can therefore be regarded as a function on $T^*X$. If $P\in D_p\mathscr{D}_X$ and $Q\in D_q\mathscr{D}_X$, then $[P,Q]\in D_{p+q-1}\mathscr{D}_X$, so the commutator induces a multiplication map on $\gr(\mathscr{D}_X)$. This can be explicitly calculated by equation (\ref{D-module ring D_X filtration commutator prop-1}) in local coordinates:
\begin{equation}\label{D-module ring D_X graded ring multiplication-1}
\sigma_{p+q-1}([P,Q])=\sum_i\Big(\frac{\partial \sigma_p(P)}{\partial\xi_i}\frac{\partial\sigma_q(Q)}{\partial x_i}-\frac{\partial \sigma_q(Q)}{\partial\xi_i}\frac{\partial\sigma_p(P)}{\partial x_i}\Big).
\end{equation}
Now for two function $f,g$ in $x$ and $\xi$, the \textbf{Possion bracket} of $f$ and $g$ is defined by
\begin{equation}\label{D-module ring D_X graded ring multiplication-2}
\{f,g\}=\sum_i\Big(\frac{\partial f}{\partial\xi_i}\frac{\partial g}{\partial x_i}-\frac{\partial g}{\partial\xi_i}\frac{\partial f}{\partial x_i}\Big).
\end{equation}
With the notation, we can then write (\ref{D-module ring D_X graded ring multiplication-1}) into the following form:
\begin{equation}\label{D-module ring D_X graded ring multiplication-3}
\sigma_{p+q-1}([P,Q])=\{\sigma_p(P),\sigma_q(Q)\}.
\end{equation}
Considering $f$ and $g$ as functions on $T^*X$, we see that $\{\cdot,\cdot\}$ is independent of the choice of a local coordinate system as below. We have a canonical $1$-form $\omega_X$ on $T^*X$. For every point $p\in T^*X$, a $1$-form $\omega_p$ at a point $\pi(p)$ of $X$ is determined by the definition of $T^*X$. The canonical $1$-form $\omega_X$ is then defined by $\omega_X(p)=\pi^*\omega_p$. In local coordinates, we have
\[\omega_X=\sum_i\xi_idx_i.\]
At each point $p$, the $2$-form $\theta_X=d\omega_X$ gives an anti-symmetric bilinear form on $T_p(T^*X)$, which is nondegenerate and induces an isomorphism $H:T_p^*(T^*X)\cong T_p(T^*)X$ by
\[\theta_X(v,H(\eta))=\langle\eta,v\rangle,\quad \eta\in T_p^*(T^*X),v\in T_p(T^*X).\]
Explicitly in local coordinates, the isomorphism $H$ is given by
\begin{equation}\label{D-module Hamiltonian on T^*X formula}
H:T_p^*(T^*X)\cong T_p(T^*)X,\quad d\xi_i\mapsto\partial/\partial_i,dx_i\mapsto -\partial/\partial\xi_i.
\end{equation}
In particular, $H_f=H(df)$ is a vector field on $T^*X$ for any function $f$ on $T^*X$; this is called the \textbf{Hamiltonian} of $f$.

\begin{definition}
For functions $f,g$ on $T^*X$, the \textbf{Poisson bracket} of $f$ and $g$ is defined to be $\{f,g\}=H_f(g)$.
\end{definition}

By (\ref{D-module Hamiltonian on T^*X formula}), the Possion bracket $\{\cdot,\cdot\}$ is expressed as (\ref{D-module ring D_X graded ring multiplication-2}) in local coordinates so it is determined by $(T^*X,\theta_X)$. A pair $(M,\theta)$ of a manifold $M$ and a closed $2$-form $\theta$ on $M$ is called a \textbf{symplectic manifold} if $\theta$ is a nondegenerate anti-symmetric bilinear form on $T_pM$ for every $p$. For such a manifold, we can define a Possion bracket in the same way as above, and this is a notion depending on the symplectic structure of $M$. By tracing back the above arguments, we can determine a $2$-form from the Poisson bracket.\par
In the formula (\ref{D-module ring D_X graded ring multiplication-3}), the commutator of $\mathscr{D}_X$ expresses the noncommutatitity of $\mathscr{D}_X$. Hence, symbolically speaking, the noncommutatitity of $\mathscr{D}_X$ determines a symplectic structure of $T^*X$.

\subsection{\texorpdfstring{$D$}{D}-modules}
Let $X$ be a smooth algebraic variety. We say that a sheaf $\mathscr{M}$ on $X$ is a left $\mathscr{D}_X$-module if $\Gamma(U,\mathscr{M})$ is endowed with a left $\Gamma(U,\mathscr{D}_X)$-module structure for each open subset $U$ of $X$ and these actions are compatible with restriction morphisms. Note that $\mathscr{O}_X$ is a left $\mathscr{D}_X$-module via the canonical action of $\mathscr{D}_X$. We have the following very easy (but useful) interpretation of the notion of left $\mathscr{D}_X$-modules.
\begin{lemma}\label{D-module iff flat connection}
Let $\mathscr{M}$ be an $\mathscr{O}_X$-module. Giving a left $\mathscr{D}_X$-module structure on $\mathscr{M}$ extending the $\mathscr{O}_X$-module structure is equivalent to giving a $\C$-linear morphism
\[\nabla:\Theta_X\to\sEnd_\C(\mathscr{M}),\quad v\mapsto\nabla_v\]
satisfying the following conditions:
\begin{enumerate}
    \item[(a)] $\nabla_{fv}(s)=f\nabla_v(s)$ for $f\in\mathscr{O}_X$, $v\in\Theta_X$, $s\in M$;
    \item[(b)] $\nabla_v(fs)=v(f)s+f\nabla_v(s)$ for $f\in\mathscr{O}_X$, $v\in\Theta_X$, $s\in M$;
    \item[(c)] $\nabla_{[v,w]}(s)=[\nabla_v,\nabla_w](s)$ for $v,w\in\Theta_X$, $s\in M$.
\end{enumerate}
In terms of $\nabla$ the left $\mathscr{D}_X$-module structure on $\mathscr{M}$ is given by $v\cdot s=\nabla_v(s)$ for $v\in\Theta_X$, $s\in\mathscr{M}$.
\end{lemma}
\begin{proof}
The proof is immediate, because $\mathscr{D}_X$ is generated by $\mathscr{O}_X$, $\Theta_X$ and satisfies the relation $[v,f]=v(f)$.
\end{proof}

For a locally free left $\mathscr{O}_X$-module $\mathscr{M}$ of finite rank, a $\C$-linear morphism $\nabla:\Theta_X\to\sEnd_\C(\mathscr{M})$ satisfying the conditions (a), (b) is usually called a \textbf{connection} (of the corresponding vector bundle). If it also satisfies the condition (c), it is called an \textbf{integrable} (or \textbf{flat}) \textbf{connection}. Hence we may regard a (left) $\mathscr{D}_X$-module as an integrable connection of an $\mathscr{O}_X$-module which is not necessarily locally free of finite rank. We say that a $\mathscr{D}_X$-module $\mathscr{M}$ is an \textbf{integrable connection} if it is locally free of finite rank over $\mathscr{O}_X$, and we denote by $\Conn(X)$ the category of integrable connections on $X$. Integrable connections are the most elementary left $D$-modules. Nevertheless, they are especially important because they generate (in a categorical sense) the category of holonomic systems, as we see later.

\begin{example}[\textbf{Ordinary Differential Equations}]
Consider an ordinary differential operator
\[P=a_n(x)\partial^n+\cdots+a_0(x),\quad \partial=d/dx,a_i\in\mathscr{O}_\C\]
on $\C$ and the corrresponding $\mathscr{D}_\C$-module $\mathscr{M}=\mathscr{D}_\C/\mathscr{D}_\C P=\mathscr{D}_\C u$, where $u\equiv 1$ mod $\mathscr{D}_\C P$, and hence $Pu=0$. Then on $U=\{x\in\C:a_n(x)\neq 0\}$ we have $\mathscr{M}|_U\cong\bigoplus_{i=0}^{n-1}\mathscr{O}_Uu_i$ (where $u_i=\partial^iu$), so $\mathscr{M}$ is an integrable connection of rank $n$ on $U$. 
\end{example}
\paragraph{Differential homomorphisms}
Let $X$ be a smooth algebraic variety and $\mathscr{M},\mathscr{N}$ be $\mathscr{O}_X$-modules. A $\C$-linear sheaf homomorphism $\varphi:\mathscr{M}\to\mathscr{N}$ is called a \textbf{differential homomorphism} if for every $s\in\mathscr{M}$ there exists finitely many $P_i\in\mathscr{D}_X$ and $v_i\in\mathscr{N}$ such that
\[\varphi(fs)=\sum_iP_i(f)v_i\]
for any $f\in\mathscr{O}_X$. In other words, $\varphi$ is a differential homomorphism if it can be generated by differential operators. Let $\sDiff(\mathscr{M},\mathscr{N})$ be the the sheaf of differential homomorphisms from $\mathscr{M}$ to $\mathscr{N}$. From our definition, it is clear that $\mathscr{D}_X=\sDiff(\mathscr{O}_X,\mathscr{O}_X)$.

\begin{lemma}\label{D-module differential homomorphism composition}
Let $\mathscr{M},\mathscr{N},\mathscr{H}$ be $\mathscr{O}_X$-modules and $\varphi:\mathscr{M}\to\mathscr{N}$, $\psi:\mathscr{N}\to\mathscr{H}$ be differential homomorphisms. Then $\psi\circ\varphi:\mathscr{M}\to\mathscr{N}$ is also a differential homomorphism.
\end{lemma}
\begin{proof}
By definition, for every $s\in\mathscr{M}$, there exists $P_i,Q_j\in\mathscr{D}_X$ and $v_i\in\mathscr{N}$, $w_{ij}\in\mathscr{H}$ such that
\[\varphi(fs)=\sum_iP_i(f)v_i,\quad \psi(gv_i)=\sum_jQ_j(g)w_{ij}.\]
It then follows that
\[(\psi\circ\varphi)(fs)=\psi\Big(\sum_iP_i(f)v_i\Big)=\sum_ijQ_i(P_i(f))w_{ij}\]
so $\psi\circ\varphi$ is also a differential homomorphism.
\end{proof}

Let us consider the right $\mathscr{D}_X$-module $\mathscr{N}\otimes_{\mathscr{O}_X}\mathscr{D}_X$ for an $\mathscr{O}_X$-module $\mathscr{N}$. The right $\mathscr{D}_X$-module structure gives $\mathscr{N}\otimes_{\mathscr{O}_X}\mathscr{D}_X$ an $\mathscr{O}_X$-module structure. By tensoring $\mathscr{N}$ with the left $\mathscr{O}_X$-linear homomorphism\footnote{This is in fact the projection from $\mathscr{D}_X$ to $\mathscr{O}_X$, which is the identity on $\mathscr{O}_X$ and zero on $\Theta_X$.}
\[\mathscr{D}_X\to\mathscr{O}_X,\quad P\mapsto P(1)\in\mathscr{O}_X,\]
we obtain a $\C$-linear homomorphism (which is not $\mathscr{O}_X$-linear)
\[P_\mathscr{N}:\mathscr{N}\otimes_{\mathscr{O}_X}\mathscr{D}_X\to\mathscr{N}\]
which induces a map
\[\sHom_{\mathscr{O}_X}(\mathscr{M},\mathscr{N}\otimes_{\mathscr{O}_X}\mathscr{D}_X)\to \sHom_{\C}(\mathscr{M},\mathscr{N}),\quad \varphi\mapsto P_\mathscr{N}\circ\varphi.\]
If $\varphi(s)=\sum_iv_i\otimes P_i$ for $s\in\mathscr{M}$, then we have
\[P_\mathscr{N}\circ\varphi(fs)=\sum_iP_i(f)v_i.\]
Therefore, we see that $P_\mathscr{N}\circ\varphi$ is a differential homomorphism.

\begin{proposition}\label{D-module differential module char}
The homomorphism $\sHom_{\mathscr{O}_X}(\mathscr{M},\mathscr{N}\otimes_{\mathscr{O}_X}\mathscr{D}_X)\to\sDiff(\mathscr{M},\mathscr{N})$ is an isomorphism.
\end{proposition}
\begin{proof}
We first prove the proposition for $\mathscr{M}=\mathscr{O}_X$. By taking a coordinate system $\{x_i,\partial_i\}$, we have $\mathscr{N}\otimes_{\mathscr{O}_X}\mathscr{D}_X\cong\bigoplus_\alpha\mathscr{N}\otimes\partial^\alpha$, and
\[\sHom_{\mathscr{O}_X}(\mathscr{O}_X,\mathscr{N}\otimes_{\mathscr{O}_X}\mathscr{D}_X)\cong \bigoplus_\alpha\mathscr{N}\otimes\partial^\alpha.\]
Let $\mathscr{K}$ be the kernel of the homomorphism in question, and put
\[F_p\mathscr{K}=\{\sum v_\alpha\otimes\partial^\alpha\in\mathscr{K}:\text{$v_\alpha=0$ for $|\alpha|>p$}\}.\]
Then we have $\mathscr{K}=\bigcup_pF_p\mathscr{K}$, so it suffices to prove inductively that $F_p\mathscr{K}=0$ for each $p\geq 0$. Let $\sum v_\alpha\otimes\partial^\alpha\in F_p\mathscr{K}$; then we have $\sum(\partial^\alpha f)v_\alpha=0$ for any $f\in\mathscr{O}_X$. First we see that $F_0\mathscr{K}=0$ for $f=1$, so assume that $p>0$ and $F_{p-1}\mathscr{K}=0$. For each fixed integer $i$, by replacing $f$ with $x_if$, we have
\begin{align*}
0=\sum \partial^\alpha(x_if)v_\alpha-\sum x_i(\partial^\alpha f)v_\alpha=\sum_{\alpha_i>0}(\partial^{\alpha-\delta_i}f)v_\alpha,
\end{align*}
where $\delta_i$ is the $i$-th unit vector $(0,\dots,1,\dots,0)$. The induction hypothesis leads to $v_\alpha=0$ for $\alpha_i>0$. Fianlly, we also see that $v_0=0$, since $v_0\otimes\partial^0\in F_0\mathscr{K}=0$.\par
On the other hand, if $\varphi\in\sDiff(\mathscr{O}_X,\mathscr{N})$ and $\varphi(f)=\sum_iP_i(f)v_i$, then $\varphi=P_\mathscr{N}\circ\tilde{\varphi}$ with $\tilde{\varphi}(1)=\sum v_i\otimes P_i$.\par
We have thus proved the proposition in the case when $\mathscr{M}=\mathscr{O}_X$. For the general case, let $\varphi\in\sDiff(\mathscr{M},\mathscr{N})$; since the map $\mathscr{O}_X\ni f\mapsto\varphi(fs)$ belongs to $\sDiff(\mathscr{O}_X,\mathscr{N})$ for every $s\in\mathscr{M}$, there exists a unique homomorphism $\tilde{\varphi}(s)\in\mathscr{N}\otimes_{\mathscr{O}_X}\mathscr{D}_X$ satisfying
\[P_\mathscr{N}(\tilde{\varphi}(s)f)=\varphi(fs),\quad f\in\mathscr{O}_X.\]
It is immediate that $\tilde{\varphi}\in\sHom(\mathscr{M},\mathscr{N}\otimes_{\mathscr{O}_X}\mathscr{D}_X)$ is $\mathscr{O}_X$-linear. If $\psi\in\sHom(\mathscr{M},\mathscr{N}\otimes_{\mathscr{O}_X}\mathscr{D}_X)$ satisfies $P_\mathscr{N}\circ\psi=0$, then for every $s\in\mathscr{M}$ we have $P_\mathscr{N}\psi(fs)=0$ for $f\in\mathscr{O}_X$, and therefore $\psi(s)=0$.
\end{proof}

\begin{corollary}\label{D-module differential module char by Hom of tensor}
There is a canonical isomorphism
\[\sHom_{\mathscr{D}_X^{\op}}(\mathscr{M}\otimes_{\mathscr{O}_X}\mathscr{D}_X,\mathscr{N}\otimes_{\mathscr{O}_X}\mathscr{D}_X)\stackrel{\sim}{\to} \sDiff(\mathscr{M},\mathscr{N}).\]
\end{corollary}
\begin{proof}
It suffices to note that
\begin{equation*}
\sHom_{\mathscr{D}_X^{\op}}(\mathscr{M}\otimes_{\mathscr{O}_X}\mathscr{D}_X,\mathscr{N}\otimes_{\mathscr{O}_X}\mathscr{D}_X)\cong \sHom_{\mathscr{O}_X}(\mathscr{M},\mathscr{N}\otimes_{\mathscr{O}_X}\mathscr{D}_X).\qedhere
\end{equation*}
\end{proof}

\begin{remark}\label{D-module differential module char inverse map}
The inverse map of \cref{D-module differential module char} is given as follows. Let $\varphi\in\sDiff(\mathscr{M},\mathscr{N})$ be a differential homomorphism. Then for each $s\in\mathscr{M}$, there exists $P_i\in\mathscr{D}_X$ and $v_i\in\mathscr{N}$ such that
\begin{equation}\label{D-module differential module char inverse map-1}
\varphi(fs)=\sum_iP_i(f)v_i\for f\in\mathscr{O}_X.
\end{equation}
The inverse image $\tilde{\varphi}\in\sHom_{\mathscr{O}_X}(\mathscr{M},\mathscr{N}\otimes_{\mathscr{O}_X}\mathscr{D}_X)$ is then defined to be
\[\tilde{\varphi}(s)=\sum_iv_i\otimes P_i\in\mathscr{N}\otimes\mathscr{D}_X.\]
In fact, it is easy to verify that $P_\mathscr{N}\circ\tilde{\varphi}=\varphi$ from equation (\ref{D-module differential module char inverse map-1}).
\end{remark}

\begin{proposition}
Let $\mathscr{M}$, $\mathscr{N}$ and $\mathscr{H}$ be $\mathscr{O}_X$-modules. Then the diagram
\begin{small}
\[\begin{tikzcd}[column sep=4mm]
\sHom_{\mathscr{D}_X^{\op}}(\mathscr{M}\otimes_{\mathscr{O}_X}\mathscr{D}_X,\mathscr{N}\otimes_{\mathscr{O}_X}\mathscr{D}_X)\otimes_{\C}\sHom_{\mathscr{D}_X^{\op}}(\mathscr{M}\otimes_{\mathscr{O}_X}\mathscr{D}_X,\mathscr{N}\otimes_{\mathscr{O}_X}\mathscr{D}_X)\ar[r]\ar[d]&\sDiff(\mathscr{M},\mathscr{N})\otimes_{\C}\sDiff(\mathscr{N},\mathscr{H})\ar[d]\\
\sHom_{\mathscr{D}_X^{\op}}(\mathscr{M}\otimes_{\mathscr{O}_X}\mathscr{D}_X,\mathscr{H}\otimes_{\mathscr{O}_X}\mathscr{D}_X)\ar[r]&\sDiff(\mathscr{M},\mathscr{H})
\end{tikzcd}\]
is commutative, where the vertical arrows are the homomorphisms obtained by composition.
\end{small}
\end{proposition}
\begin{proof}
This follows from \cref{D-module differential module char}, since the isomorphsim in it is compatible with compositions.
\end{proof}

Let us apply the above argument to the de Rham complex
\[\begin{tikzcd}
\cdots\ar[r]&0\ar[r]&\Omega_X^0\ar[r]&\Omega_X^1\ar[r]&\cdots\ar[r]&\Omega_X^n\ar[r]&0\ar[r]&\cdots
\end{tikzcd}\]
Take a coordinate system $\{x_i,\partial_i\}$, we then have
\[d(f\omega)=df\wedge\omega+fd\omega=\sum_i\frac{\partial f}{\partial x_i}dx_i\wedge\omega+fd\omega,\]
so the exterior differential $d$ is a differential homomorphism, and \cref{D-module differential module char by Hom of tensor} gives a complex of right $\mathscr{D}_X$-modules
\begin{equation}\label{D-module de Rham complex of D_X-1}
\begin{tikzcd}
\cdots\ar[r]&0\ar[r]&\Omega_X^0\otimes_{\mathscr{O}_X}\mathscr{D}_X\ar[r]&\cdots\ar[r]&\Omega_X^n\otimes_{\mathscr{O}_X}\mathscr{D}_X\ar[r]&0\ar[r]&\cdots
\end{tikzcd}
\end{equation}
By definition, the differential in this complex is given by
\begin{equation}\label{D-module de Rham complex of D_X-2}
d(\omega\otimes P)=\sum_{i=1}^{n}dx_i\wedge \omega\otimes\partial_iP+d\omega\otimes P
\end{equation}  
where $\omega\in\Omega_X^\bullet$, $P\in\mathscr{D}_X$. In particular, choosing $\omega=1\in\Omega_X^0$, we obtain
\begin{gather}
dP=\sum_{i=1}^{n}dx_i\otimes\partial_iP,\label{D-module de Rham complex of D_X-3}\\
d(\omega\wedge\eta)=d\omega\wedge\eta+(-1)^p\omega\wedge d\eta,\label{D-module de Rham complex of D_X-4}
\end{gather}
where $\omega\in\Omega_X^p$ and $\eta\in\Omega_X^q\otimes_{\mathscr{O}_X}\mathscr{D}_X$.\par 

Conversely, these two formule characterize the differential $d$ of $\Omega_X^\bullet\otimes_{\mathscr{O}_X}\mathscr{D}_X$. For every left $\mathscr{D}_X$-module $\mathscr{M}$, we then obtain a complex
\[\begin{tikzcd}
\cdots\ar[r]&0\ar[r]&\Omega_X^0\otimes_{\mathscr{O}_X}\mathscr{M}\ar[r]&\cdots\ar[r]&\Omega_X^n\otimes_{\mathscr{O}_X}\mathscr{M}\ar[r]&0\ar[r]&\cdots
\end{tikzcd}\]
by applying the functor $-\otimes_{\mathscr{D}_X}\mathscr{M}$ to (\ref{D-module de Rham complex of D_X-1}). In other words, we have
\begin{gather}
ds=\sum_{i=1}^{n}dx_i\otimes\partial_is,\label{D-module de Rham complex of module-1}\\
d(\omega\wedge\eta)=d\omega\wedge\eta+(-1)^p\omega\wedge d\eta,\label{D-module de Rham complex ofmodule-2}
\end{gather}
where $s\in\mathscr{M}$, $\omega\in\Omega_X^p$, $\eta\in\Omega_X^q\otimes\mathscr{M}$. The complex $(\Omega_X^\bullet\otimes_{\mathscr{O}_X}\mathscr{M},d)$ is called the \textbf{de Rham complex} of $\mathscr{M}$ and denoted by $DR_X(\mathscr{M})$.\par

By applying the functor
\[\sHom_{\mathscr{D}_X^{\op}}(-,\mathscr{D}_X):\Mod(\mathscr{D}_X^{\op})\to\Mod(\mathscr{D}_X)^{\op}\]
to (\ref{D-module de Rham complex of D_X-1}), we obtain a complex of left $\mathscr{D}_X$-modules
\begin{equation}\label{D-module Spencer resolution of O_X}
\begin{tikzcd}
\cdots\ar[r]&0\ar[r]&\mathscr{D}_X\otimes_{\mathscr{O}_X}\bigw^n\Theta_X\ar[r]&\cdots\ar[r]&\mathscr{D}_X\otimes_{\mathscr{O}_X}\bigw^0\Theta_X\ar[r]&0\ar[r]&\cdots
\end{tikzcd}
\end{equation}
since we have 
\[\sHom_{\mathscr{D}_X^{\op}}(\Omega_X^p\otimes_{\mathscr{O}_X}\mathscr{D}_X,\mathscr{D}_X)\cong\sHom_{\mathscr{O}_X}(\Omega_X^p,\mathscr{D}_X)\cong\mathscr{D}_X\otimes_{\mathscr{O}_X}\bigw^p\Theta_X.\]
Explicitly, the differential $d$ is given by
\begin{align*}
d(P\otimes v_1\wedge\cdots\wedge v_p)&=\sum_i(-1)^{i-1}Pv_i\otimes v_1\wedge\cdots\wedge\hat{v}_i\wedge\cdots\wedge v_p\\
&+\sum_{i<j}(-1)^{i+j}P\otimes[v_i,v_j]\wedge v_1\wedge\cdots\wedge\hat{v}_i\wedge\cdots\wedge\hat{v}_j\wedge\cdots\wedge v_p.
\end{align*}

\begin{proposition}\label{D-module resolution of Omega_X and O_X}
We have the following locally free resolutions of the left $\mathscr{D}_X$-module $\mathscr{O}_X$ and the right $\mathscr{D}_X$-module $\Omega_X$.
\begin{equation}
\begin{tikzcd}
0\ar[r]&\Omega_X^0\otimes_{\mathscr{O}_X}\mathscr{D}_X\ar[r]&\cdots\ar[r]&\Omega_X^n\otimes_{\mathscr{O}_X}\mathscr{D}_X\ar[r]&\Omega_X\ar[r]&0
\end{tikzcd}
\end{equation}
\vspace*{-4mm}
\begin{equation}
\begin{tikzcd}
0\ar[r]&\mathscr{D}_X\otimes_{\mathscr{O}_X}\bigw^n\Theta_X\ar[r]&\cdots\ar[r]&\mathscr{D}_X\otimes_{\mathscr{O}_X}\bigw^0\Theta_X\ar[r]&\mathscr{O}_X\ar[r]&0
\end{tikzcd}
\end{equation}
\end{proposition}
\begin{proof}
The assertion for $\Omega_X$ follows from the one for $\mathscr{O}_X$ using the side-changing operation. Later we will show that the complex (\ref{D-module de Rham complex of D_X-1}) is a resolution of $\mathscr{O}_X$ in a general setting (cf. \cref{D-module relative D-module resolution}).
\end{proof}

\paragraph{Correspondence between left and right \texorpdfstring{$D$}{D}-modules}
Take a local coordinate system $\{x_i,\partial_i\}$ on an affine open subset $U$ of $X$. For $P=\sum_\alpha a_\alpha\partial^\alpha\in\mathscr{D}_U$, consider its formal adjoint
\[P^*:=\sum_\alpha(-1)^{|\alpha|}\partial^\alpha a_\alpha(x)\in\mathscr{D}_U.\]
Then we have $(PQ)^*=Q^*P^*$, and an anti-automorphism $P\mapsto P^*$ of $\mathscr{D}_U$. Therefore, for a left $\mathscr{D}_U$-module $\mathscr{M}$ we can define a right action of $\mathscr{D}_U$ on $\mathscr{M}$ by $sP:=P^*s$ for $s\in\mathscr{M}$, and obtain a right $\mathscr{D}_U$-module $\mathscr{M}^*$. However, this notion depends on the choice of a local coordinate. In order to globalize this correspondence to arbitrary smooth algebraic variety $X$ we need to use the canonical sheaf $\Omega_X:=\Omega_X^n$, where $n=\dim(X)$, since the formal adjoint of a differential operator naturally acts on $\Omega_X$.\par
Recall that there are two natural actions of $\Theta$ on the sheaf $\Omega_X^\bullet=\bigoplus_i\Omega_X^i$. For $v\in\Theta_X$, its \textbf{inner derivation} $i_v\in\sEnd_\C(\Omega_X^\bullet)$ is characterized by the following properties:
\begin{enumerate}[leftmargin=40pt]
    \item[(I1)] $i_{fv}=fi_v=i_vf$ for $f\in\mathscr{O}_X$, $v\in\Theta_X$;
    \item[(I2)] $i_v(\omega\wedge\eta)=(i_v\omega)\wedge\eta+(-1)^{\deg(\omega)}\omega\wedge i_v\eta$ for $\omega,\eta\in\Omega_X^\bullet$;
    \item[(I3)] $i_v(\mathscr{O}_X)=0$;
    \item[(I4)] $i_v(\omega)=\langle v,\omega\rangle\in\mathscr{O}_X$ for $\omega\in\Omega_X^1$.
\end{enumerate}
In contrast, the Lie derivative $\mathfrak{L}_v\in\sEnd_\C(\Omega_X^\bullet)$ is characterized by the following properties:
\begin{enumerate}[leftmargin=40pt]
    \item[(L1)] $\mathfrak{L}_v(\omega\wedge\eta)=\mathfrak{L}_v\omega\wedge\eta+\omega\wedge\mathfrak{L}_v\eta$ for $\omega,\eta\in\Omega_X^\bullet$;
    \item[(L2)] $\mathfrak{L}_vf=v(f)$ for $f\in\mathscr{O}_X$,
    \item[(L3)] $d\mathfrak{L}_v=\mathfrak{L}_vd$. 
\end{enumerate}
Hence $\mathfrak{L}_V$ is an operator of degree $0$ on $\Omega_X^\bullet$, and locally it is given by
\begin{align*}
\mathfrak{L}_v(\omega)(v_1,\dots,v_n)=v(\omega(v_1,\dots,v_n))-\sum_{i=1}^{n}\omega(v_1,\dots,[v,v_i],\dots,v_n).
\end{align*}
The Lie derivatives also satisfy $[\mathfrak{L}_v,\mathfrak{L}_w]=\mathfrak{L}_{[v,w]}$ for $v,w\in\Theta_X$, and these two derivatives are related by
\[\mathfrak{L}_v=di_v+i_vd.\]

\begin{lemma}\label{D-module on Omega Lie derivative linear}
For every $f\in\mathscr{O}_X$ and $v\in\Theta_X$, we have
\begin{gather*}
\mathfrak{L}_{fv}(\omega)=\mathfrak{L}_v(f\omega)=f\mathfrak{L}_v(\omega)+v(f)\omega.
\end{gather*}
where $\omega\in\Omega_X:=\Omega_X^n$.
\end{lemma}
\begin{proof}
For $\omega\in\Omega_X^\bullet$, we have
\begin{align*}
\mathfrak{L}_{fv}(\omega)&=d(fi_v\omega)+fi_v(d\omega)=df\wedge i_v\omega+fdi_v\omega+fi_vd\omega=df\wedge i_v\omega+f\mathfrak{L}_v(\omega).
\end{align*}
Since $i_v(df\wedge\omega)=i_v(df)\wedge\omega-df\wedge i_v\omega=v(f)\omega-df\wedge i_v\omega$, we then conclude that
\[\mathfrak{L}_{fv}(\omega)=f\mathfrak{L}_v(\omega)+v(f)\omega-i_v(df\wedge\omega)=\mathfrak{L}_v(f\omega)-i_v(df\wedge\omega),\]
and this gives the desired result since $df\wedge\omega=0$ for $\omega\in\Omega_X$.
\end{proof}

\cref{D-module on Omega Lie derivative linear} shows that the map $\varphi:\Theta_X\to\sEnd_\C(\Omega_X)^{\op}$, $v\mapsto -\mathfrak{L}_v$ is left $\mathscr{O}_X$-linear, so by \cref{D-module ring D_X generating relation} we obtain an extended homomorphism $\mathscr{D}_X\to\sEnd_{\C}(\Omega_X)^{\op}$, which gives a right $\mathscr{D}_X$-module structure on $\Omega_X$. By definition, the equality
\[\omega v=-\mathfrak{L}_v(\omega)\]
holds for $v\in\Theta_X$ and $\omega\in\Omega_X$.

\begin{remark}
The action of $\Omega_X$ is related to integration by parts. Namely, $f\in\mathscr{O}_X$, $\omega\in\Omega_X$ and $P\in\mathscr{D}_X$ formally satisfy
\[\int_X(\omega P)f=\int_X\omega P(f).\]
That is, there exists a differential form $\eta$ of degree $(n-1)$ such that
\[(\omega P)f-\omega P(f)=d\eta.\]
For example, if $P=v\in\Theta_X$, then it is easy to see that
\[(\omega v)f-\omega v(f)=-\mathfrak{L}_v(\omega)f-\omega v(f)=-d(fi_v\omega).\]
\end{remark}

\begin{remark}\label{D-module Omega_X module structure expression}
In terms of an affine open $U$ and a local coordinate system $\{x_i,\partial_i\}$, we have
\begin{equation}\label{D-module Omega_X module structure expression-1}
(fdx_1\wedge\cdots\wedge dx_n)P=P^*f\,dx_1\wedge\cdots\wedge dx_n,
\end{equation}
where $f\in\mathscr{O}_X$ and $P\in\mathscr{D}_U$. To see this, it suffices to note that if $v=\sum_iv_i\partial_i$, then we have
\begin{align*}
(fdx_1\wedge\cdots\wedge dx_n)v&=(fdx_1\wedge\cdots\wedge dx_n)(\sum_iv_i\partial_i)=-\sum_iv_i\mathfrak{L}_{\partial_i}(fdx_1\wedge\cdots dx_n)\\
&=-\sum_iv_if\mathfrak{L}_{\partial_i}(x_1\wedge\cdots\wedge x_n)-\sum_iv_i\frac{\partial f}{\partial x_i}x_1\wedge\cdots\wedge x_n=v^*f\,dx_1\wedge\cdots\wedge dx_n.
\end{align*}
\end{remark}

For an invertible $\mathscr{O}_X$-module $\mathscr{L}$, we denote by $\mathscr{L}^{\otimes -1}$ the dual $\sHom_{\mathscr{O}_X}(\mathscr{L},\mathscr{O}_X)$. For $t\in\mathscr{L}^{\otimes -1}$ and $s\in\mathscr{L}$, we denote by $\langle t,s\rangle\in\mathscr{O}_X$ the image of $t\otimes s$ under the isomorphism $\mathscr{L}^{\otimes -1}\otimes_{\mathscr{O}_X}\mathscr{L}\cong\mathscr{O}_X$. Let $\mathscr{A}$ be an $\mathscr{O}_X$-algebra, that is, a sheaf of rings with a ring homomorphism $\mathscr{O}_X\to\mathscr{A}$. Then there exists a natural ring structure on $\mathscr{L}\otimes_{\mathscr{O}_X}\mathscr{A}\otimes_{\mathscr{O}_X}\mathscr{L}^{\otimes -1}$, given by
\[(s_1\otimes a_1\otimes t_1)\cdot(s_2\otimes a_2\otimes t_2)=s_1\otimes a_1\langle t_1,s_2\rangle a_2\otimes t_2\]
where $s_i\in\mathscr{L}$, $t_i\in\mathscr{L}^{\otimes -1}$, $a_i\in\mathscr{A}$. If $\mathscr{M}$ is an $\mathscr{A}$-module, then $\mathscr{L}\otimes_{\mathscr{O}_X}\mathscr{M}$ is a left $\mathscr{L}\otimes_{\mathscr{O}_X}\mathscr{A}\otimes_{\mathscr{O}_X}\mathscr{L}^{\otimes -1}$-module, whose action is given by
\[(s\otimes a\otimes t)\cdot(s'\otimes u)=s\otimes a\langle t,s'\rangle u.\]
In view of the isomorphism $\mathscr{L}^{\otimes -1}\otimes_{\mathscr{O}_X}\mathscr{L}\cong\mathscr{O}_X$, it is clear that we have the following proposition:
\begin{proposition}\label{D-module equivalence of twisted module category}
Let $\mathscr{L}$ be an invertible $\mathscr{O}_X$-module, and $\mathscr{A}$ an $\mathscr{O}_X$-algebra. Then the category $\Mod(\mathscr{A})$ of left $\mathscr{A}$-modules and the category $\Mod(\mathscr{L}\otimes_{\mathscr{O}_X}\mathscr{A}\otimes_{\mathscr{O}_X}\mathscr{L}^{\otimes -1})$ of left $\mathscr{L}\otimes_{\mathscr{O}_X}\mathscr{A}\otimes_{\mathscr{O}_X}\mathscr{L}^{\otimes -1}$-modules are equivalent to each other by
\[\Mod(\mathscr{A})\to \Mod(\mathscr{L}\otimes_{\mathscr{O}_X}\mathscr{A}\otimes_{\mathscr{O}_X}\mathscr{L}^{\otimes -1}),\quad \mathscr{M}\mapsto \mathscr{L}\otimes_{\mathscr{O}_X}\mathscr{M}.\]
\end{proposition}

We now apply this result to the invertible sheaf $\Omega_X$ over $X$. For thism, we note the following result.
\begin{proposition}\label{D-module D_X is twisted ring by Omega}
We have a canonical isomorphism
\[\mathscr{D}_X^{\op}\cong\Omega_X\otimes_{\mathscr{O}_X}\mathscr{D}_X\otimes_{\mathscr{O}_X}\Omega_X^{\otimes -1}.\]
\end{proposition}
\begin{proof}
The right $\mathscr{D}_X$-module structure on $\Omega_X$ gives a homomorphism $\mathscr{D}_X^{\op}\to\sEnd_\C(\Omega_X)$, and its image is in $\sDiff(\Omega_X,\Omega_X)=\Omega_X\otimes_{\mathscr{O}_X}\mathscr{D}_X\otimes_{\mathscr{O}_X}\Omega_X^{\otimes -1}$ in view of (\ref{D-module Omega_X module structure expression-1}). We therefore obtain a homomorphism
\[\varphi:\mathscr{D}_X^{\op}\to\Omega_X\otimes_{\mathscr{O}_X}\mathscr{D}_X\otimes_{\mathscr{O}_X}\Omega_X^{\otimes -1}.\]
Note that $\Omega_X^{\otimes -1}\otimes_{\mathscr{O}_X}\mathscr{D}_X^{\op}\otimes_{\mathscr{O}_X}\Omega_X=(\Omega_X\otimes_{\mathscr{O}_X}\mathscr{D}_X\otimes_{\mathscr{O}_X}\Omega_X^{\otimes -1})^{\op}$, so we also obtain a homomorphism
\[\psi:=(\Omega_X^{\otimes -1}\otimes\varphi\otimes\Omega_X)^{\op}:\Omega_X\otimes_{\mathscr{O}_X}\mathscr{D}_X\otimes_{\mathscr{O}_X}\to \mathscr{D}_X^{\op}.\]
Using \cref{D-module Omega_X module structure expression}, it is easy to check that $\psi$ and $\varphi$ are inverses of each other.
\end{proof}

\begin{remark}
In an affine open $U$ and a local coordinate system $\{x_i,\partial_i\}$, from the proof of \cref{D-module D_X is twisted ring by Omega} we see that the isomorphism of \cref{D-module D_X is twisted ring by Omega} is explicitly given by
\[\mathscr{D}_X^{\op}\to \Omega_X\otimes_{\mathscr{O}_X}\mathscr{D}_X\otimes_{\mathscr{O}_X}\Omega_X^{\otimes -1},\quad P\mapsto dx\otimes P^*\otimes dx^{\otimes -1}\]
where $dx=dx_1\wedge\cdots dx_n$ and $P^*$ is the formal adjoint of $P$.  
\end{remark}

We can identify $\Mod(\mathscr{D}_X^{\op})$ with the category of right $\mathscr{D}_X$-modules. Using tensor products and Hom sheaf, we have the following construction between left and right $\mathscr{D}_X$-modules.
\begin{proposition}\label{D-module tensor and Hom module structure def}
Let $\mathscr{M},\mathscr{N}$ be left $\mathscr{D}_X$-modules and $\mathscr{M}',\mathscr{N}'$ be right $\mathscr{D}_X$-modules. Then we have the following induced $\mathscr{D}_X$-module structures:
\begin{enumerate}
    \item[(\rmnum{1})] $\mathscr{M}\otimes_{\mathscr{O}_X}\mathscr{N}$ has a left $\mathscr{D}_X$-module defined by $v(s\otimes t)=vs\otimes t+s\otimes vt$.
    \item[(\rmnum{2})] $\mathscr{M}'\otimes_{\mathscr{O}_X}\mathscr{N}$ has a right $\mathscr{D}_X$-module defined by $(s'\otimes t)v=s'v\otimes t-s'\otimes vt$.
    \item[(\rmnum{3})] $\sHom_{\mathscr{O}_X}(\mathscr{M},\mathscr{N})$ has a left $\mathscr{D}_X$-module defined by $(v\varphi)(s)=v(\varphi(s))-\varphi(v(s))$.
    \item[(\rmnum{4})] $\sHom_{\mathscr{O}_X}(\mathscr{M}',\mathscr{N}')$ has a left $\mathscr{D}_X$-module defined by $(v\varphi)(s)=-v(\varphi(s))-\varphi(v(s))$.
    \item[(\rmnum{5})] $\sHom_{\mathscr{O}_X}(\mathscr{M},\mathscr{N}')$ has a right $\mathscr{D}_X$-module defined by $(v\varphi)(s)=v(\varphi(s))+\varphi(v(s))$. 
\end{enumerate}
\end{proposition}
The verifications of \cref{D-module tensor and Hom module structure def} are straightforward, for which we just need to check the conditions of \cref{D-module ring D_X generating relation}. A good way to memorize these results is by using the corespondence "left" $\leftrightarrow 0$, "right" $\leftrightarrow 1$, and $\sHom(\bullet,\bigstar)=-\bullet+\bigstar$.

\begin{proposition}\label{D-module Kronecker tensor and base change}
Given a left $\mathscr{D}_X$-module $\mathscr{M}$ and an $\mathscr{O}_X$-module $\mathscr{N}$, there exists a canonical isomorphism of left $\mathscr{D}_X$-modules
\[\mathscr{D}_X\otimes_{\mathscr{O}_X}(\mathscr{N}\otimes_{\mathscr{O}_X}\mathscr{M})\stackrel{\sim}{\to} (\mathscr{D}_X\otimes_{\mathscr{O}_X}\mathscr{N})\otimes_{\mathscr{O}_X}\mathscr{M},\]
where the left $\mathscr{D}_X$-module structure on $\mathscr{D}_X\otimes_{\mathscr{O}_X}-$ is induced by left multiplication on $\mathscr{D}_X$.
\end{proposition}
\begin{proof}
An $\mathscr{O}_X$-module homomorphism
\[\mathscr{N}\otimes_{\mathscr{O}_X}\mathscr{M}\to (\mathscr{D}_X\otimes_{\mathscr{O}_X}\mathscr{N})\otimes_{\mathscr{O}_X}\mathscr{M},\quad s\otimes u \mapsto (1\otimes s)\otimes u\]
can be extended to a $\mathscr{D}_X$-module homomorphism
\[\varphi:\mathscr{D}_X\otimes_{\mathscr{O}_X}(\mathscr{N}\otimes_{\mathscr{O}_X}\mathscr{M})\to (\mathscr{D}_X\otimes_{\mathscr{O}_X}\mathscr{N})\otimes\mathscr{M}.\]
It is easy to see that the image of $F_p(\mathscr{D}_X\otimes_{\mathscr{O}_X}(\mathscr{N}\otimes_{\mathscr{O}_X}\mathscr{M})):=F_p(\mathscr{D}_X)\otimes_{\mathscr{O}_X}(\mathscr{N}\otimes_{\mathscr{O}_X}\mathscr{M})$ under $\varphi$ is contained in $F_p((\mathscr{D}_X\otimes_{\mathscr{O}_X}\mathscr{N})\otimes\mathscr{M}):=(F_p(\mathscr{D}_X)\otimes_{\mathscr{O}_X}\mathscr{N})\otimes_{\mathscr{O}_X}\mathscr{M}$, so $\varphi$ induces a homomorphism from
\[\gr_p(\varphi):\gr_p(\mathscr{D}_X\otimes_{\mathscr{O}_X}(\mathscr{N}\otimes_{\mathscr{O}_X}\mathscr{M}))\to \gr_p((\mathscr{D}_X\otimes_{\mathscr{O}_X}\mathscr{N})\otimes_{\mathscr{O}_X}\mathscr{M}).\]
It is easy to check that this is the identity, using the fact that $\gr_p(\mathscr{D}_X)\cong\bm{S}_{\mathscr{O}_X}^p(\Theta_X)$, so by induction on $p$, it is easy to see that $\varphi$ is an isomorphism.
\end{proof}

\begin{remark}
Take a local coordinate system $\{x_i,\partial_i\}$. Then the homomorphism $\varphi$ in \cref{D-module Kronecker tensor and base change} is given by
\[\varphi(\partial^\alpha\otimes(s\otimes u))=\partial^\alpha((1\otimes s)\otimes u)=\sum_{\beta}\binom{\alpha}{\beta}(\partial^\beta\otimes s)\otimes\partial^{\alpha-\beta}u.\]
Therefore, the inverse map $\psi$ of $\varphi$ is given by
\[\psi((\partial^\alpha\otimes s)\otimes u)=\sum(-1)^{|\beta|}\binom{\alpha}{\beta}\partial^{\alpha-\beta}\otimes (s\otimes\partial^\beta u).\]
\end{remark}

\begin{remark}
By setting $\mathscr{N}=\mathscr{O}_X$ in \cref{D-module Kronecker tensor and base change}, we see that the two left $\mathscr{D}_X$-module structures on $\mathscr{D}_X\otimes_{\mathscr{O}_X}\mathscr{M}$ are isomorphic. This is a nontrivial fact since the isomorphism of these two modules is not the identity map.
\end{remark}

\begin{proposition}\label{D-module tensor with Kronecker tensor isomorphism}
Let $\mathscr{N}$ be a right $\mathscr{D}_X$-module and $\mathscr{M}_1$, $\mathscr{M}_2$ be left $\mathscr{D}_X$-modules. Then
\[\mathscr{N}\otimes_{\mathscr{D}_X}(\mathscr{M}_1\otimes_{\mathscr{O}_X}\mathscr{M}_2)\cong (\mathscr{N}\otimes_{\mathscr{O}_X}\mathscr{M}_1)\otimes_{\mathscr{D}_X}\mathscr{M}_2.\]
\end{proposition}
\begin{proof}
Each side is a quotient of $\mathscr{N}\otimes_{\mathscr{O}_X}\mathscr{M}_1\otimes_{\mathscr{O}_X}\mathscr{M}_2$. The left hand side is the one divided by the submodule generated by
\[sv\otimes (t_1\otimes t_2)-s\otimes v(t_1\otimes t_2)=sv\otimes t_1\otimes t_2-s\otimes vt_1\otimes t_2-s\otimes t_1\otimes vt_2,\]
and the right hand side is the one divided by the submodule generated by
\[(s\otimes t_1)v\otimes t_2-(s\otimes t_1)\otimes vt_2=sv\otimes t_1\otimes t_2-s\otimes vt_1\otimes t_2-s\otimes t_1\otimes vt_2,\]
so they are isomorphic.
\end{proof}

\begin{proposition}\label{D-module Hom and Kronecker tensor prop}
Let $\mathscr{M}_1,\mathscr{M}_2$ and $\mathscr{M}_3$ be left $\mathscr{D}_X$-modules. Then we have a canonical homomorphism of left $\mathscr{D}_X$-modules
\[\mathscr{M}_1\otimes_{\mathscr{O}_X}\sHom_{\mathscr{O}_X}(\mathscr{M}_1,\mathscr{M}_2)\to\mathscr{M}_2,\]
and an isomorphism
\begin{equation}\label{D-module Hom and Kronecker tensor prop-1}
\sHom_{\mathscr{D}_X}(\mathscr{M}_1\otimes\mathscr{M}_2,\mathscr{M}_3)\cong\sHom_{\mathscr{D}_X}(\mathscr{M}_1,\sHom_{\mathscr{O}_X}(\mathscr{M}_2,\mathscr{M}_3)).
\end{equation}
\end{proposition}
\begin{proof}
It is clear that we have a canonical homomorphism $\Phi:\mathscr{M}_1\otimes_{\mathscr{O}_X}\sHom_{\mathscr{O}_X}(\mathscr{M}_1,\mathscr{M}_2)\to\mathscr{M}_2$ which is $\mathscr{O}_X$-linear. To see that it is $\mathscr{D}_X$-linear, we note that
\[\Phi(v(s_1\otimes\varphi))=\Phi(vs_1\otimes\varphi+s_1\otimes v\varphi)=\varphi(vs_1)+(v\varphi)(s_1)=v(\varphi(s_1))=v(\Phi(s_1\otimes\varphi)).\]
where $v\in\Theta_X$, $s_i\in\mathscr{M}_i$, $\varphi\in\sHom_{\mathscr{O}_X}(\mathscr{M}_1,\mathscr{M}_2)$. This proves the first claim, and the second one can be proved similarly, by a detailed computation.
\end{proof}

\begin{proposition}\label{D-module side change by Omega_X}
The correspondence
\[\Omega_X\otimes_{\mathscr{O}_X}\bullet:\Mod(\mathscr{D}_X)\to\Mod(\mathscr{D}_X^{\op}).\]
gives an equivalence of categories, whose quasi-inverse is given by
\[\Omega_X^{\otimes-1}\otimes_{\mathscr{O}_X}\bullet=\sHom_{\mathscr{O}_X}(\Omega_X,\bullet):\Mod(\mathscr{D}_X)^{\op}\to\Mod(\mathscr{D}_X).\]
These operations are called \textbf{side-changing operations} of $\mathscr{D}_X$-modules.
\end{proposition}
\begin{proof}
By \cref{D-module Hom and Kronecker tensor prop}, we have a canonical homomorphism $\Omega_X^{\otimes-1}\otimes_{\mathscr{O}_X}\Omega_X\otimes_{\mathscr{O}_X}\mathscr{M}\to\mathscr{M}$, which is an isomorphism since $\Omega_X$ is locally free. The other direction follows from (\ref{D-module Hom and Kronecker tensor prop-1}) since $\sHom_{\mathscr{O}_X}(\mathscr{O}_X,\mathscr{M})\cong\mathscr{M}$.
\end{proof}

\paragraph{Quasi-coherent and coherent \texorpdfstring{$D$}{D}-modules}
On algebraic varieties, the category of quasi-coherent sheaves (over $\mathscr{O}_X$) is sufficiently wide and suitable for various algebraic operations. Since our sheaf $\mathscr{D}_X$ is locally free over $\mathscr{O}_X$, it is quasi-coherent over $\mathscr{O}_X$. We mainly deal with $\mathscr{D}_X$-modules which are quasi-coherent over $\mathscr{O}_X$. For a smooth algebraic variety $X$, the category of $\mathscr{D}_X$-modules that are quasi-coherent over $\mathscr{O}_X$ is denoted by $\Qcoh(\mathscr{O}_X)$. This is clearly an abelian category.\par
It is well known that for affine algebraic varieties $X$, the global section functor $\Gamma(X,-)$ is exact and $\Gamma(X,\mathscr{M})=0$ if and only if $\mathscr{M}=0$ for $\mathscr{M}\in\Qcoh(\mathscr{M})$. Replacing $\mathscr{O}_X$ by $\mathscr{D}_X$, we come to the following notion.
\begin{definition}
A smooth algebraic variety $X$ is called \textbf{$\bm{D}$-affine} if the following conditions are satisfied:
\begin{enumerate}[leftmargin=40pt]
    \item[(A1)] The global section functor $\Gamma(X,-):\Qcoh(\mathscr{D}_X)\to\Mod(\Gamma(X,\mathscr{D}_X))$ is exact.
    \item[(A2)] If $\Gamma(X,\mathscr{M})=0$ for $\mathscr{M}\in\Qcoh(\mathscr{D}_X)=0$, then $\mathscr{M}=0$.
\end{enumerate}
\end{definition}

It is clear that any smooth affine algebraic variety is $D$-affine. As in the case of quasi-coherent $\mathscr{O}_X$-modules on affine varieties we have the following.
\begin{proposition}\label{D-module global section equivalence for D-affine}
Assume that $X$ is a smooth algebraic variety that is $D$-affine.
\begin{enumerate}
    \item[(a)] Any $\mathscr{M}\in\Qcoh(\mathscr{D}_X)$ is generated over $\mathscr{D}_X$ by its global sections.
    \item[(b)] The functor $\Gamma(X,-):\Qcoh(\mathscr{D}_X)\to\Mod(\Gamma(X,\mathscr{D}_X))$ is an equivalence of categories.
\end{enumerate}
\end{proposition}

\begin{remark}
The D-affinity holds also for certain non-affine varieties. For example, we will see that projective spaces are $D$-affine. We will also show that flag manifolds for semi-simple algebraic groups are $D$-affine. This fact was one of the key points in the settlement of the Kazhdan-Lusztig conjecture.
\end{remark}

\begin{remark}
If $X$ is affine, we can replace $D_X$ with $\mathscr{D}_X^{\op}$ in the above argument. In other words, smooth affine varieties are also $D^{\op}$-affine. Note that $D$-affine varieties are not necessarily $D^{\op}$-affine in general. For example, $\P^1$ is not $D^{\op}$-affine by $\Gamma(\P^1,\Omega_{\P^1})=0$, but it is $D$-affine as we shall see.
\end{remark}

Recall that an $\mathscr{A}$-module $\mathscr{M}$ over a ringed space $(X,\mathscr{A})$ is called \textit{coherent} if it is of finite type over $\mathscr{A}$ and any finite generating relation of $\mathscr{M}$ is finitely presented. We now consider coherent $\mathscr{D}_X$-modules over $X$.
\begin{proposition}\label{D-module coherent D_X-module iff qcoh and ft}
Let $X$ be a smooth algebraic variety. Then $\mathscr{D}_X$ is a coherent sheaf of rings. Moreover, a $\mathscr{D}_X$-module is coherent if and only if it is quasi-coherent over $\mathscr{O}_X$ and of finite type over $\mathscr{D}_X$.
\end{proposition}
\begin{proof}
The first statement follows from the second one, so we only need to prove the second one. If $\mathscr{M}$ is a coherent $\mathscr{D}_X$-module, then $\mathscr{M}$ is of finite type over $\mathscr{D}_X$. Moreover, $\mathscr{M}$ is quasi-coherent over $\mathscr{O}_X$ since it is locally finitely presented as a $\mathscr{D}_X$-module and $\mathscr{D}_X$ is quasi-coherent over $\mathscr{O}_X$. Conversely, assume that $\mathscr{M}$ is of finite type over $\mathscr{D}_X$ and quasi-coherent over $\mathscr{O}_X$. To see that $\mathscr{M}$ is coherent over $\mathscr{D}_X$, it suffices to show that for any affine open subset $U$ of $X$, the kernel of any homomorphism $\varphi:\mathscr{D}_U^m\to\mathscr{M}|_U$ of $\mathscr{D}_U$ is finitely presented over $\mathscr{D}_U$. Since $\mathscr{D}_U(U)$ is a left Noetherian ring, the kernel of $\mathscr{D}_U(U)^m\to\mathscr{M}(U)$ is a finitely generated $\mathscr{D}_U(U)$-module, and this proves the assertion in view of \cref{D-module global section equivalence for D-affine}.
\end{proof}

\begin{theorem}\label{D-module coherent over O_X iff locally free}
A $\mathscr{D}_X$-module is coherent over $\mathscr{O}_X$ if and only if it is an integrable connection.
\end{theorem}

\begin{proposition}\label{D-module D-affine coherent equivalent to finite module}
Let $X$ be a smooth algebraic variety that is $D$-affine. Then the global section functor $\Gamma(X,-)$ induces the equivalence
\[\Coh(\mathscr{D}_X)\stackrel{\sim}{\to} \Mod_f(\Gamma(X,\mathscr{D}_X))\]
where for a ring $A$, we denote by $\Mod_f(A)$ the category of finitely generated $A$-modules.
\end{proposition}

\begin{proposition}\label{D-module qcoh module flasque resolution}
Any $\Qcoh(\mathscr{D}_X)$ is embedded into an injective object $\mathscr{I}$ of $\Qcoh(\mathscr{D}_X)$ which is flasque.
\end{proposition}

\begin{corollary}\label{D-module cohomology trivial for D-affine}
If $X$ is $D$-affine, then for any $\mathscr{M}\in\Qcoh(\mathscr{D}_X)$, we have $H^i(X,\mathscr{M})=0$ for $i>0$.
\end{corollary}

\begin{proposition}\label{D-module quotient of locally free on quasi-proj}
Let $X$ be a smooth quasi-projective algebraic variety.
\begin{enumerate}
    \item[(a)] Any $\mathscr{M}\in\Qcoh(\mathscr{D}_X)$ is a quotient of a locally free $\mathscr{D}_X$-module.
    \item[(b)] Any $\mathscr{M}\in\Coh(\mathscr{D}_X)$ is a quotient of a locally free $\mathscr{D}_X$-module of finite rank.
\end{enumerate}
\end{proposition}

\begin{corollary}\label{D-module resolution by locally free and projective on quasi-proj}
Let $X$ be a smooth quasi-projective algebraic variety. Then any $\mathscr{M}\in\Qcoh(\mathscr{D}_X)$ admits a resolution by locally free $\mathscr{D}_X$-modules and a finite resolution by locally projective $\mathscr{D}_X$-modules. If $\mathscr{M}$ is a coherent $\mathscr{D}_X$-module, then we can assume that each term of these resolutions has finite rank.
\end{corollary}

\begin{remark}
In view of \cref{D-module quotient of locally free on quasi-proj} and \cref{D-module resolution by locally free and projective on quasi-proj}, we may assume that our variety $X$ is quasi-projective throughout this section. One shall see that this assumption is harmless for most of our applications.
\end{remark}

\subsection{Characteristic varieties}
Recall that we have obtained from $\mathscr{D}_X$, first a commutative object $\bm{S}_{\mathscr{O}_X}(\Theta_X)$ by taking graded ring, next the cotangent bundle $T^*X$ as its geometric object, and finally the symplectic structure on $T^*X$ as a reflection of the noncommutativity of $\mathscr{D}_X$.\par
Now we consider $\mathscr{D}_X$-modules and derive a commutative object from each of them. Let $\mathscr{M}$ be a $\mathscr{D}_X$-module which is quasi-coherent over $\mathscr{O}_X$. We consider an \textit{increasing} filtration of $\mathscr{M}$ by quasi-coherent $\mathscr{O}_X$-submdules $F_i(\mathscr{M})$ satisfying the following conditions:
\begin{enumerate}[leftmargin=40pt]
    \item[(F1)] $\mathscr{M}=\bigcup_iF_i(\mathscr{M})$.
    \item[(F2)] $F_i(\mathscr{D}_X)F_j(\mathscr{M})\sub F_{i+j}(\mathscr{M})$.
    \item[(F3)] $F_i(\mathscr{M})=0$ for $i\ll 0$.  
\end{enumerate}
In this case, we say that $M$ is a \textbf{filtered $\mathscr{D}_X$-module}. The associated graded module
\[\gr(\mathscr{M})=\bigoplus_{i\in\Z}F_i(\mathscr{M})/F_{i-1}(\mathscr{M})\]
is then a graded module over $\gr(\mathscr{D}_X)=\pi_*(\mathscr{O}_{T^*X})$, which is clearly quasi-coherent over $\mathscr{O}_X$.

\begin{proposition}\label{D-module good filtration iff}
Let $M$ be a filtered $\mathscr{D}_X$-module. Then the following conditions are equivalent:
\begin{enumerate}
    \item[(\rmnum{1})] $\gr(\mathscr{M})$ is coherent over $\pi_*(\mathscr{O}_{T^*X})$.
    \item[(\rmnum{2})] There exist locally a surjective $\mathscr{D}_X$-linear homorphism $\Phi:\mathscr{D}_X^{\oplus r}\to\mathscr{M}$ and integers $n_j$ ($j=1,\dots,r$) such that for each $i\in\Z$,
    \[\Phi\Big(\bigoplus_{j=1}^{r}F_{i-n_j}(\mathscr{D}_X)\Big)=F_i(\mathscr{M}).\]
    \item[(\rmnum{3})] $F_i(\mathscr{M})$ is coherent over $\mathscr{O}_X$ for each $i$, and there exists an integer $i_0$ such that locally we have
    \[F_j(\mathscr{D}_X)F_i(\mathscr{M})=F_{i+j}(\mathscr{M})\for i\geq i_0,j\geq 0.\]
\end{enumerate}
\end{proposition}
\begin{proof}
Since the question is local, we can reduce to affine case, from which the equivalence of (\rmnum{1}) and (\rmnum{2}) is clear. Now it is easily checked that (\rmnum{2}) holds if and only if $F_i(\mathscr{M})$ is coherent over $\mathscr{O}_X$ and one can find $i_0$ as in (\rmnum{3}) locally on $X$.
\end{proof}

A filtration $\{F_i(\mathscr{M})\}$ is called \textbf{good} if it satisfies the conditions of \cref{D-module good filtration iff}. By \cref{D-module good filtration iff}, a good filtration induces a coherent module $\gr(\mathscr{M})$ over $\pi_*(\mathscr{O}_{T^*X})$.

\begin{theorem}\label{D-module good filtration iff coh}
Let $X$ be a smooth algebraic variety.
\begin{enumerate}
    \item[(a)] Any coherent $\mathscr{D}_X$-module admits a (locally defined) good filtration. Conversely, a quasi-coherent $\mathscr{D}_X$-module endowed with a good filtration is coherent.
    \item[(b)] Let $F,F'$ be two filtrations of a $\mathscr{D}_X$-module $\mathscr{M}$ and assume that $F$ is good. Then there exists an integer $i_0$ such that locally we have
    \[F_i(\mathscr{M})\sub F'_{i+i_0}(\mathscr{M})\for i\in\Z.\]
    If, moreover, $F'$ is also a good filtration, there exists $i_0$ such that locally
    \[F'_{i-i_0}(\mathscr{M})\sub F_i(\mathscr{M})\sub F'_{i+i_0}(\mathscr{M})\for i\in\Z.\] 
\end{enumerate}
\end{theorem}
\begin{proof}
If $\mathscr{M}$ is a coherent $\mathscr{D}_X$-module, then $\mathscr{M}$ is locally generated by a finite number of sections $u_1,\dots,u_N$, and we can define $F_i(\mathscr{M})$ by
\[F_i(\mathscr{M})=\sum_{\nu=1}^{N}F_i(\mathscr{D}_X)u_\nu.\]
It is easy to see that this is a good filtration of $\mathscr{M}$. Conversely, if $\mathscr{M}$ admits a good filtration, then it is locally generated by finitely many sections, hence coherent. The second assertion is local, and hence follows from the corresponding result for graded modules.
\end{proof}

Let $\mathscr{M}$ be a coherent $\mathscr{D}_X$-module with a good filtration. Let $\pi:T^*X\to X$ be the cotangent bundle of $X$. Since we have $\gr(\mathscr{D}_X)\cong\pi_*(\mathscr{O}_{T^*X})$, the graded module $\gr(\mathscr{M})$ is a coherent module over $\pi_*(\mathscr{O}_{T^*X})$ by \cref{D-module good filtration iff}. The support of the coherent $\mathscr{O}_{T^*X}$-module
\[\widetilde{\gr(\mathscr{M})}:=\mathscr{O}_{T^*X}\otimes_{\pi^{-1}(\mathscr{O}_{T^*X})}\pi^*(\gr(\mathscr{M}))\]
is called the \textbf{characteristic variety} of $\mathscr{M}$ and denoted by $\Ch(M)$ (it is sometimes called the \textbf{singular support} of $M$). Since $\gr(\mathscr{M})$ is a graded module over the graded ring $\gr(\mathscr{D}_X)$, we see that $\Ch(M)$ is a closed conic (i.e., stable by the scalar multiplication of complex numbers on the fibers) algebraic subset in $T^*X$.

\begin{theorem}\label{D-module coherent module char variety independent filtration}
The characteristic variety of a coherent $\mathscr{D}_X$-module $\mathscr{M}$ does not depend on the choice of a good filtration.
\end{theorem}
\begin{proof}
We say two good filtrations $F$ and $G$ are "adjacent" if they satisfy the condition
\[F_i(\mathscr{M})\sub G_i(\mathscr{M})\sub F_{i+1}(\mathscr{M})\for i\in\Z.\]
We first show the assertion in this case. Consider the natural homomorphism
\[\varphi_i:F_i(\mathscr{M})/F_{i-1}(\mathscr{M})\to G_i(\mathscr{M})/G_{i-1}(\mathscr{M}).\]
Then we have $\ker\varphi_i\cong G_{i-1}(\mathscr{M})/F_{i-1}(\mathscr{M})\cong\coker\varphi_{i-1}$, so the homorphism $\varphi:\gr^F(\mathscr{M})\to \gr^G(\mathscr{M})$ entails an isomorphism $\ker\varphi\cong\coker\varphi$. Consider the exact sequence
\[\begin{tikzcd}
0\ar[r]&\ker\varphi\ar[r]&\gr^F(\mathscr{M})\ar[r]&\gr^G(\mathscr{M})\ar[r]&\gr^G(\mathscr{M})\ar[r]&\coker\varphi\ar[r]&0
\end{tikzcd}\]
of coherent $\gr^F(\mathscr{D}_X)$-modules. From this we obtain
\begin{gather*}
\supp(\gr^F(\mathscr{M}))=\supp(\ker\varphi)\cup\supp(\im\varphi),\\
\supp(\gr^G(\mathscr{M}))=\supp(\im\varphi)\cup\supp(\coker\varphi).
\end{gather*}
Hence $\ker\varphi\cong\coker\varphi$ implies $\supp(\gr^F(\mathscr{M}))=\supp(\gr^G(\mathscr{M}))$, so the assertion is proved for adjacent good filtrations.\par
Let us consider the general case. Namely, assume that $F$ and $G$ are arbitrary good filtrations of $M$. For $k\in\Z$ set
\[F_i^{(k)}(\mathscr{M})=F_i(\mathscr{M})+G_{i+k}(\mathscr{M}),\quad i\in\Z.\]
By \cref{D-module good filtration iff coh}, $F^{(k)}$ is a good filtration of $\mathscr{M}$, and $F^{(k)}$, $F^{(k+1)}$ are adjacent for each $k\in\Z$. Since $F^{(k)}=F$ for $k\ll 0$ and $F^{(k)}=G[k]$ for $k\gg 0$, we conclude the assertion from the adjacent case.
\end{proof}

Let $U$ be an affine open subset of $X$. Then $T^*U$ is an affine open subset of $T^*X$, and $\Ch(\mathscr{M})\cap T^*U$ coincides with the support of the coherent $\mathscr{O}_{T^*U}$-module associated to the finitely generated $\gr(\Gamma(U,\mathscr{D}_U))$-module $\gr(\Gamma(U,\mathscr{M}))$. We then have
\[\Ch(\mathscr{M})\cap T^*U=\{p\in T^*U:\text{$f(p)=0$ for $f\in\mathfrak{J}_{\Gamma(U,\mathscr{M})}$}\},\]
where $\mathfrak{J}_{\Gamma(U,\mathscr{M})}$ is the characteristic ideal of $\Gamma(U,\mathscr{M})$, defined by
\[\mathfrak{J}_{\Gamma(U,\mathscr{M})}=\sqrt{\Ann(\gr(\Gamma(U,\mathscr{M})))}=\bigcap_{\p\in\SS_0(\Gamma(U,\mathscr{M}))}\p.\]
The decomposition of $\Ch(\mathscr{M})\cap T^*U$ into irreducible components is given by
\[\Ch(\mathscr{M})\cap T^*U=\bigcup_{\p\in\SS_0(\Gamma(U,\mathscr{M}))}\{p\in T^*U:\text{$f(p)=0$ for $f\in\p$}\}.\]

\begin{proposition}\label{D-module coh characteristic variety prop}
Let $\mathscr{M}$ be a coherent $\mathscr{O}_X$-module and $\pi:T^*X\to X$ be the cotangent bundle.
\begin{enumerate}
    \item[(a)] $\supp(\mathscr{M})=\pi(\Ch(\mathscr{M}))$.
    \item[(b)] $\Ch(\mathscr{M})$ is a closed conic and algebraic subset.
    \item[(c)] If $0\to\mathscr{M}'\to\mathscr{M}\to\mathscr{M}''\to 0$ is an exact sequence of coherent $\mathscr{D}_X$-modules, then
    \[\Ch(\mathscr{M})=\Ch(\mathscr{M}')\cup\Ch(\mathscr{M}'').\] 
\end{enumerate}
\end{proposition}
\begin{proof}
Since $\mathscr{O}_{T^*X}$ is faithfully flat over $\pi^{-1}(\gr(\mathscr{D}_X))$, we see that $\pi(\Ch(\mathscr{M}))=\supp(\gr(\mathscr{M}))$, so the first assertion follows from the easily seen fact $\supp(\mathscr{M})=\supp(\gr(\mathscr{M}))$. Now we have remarked (b), and to prove (c), we may assume that $\mathscr{M}$ has a good filtration $F$. If we endow $\mathscr{M}'$ and $\mathscr{M}''$ the induced filtration, then they are good in view of \cref{D-module good filtration iff coh}, and the sequence
\[\begin{tikzcd}
0\ar[r]&\gr(\mathscr{M}')\ar[r]&\gr(\mathscr{M})\ar[r]&\gr(\mathscr{M}'')\ar[r]&0
\end{tikzcd}\]
The assertion then follows from the corresponding property of $\supp$.
\end{proof}

Let $X$ be a smooth algebraic variety and assume that we are given a coherent $\mathscr{O}_X$-module $\mathscr{G}$. Then we can define an algebraic cycle $\Cyc(\mathscr{G})$ associated to $\mathscr{G}$ as follows. For each irreducible component $V$ of $\supp(\mathscr{G})$, with generic point $\eta$, the local ring $\mathscr{O}_{X,\eta}$ is an Artinian ring, and we define the \textbf{multiplicity of $\mathscr{G}$ along $\bm{V}$} to be
\[\mult_X(\mathscr{G}):=\ell_{\mathscr{O}_{X,\eta}}(\mathscr{G}_\eta).\]
For irreducible subvariety $V$ with $V\nsubseteq\supp(\mathscr{G})$, we set $\mult_V(\mathscr{G})=0$; we then define the formal sum
\[\Cyc(\mathscr{G})=\sum \mult_V(\mathscr{G})\cdot V\]
which is called the associated cycle of $\mathscr{G}$.\par
Let $\mathscr{M}$ be a coherent $\mathscr{D}_X$-module. By choosing a good filtration of $\mathscr{M}$, we can consider the coherent $\mathscr{O}_{T^*X}$-module $\widetilde{\gr(\mathscr{M})}$. From the proof of \cref{D-module coherent module char variety independent filtration}, it is easy to see that the cycle $\Cyc(\gr(\mathscr{M}))$ is independent of the choice of the filtration of $\mathscr{M}$.

\begin{definition}
For a coherent $\mathscr{D}_X$-module $\mathscr{M}$ we define the \textbf{characteristic cycle} of $\mathscr{M}$ by
\[\Cyc(\mathscr{M}):=\Cyc(\widetilde{\gr(\mathscr{M})})=\sum_V\mult_V(\widetilde{\gr(\mathscr{M})})\cdot V.\]
For $d\in\N$, we denote its degree $d$ part by
\[\Cyc_d(\mathscr{M}):=\sum_{\dim(V)=d}\mult_V(\widetilde{\gr(\mathscr{M})})\cdot V.\]
\end{definition}

\begin{proposition}\label{D-module coh associated cycle additive}
If $0\to\mathscr{M}'\to\mathscr{M}\to\mathscr{M}''\to 0$ is an exact sequence of coherent $\mathscr{D}_X$-modules, then for any irreducible component $V$ of $\Ch(\mathscr{M})$, we have
\[\mult_V(\widetilde{\gr(\mathscr{M})})=\mult_V(\widetilde{\gr(\mathscr{M}')})+\mult_V(\widetilde{\gr(\mathscr{M}'')}).\]
In particular, for $d=\dim(\Ch(\mathscr{M}))$, we have
\[\Cyc_d(\mathscr{M})=\Cyc_d(\mathscr{M}')+\Cyc_d(\mathscr{M}'').\]
\end{proposition}
\begin{proof}
The first assertion follows from the above remarks, and the second one follows from this.
\end{proof}

\begin{proposition}\label{D-module coh associated cycle of coker of monomorphism prop}
Let $\mathscr{M}$ be a coherent $\mathscr{D}_X$-module, and $f:\mathscr{M}\to\mathscr{M}$ be a monomorphism of $\mathscr{D}_X$-modules. Then $\Ch(\mathscr{M}/f(\mathscr{M}))$ is a nowhere dense subset of $\Ch(\mathscr{M})$.
\end{proposition}
\begin{proof}
We choose a good filtration on $\mathscr{N}:=\mathscr{M}/f(\mathscr{M})$. By the exact sequence $0\to\mathscr{M}\to\mathscr{M}\to\mathscr{N}\to 0$, we have
\[\mult_V(\mathscr{N})=\mult_V(\mathscr{M})-\mult_V(\mathscr{M})=0\]
for any irreducible component $V$ of $\Ch(\mathscr{M})$, so the multiplicity of $\widetilde{\gr(\mathscr{N})}$ on $V$ is $0$. It follows that the support of $\widetilde{\gr(\mathscr{N})}$ cannot contain $V$, so $\Ch(\mathscr{M}/f(\mathscr{M}))$ is nowhere dense.
\end{proof}

\begin{example}
Let $\mathscr{M}$ be an integrable connection of rank $r>0$ on $X$. We can then define a good filtration on $\mathscr{M}$ by setting
\[F_i(\mathscr{M})=\begin{cases}
0&i<0,\\
\mathscr{M}&i\geq 0,
\end{cases}\]
and we have $\gr(\mathscr{M})\cong\mathscr{M}\cong\mathscr{O}_X^r$ locally. Moreover, since $\Theta_X$ annihilates $\gr(\mathscr{M})$ by degree consideration, we get $\Ch(\mathscr{M})=T^*_XX=s(X)\cong X$ (the zero section of $T^*X$), and $\Cyc(\mathscr{M})=r\cdot T^*_XX$.
\end{example}

\begin{proposition}
For a non-zero coherent $\mathscr{D}_X$-module $\mathscr{M}$ the following three conditions are equivalent:
\begin{enumerate}
    \item[(\rmnum{1})] $\mathscr{M}$ is an integrable connection.
    \item[(\rmnum{2})] $\mathscr{M}$ is coherent over $\mathscr{O}_X$.
    \item[(\rmnum{3})] $\Ch(\mathscr{M})=T^*_XX\cong X$ (the zero section of $T^*X$).
\end{enumerate}
\end{proposition}
\begin{proof}
We have seen that (\rmnum{1}) is equivalent to (\rmnum{2}) (\cite{hotta_Dmodule} Theorem 1.4.10), so it remains to prove that (\rmnum{3})$\Rightarrow$(\rmnum{2}). Since the question is local, we may assume that $X$ is affine with local coordinate system $\{x_i,\partial_i\}$, so that we have $T^*X=X\times\C^n$. Assume that $\Ch(\mathscr{M})=T^*_XX$, then for a good filtration of $\mathscr{M}$ we have
\[\sqrt{\Ann_{\mathscr{O}_X[\xi_1,\dots,\xi_n]}(\gr(\mathscr{M}))}=\sum_{i=1}^{n}\mathscr{O}_X[\xi]\xi_i.\]
Here we denote by $\xi_i$ the principal symbol of $\partial_i$, and we identify $\pi_*(\mathscr{O}_{T^*X})$ with $\mathscr{O}_X[\xi_1,\dots,\xi_n]$. Note that if we set $\mathfrak{I}=\sum_{i=1}^{n}\mathscr{O}_X[\xi]\xi_i$, then since $\mathscr{O}_X[\xi_1,\dots,\xi_n]$ is Noetherian, there exists an integer $m>0$ such that we have
\[\mathfrak{I}^m\sub\Ann_{\mathscr{O}_X[\xi_1,\dots,\xi_n]}(\gr(\mathscr{M}))\sub\mathfrak{I}\]
for $m\gg 0$. Since the monomials $\xi^\alpha$ of degree $m$ generate $\mathfrak{I}^m$, we conclude that
\[\partial^\alpha F_j(\mathscr{M})\sub F_{j+m-1}(\mathscr{M}),\quad |\alpha|=m,\quad j\in\Z.\]
On the other hand, since the filtration is good, we have $F_i(\mathscr{D}_X)F_j(\mathscr{M})=F_{i+j}(\mathscr{M})$ for $j\gg 0$, so it follows that
\begin{align*}
F_{m+j}(\mathscr{M})&=F_m(\mathscr{D}_X)F_j(\mathscr{M})=\sum_{|\alpha|\leq m}\mathscr{O}_X\partial^\alpha F_j(\mathscr{M})\sub F_{j+m-1}(\mathscr{M}).
\end{align*}
This implies $F_{j+1}(\mathscr{M})=F_j(\mathscr{M})=\mathscr{M}$ for $j\gg 0$, which means $\mathscr{M}$ is coherent over $\mathscr{O}_X$ (since each $F_i(\mathscr{M})$ is coherent over $\mathscr{O}_X$).
\end{proof}

\begin{example}
For a coherent $\mathscr{D}_X$-module $\mathscr{M}=D_Xu\cong\mathscr{D}_X/\mathscr{I}$, where $\mathscr{I}=\Ann(u)$, consider the good filtration $F_i(\mathscr{M})=F_i(\mathscr{D}_X)u$ on $\mathscr{M}$. If we define a filtration on $\mathscr{I}$ by $F_i(\mathscr{I})=F_i(\mathscr{D}_X)\cap\mathscr{I}$, then we have $\gr(\mathscr{M})\cong\gr(\mathscr{D}_X)/\gr(\mathscr{I})$. In this case, the graded ideal $\gr(\mathscr{I})$ is generated by the principal symbols $\sigma(P)$ of $P\in\mathfrak{I}$. Therefore, for an arbitrary set $\{\sigma(P_i)\}$ of generators of $\gr(\mathscr{I})$, we have $\mathfrak{I}=\sum_i\mathscr{D}_XP_i$ and
\[\Ch(\mathscr{M})=\{(x,\xi)\in T^*X:\text{$\sigma(P_i)(x,\xi)=0$ for each $i$}\}.\]
However, for a set $\{Q_i\}$ of generators of $\mathfrak{I}$, the similar equality does not always hold. In general, we have only the inclusion
\[\Ch(\mathscr{M})\sub\{(x,\xi)\in T^*X:\text{$\sigma(Q_i)(x,\xi)=0$ for each $i$}\}.\]
This failure is due to the fact that in general we do note have
\[\gr(\mathscr{I})=\sum\gr(\mathscr{D}_X)\sigma_i(P_i).\]
\end{example}

One of the most fundamental results in the theory of $D$-modules is the following result about the characteristic varieties of coherent $D$-modules.

\begin{theorem}\label{D-module characteristic variety involutive}
The characteristic variety of any coherent $\mathscr{D}_X$-module is involutive (or coisotropic) with respect to the symplectic structure of the cotangent bundle $T^*X$.
\end{theorem}

Let us admit this theorem for the time being and proceed with our arguments. Since the dimension of any involutive closed analytic subset is greater than or equal to $\dim(X)$, we obtain the following proposition.

\begin{proposition}\label{D-module characteristic variety dimension geq n}
For every coherent $\mathscr{D}_X$-module $\mathscr{M}$, the dimension of $\Ch(\mathscr{M})$ at every point is greater than or equal to $\dim(X)$.
\end{proposition}

A coherent $\mathscr{D}_X$-module $\mathscr{M}$ is called a \textbf{holonomic $\mathscr{D}_X$-module} (or a holonomic system, or a \textbf{maximally overdetermined system}) if it satisfies $\dim(\Ch(\mathscr{M}))=\dim(X)$. By \cref{D-module characteristic variety involutive}, characteristic varieties of holonomic $\mathscr{D}_X$-modules are $\C^\times$-invariant Lagrangian subset of $T^*X$. Holonomic $\mathscr{D}_X$-modules are the coherent $\mathscr{D}_X$-modules whose characteristic variety has minimal possible dimension. Assume that the dimension of the characteristic variety $\Ch(M)$ is "small", then this means that the ideal defining the corresponding system of differential equations is "large", and hence the space of the solutions should be "small". In fact, we will see later that the holonomicity is related to the finite dimensionality of the solution space.

\subsection{Codimension filtration}

\begin{theorem}\label{D-module sExt with D_X prop}
Let $\mathscr{M}$ be a coherent $\mathscr{D}_X$-module.
\begin{enumerate}
    \item[(a)] $\sExt_{\mathscr{D}_X}^i(\mathscr{M},\mathscr{D}_X)=0$ for $i<\codim(\Ch(\mathscr{M}))$.
    \item[(b)] $\codim(\Ch(\sExt_{\mathscr{D}_X}^i(\mathscr{M},\mathscr{D}_X)))\geq i$.
    \item[(c)] $\Ch(\sExt_{\mathscr{D}_X}^i(\mathscr{M},\mathscr{D}_X))\sub\Ch(\mathscr{M})$.
\end{enumerate}
\end{theorem}
\begin{proof}

\end{proof}

\subsection{Global dimension of \texorpdfstring{$\mathscr{D}_X$}{D}}
Recall that we have defined a functor
\[\sHom_{\mathscr{O}_X}:\Mod(\mathscr{D}_X)^{\op}\times\Mod(\mathscr{D}_X)\to\Mod(\mathscr{D}_X),\]
whose derived functor is denoted by
\[R\!\sHom_{\mathscr{O}_X}:D^-(\mathscr{D}_X)^{\op}\times D^+(\mathscr{D}_X)\to D^+(\mathscr{D}_X).\]
Since injective $\mathscr{D}_X$-modules are injective $\mathscr{O}_X$-modules, the diagram
\[\begin{tikzcd}[column sep=15mm]
D^-(\mathscr{D}_X)^{\op}\times D^+(\mathscr{D}_X)\ar[r,"R\!\sHom_{\mathscr{O}_X}"]\ar[d]&D^+(\mathscr{D}_X)\ar[d]\\
D^-(\mathscr{O}_X)^{\op}\times D^+(\mathscr{O}_X)\ar[r,"R\!\sHom_{\mathscr{O}_X}"]&D^+(\mathscr{O}_X)
\end{tikzcd}\]
is commutative.

\begin{lemma}\label{D-module derived Hom and Kronecker tensor adjoint}
There is a canonical isomorphism
\[R\!\sHom_{\mathscr{D}_X}(\mathscr{O}_X,R\!\sHom_{\mathscr{O}_X}(\mathscr{M},\mathscr{N}))\cong R\!\sHom_{\mathscr{D}_X}(\mathscr{M},\mathscr{N}).\]
\end{lemma}

Let $\mathscr{M},\mathscr{N}\in\Mod(\mathscr{D}_X)$ and $d_X=\dim(X)$. Since $H^iR\!\sHom_{\mathscr{O}_X}(\mathscr{M},\mathscr{N})=0$ for $i>d_X+1$ by Golovin's theorem (\cite{Golovin}), $R\!\sHom_{\mathscr{O}_X}(\mathscr{M},\mathscr{N})$ can be represented by a complex $\mathscr{K}^\bullet$ with $\mathscr{K}^i=0$ for $i>d_X+1$ and $i<0$. We therefore obtain an isomorphism
\[R\!\sHom_{\mathscr{D}_X}(\mathscr{M},\mathscr{N})\cong R\!\sHom_{\mathscr{D}_X}(\mathscr{O}_X,\mathscr{K}^\bullet)\cong\sHom_{\mathscr{D}_X}(\mathscr{D}_X\otimes_{\mathscr{O}_X}\bigw^\bullet\Theta_X,\mathscr{K}^\bullet).\]
This leads us to the following theorem about the global dimension of $\mathscr{D}_X$.

\begin{theorem}\label{D-module global dimension 2n+1}
The global dimension of $\mathscr{D}_X$ is bounded by $2d_X+1$.
\end{theorem}
\begin{proof}
Since the complex $\mathscr{D}_X\otimes_{\mathscr{O}_X}\bigw^\bullet\Theta_X$ is concentrated at degrees $[0,d_X]$ and $\mathscr{K}^\bullet$ at degrees $[0,1+d_X]$, we conclude that $H^iR\!\sHom_{\mathscr{D}_X}(\mathscr{O}_X,\mathscr{K}^\bullet)=0$ for $i>2d_X+1$, which proves our assertion.
\end{proof}

\begin{remark}
Let $X=\C^n$ with $n>1$ and $I$ be an infinite set. Since $R\!\sHom_{\mathscr{D}_X}(\mathscr{O}_X,\mathscr{D}_X^{\oplus I})\cong\mathscr{O}_X^{\oplus I}[-n]$, we have
\[\Ext_{\mathscr{D}_X}^{2n+1}(\mathscr{O}_{X,0},\mathscr{D}_X^{\oplus I})\cong H_{\{0\}}^{n+1}(X,\mathscr{O}_X^{\oplus I}).\]
We prove that this does not vanish by induction on $n$. Suppose that $n>1$, and let $p:X\to Y=\C^{n-1}$ be the projection map. Then we have an exact sequence
\[\begin{tikzcd}
0\ar[r]&p^{-1}(\mathscr{O}_Y^{\oplus I})\ar[r]&\mathscr{O}_X^{\oplus I}\ar[r,"\partial_n"]&\mathscr{O}_X^{\oplus I}\ar[r]&0
\end{tikzcd}\]
and accordingly an exact sequence
\[\begin{tikzcd}
H_{\{0\}}^{n+1}(X,\mathscr{O}_X^{\oplus I})\ar[r]&H_{\{0\}}^{n+2}(X,p^{-1}(\mathscr{O}_Y^{\oplus I}))\ar[r]&H_{\{0\}}^{n+2}(X,\mathscr{O}_X^{\oplus I})=0
\end{tikzcd}\]
Note that $H^i_{\{0\}}(X,p^{-1}(\mathscr{F}))=H^{i-2}_{\{0\}}(Y,\mathscr{F})$ for any sheaf $\mathscr{F}$ over $Y$, so we conclude that
\[H^{n+2}_{\{0\}}(X,p^{-1}(\mathscr{O}_Y^{\oplus I}))=H^n_{\{0\}}(Y,\mathscr{O}_Y^{\oplus I})\neq 0\]
and therefore $H^{n+1}_{\{0\}}(X,\mathscr{O}_X^{\oplus I})\neq 0$.
\end{remark}

We shall next consider the global dimension of $\mathscr{D}_{X,x}$ for any point $x\in X$. For this, it suffices to consider the following lemma.
\begin{lemma}\label{Noe ring finite module projdim finite if Ext bounded}
Suppose that the projective dimension of a finitely generated module $M$ over a Noetherian ring $A$ is finite, and that $\Ext_A^i(M,A)=0$ for $i>r$. Then the projective dimension of $M$ is less than or equal to $r$.
\end{lemma}
\begin{proof}

\end{proof}

\begin{theorem}\label{D-module global dimension of stalk n}
Let $X$ be an $n$-dimensional smooth algebra variety. Then for any affine open subset $U$ and $x\in X$, the global dimension of $\Gamma(U,\mathscr{D}_X)$ and $\mathscr{D}_{X,x}$ are equal $n$.
\end{theorem}
\begin{proof}
By \cref{Noe ring finite module projdim finite if Ext bounded}, it suffices to show that $\sExt_{\mathscr{D}_X}^i(\mathscr{M},\mathscr{D}_X)=0$ for $i>n$ and any coherent $\mathscr{D}_X$-module. By \cref{D-module sExt with D_X prop}~(b), we have
\[\codim(\Ch(\sExt_{\mathscr{D}_X}^i(\mathscr{M},\mathscr{D}_X)))\geq i>n\]
so $\sExt_{\mathscr{D}_X}^i(\mathscr{M},\mathscr{D}_X)=0$ by \cref{D-module characteristic variety dimension geq n}. We therefore conclude that $\gldim(\mathscr{D}_{X,x})\leq n$ and $\gldim(\Gamma(U,\mathscr{D}_X))$, and the equality follows from
\[\Ext_{\Gamma(U,\mathscr{D}_X)}^n(\Gamma(U,\mathscr{O}_{X}),\Gamma(U,\mathscr{D}_{X}))=\Gamma(U,\Omega_X)\neq 0\]
(cf. \cref{D-module dual of coh char by sheaf dual}).
\end{proof}

\subsection{Duality functor}
Let $D(\mathscr{D}_X)$ be the derived category of $\Mod(\mathscr{D}_X)$, and $D^*(\mathscr{D}_X)$ ($*\in\{+,-,b\}$) denote the full subcategory of $D(\mathscr{D}_X)$ consisting of complexes bounded above, below, and bounded, respectively. Let $D^b_{\coh}(\mathscr{D}_X)$ denote the full subcategory of $\mathscr{M}\in D^b(\mathscr{D}_X)$ such that $H^i(\mathscr{M})$ are coherent $\mathscr{D}_X$-modules. Then since $\Coh(\mathscr{D}_X)$ is a Serre subcategory of $\Mod(\mathscr{D}_X)$, we see that $D^b_{\coh}(\mathscr{D}_X)$ is a triangulated subcategory of $D^b(\mathscr{D}_X)$.\par
We now try to find heuristically a candidate for the "dual" of a left $\mathscr{D}$-module. Let $\mathscr{M}$ be a left $\mathscr{D}_X$-module. Since $\mathscr{D}_X$ is a $(\mathscr{D}_X,\mathscr{D}_X)$-bimodule, we see $\sHom_{\mathscr{D}_X}(\mathscr{M},\mathscr{D}_X)$ is a right $\mathscr{D}_X$-module by right multiplication of $\mathscr{D}_X$ on $\mathscr{D}_X$. By the side-changing functor $\otimes_{\mathscr{O}_X}\Omega_X^{\otimes -1}$, we then obtain a left $\mathscr{D}_X$-module $\sHom_{\mathscr{D}_X}(\mathscr{M},\mathscr{D})\otimes_{\mathscr{O}_X}\Omega_X^{\otimes-1}$. Since the functor $\sHom_{\mathscr{D}_X}(-,\mathscr{D}_X)$ is not exact, a more natural choice is the complex $R\!\sHom_{\mathscr{D}_X}(\mathscr{M},\mathscr{D}_X)\otimes_{\mathscr{O}_X}\Omega_X^{\otimes-1}$ of left $\mathscr{D}_X$-modules.

\begin{example}
Let $X=\C$ (or an open subset of $\C$) and $\mathscr{M}=\mathscr{D}_X/\mathscr{D}_XP$ ($P\neq 0$). By applying the functor $\sHom_{\mathscr{D}_X}(-,\mathscr{D}_X)$ to the exact sequence
\[\begin{tikzcd}
0\ar[r]&\mathscr{D}_X\ar[r,"\cdot P"]&\mathscr{D}_X\ar[r]&\mathscr{M}\ar[r]&0
\end{tikzcd}\]
of left $\mathscr{D}_X$-modules, we get an exact sequence
\[\begin{tikzcd}
0\ar[r]&0\ar[r]&\sHom_{\mathscr{D}_X}(\mathscr{M},\mathscr{D}_X)\ar[r]&\mathscr{D}_X\ar[r,"P\cdot"]&\mathscr{D}_X
\end{tikzcd}\]
Hence in this case, we have 
\[\sExt_{\mathscr{D}_X}^0(\mathscr{M},\mathscr{D}_X)=\sHom_{\mathscr{D}_X}(\mathscr{M},\mathscr{D}_X)=\ker(P:\mathscr{D}_X\to\mathscr{D}_X)=0,\]
and the only non-vanishing cohomology group is the first one
\[\sExt_{\mathscr{D}_X}^1(\mathscr{M},\mathscr{D}_X)=\mathscr{D}_X/P\mathscr{D}_X.\]
The left DX-module obtained by the side changing $\otimes\Omega_X^{\otimes-1}$ is isomorphic to
\[\sExt_{\mathscr{D}_X}^1(\mathscr{M},\mathscr{D}_X)\otimes_{\mathscr{O}_X}\Omega_X^{\otimes-1}\cong \mathscr{D}_X/\mathscr{D}_XP^*,\]
where $P^*$ is the formal adjoint of $P$. From this calculation, we see that $\sExt^1$ is more suited than $\sExt^0$ to be called a "dual" of $\mathscr{M}$. More generally, if $d_X=\dim(X)$ and $\mathscr{M}$ is a holonomic $\mathscr{D}_X$-module, then we can (and will) prove that only the term $\sExt_{\mathscr{D}_X}^n(\mathscr{M},\mathscr{D}_X)$ survives and the resulting left $\mathscr{D}_X$-module $\sExt_{\mathscr{D}_X}^n(\mathscr{M},\mathscr{D}_X)\otimes_{\mathscr{O}_X}\Omega_X^{\otimes-1}$ is also holonomic. Hence the correct definition of the dual $D_X(\mathscr{M})$ of a holonomic $\mathscr{D}_X$-module $\mathscr{M}$ is given by $D_X(\mathscr{M})=\sExt_{\mathscr{D}_X}^n(\mathscr{M},\mathscr{D}_X)\otimes_{\mathscr{O}_X}\Omega_X^{\otimes-1}$. For a non-holonomic $\mathscr{D}_X$-module, one may have other non-vanishing cohomology groups, and hence the duality functor should be defined as follows for the derived categories.
\end{example}

We now define a contravariant functor $D_X:D^-(\mathscr{D}_X)\to D^+(\mathscr{D}_X)$ by
\[D_X(\mathscr{M})=R\!\sHom_{\mathscr{D}_X}(\mathscr{M},\mathscr{D}_X)\otimes_{\mathscr{O}_X}\Omega_X^{\otimes -1}[d_X]=R\!\sHom_{\mathscr{D}_X}(\mathscr{M},\mathscr{D}_X\otimes_{\mathscr{O}_X}\Omega_X^{\otimes -1})[d_X].\]
The shift $[d_X]$ is added so that $D_X$ sends $\mathscr{O}_X$ to itself. Since the cohomological dimension of $\mathscr{D}_X$ is finite, $D_X$ preserves $D^b(\mathscr{D}_X)$.

\begin{example}
We have 
\[H^i(D_X(\mathscr{D}_X))=\begin{cases}
\mathscr{D}_X\otimes_{\mathscr{O}_X}\Omega_X^{\otimes-1}&i=-d_X,\\
0&i\neq -d_X.
\end{cases}\]
\end{example}

\begin{lemma}\label{D-module sExt compatible with restriction}
Let $\mathscr{M}$ be a coherent $\mathscr{D}_X$-module. Then for any affine open subset $U$ of $X$, we have
\[\Gamma(U,\sExt_{\mathscr{D}_X}^i(\mathscr{M},\mathscr{D}_X))=\Ext_{\Gamma(U,\mathscr{D}_X)}^i(\Gamma(U,\mathscr{M}),\Gamma(U,\mathscr{D}_X)).\]
\end{lemma}
\begin{proof}

\end{proof}

\begin{proposition}\label{D-module dual functor involutive prop}
The functor $D_X$ sends $D_{\coh}^b(\mathscr{D}_X)$ to $D^b_{\coh}(\mathscr{D}_X)^{\op}$ and $D_X^2\cong\id$ on $D_{\coh}^b(\mathscr{D}_X)$. In particular, $D_X$ is fully faithful on $D_{\coh}^b(\mathscr{D}_X)$.
\end{proposition}
\begin{proof}
We see from \cref{D-module sExt compatible with restriction} that $H^i(D_X(\mathscr{M}))$ is coherent for each $i$, whence the first claim. Now we construct a canonical morphism $\mathscr{M}\to D_X^2(\mathscr{M})$ for $\mathscr{M}\in D^b(\mathscr{D}_X)$. First note that
\[D_X^2(\mathscr{M})\cong R\!\sHom_{\mathscr{D}_X^{\op}}(R\!\sHom_{\mathscr{D}_X}(\mathscr{M},\mathscr{D}_X),\mathscr{D}_X),\]
where $R\!\sHom_{D_X}(\mathscr{M},\mathscr{D}_X)$ and $\mathscr{D}_X$ are regareded as objects of $D^b(\mathscr{D}_X^{\op})$ byy the right multiplication of $\mathscr{D}_X$, and the left $\mathscr{D}_X$-action on the right hand side is induced from the left multiplication of $\mathscr{D}_X$. Set $\mathscr{H}^\bullet=R\!\sHom_{\mathscr{D}_X}(\mathscr{M},\mathscr{D}_X)\in D^b_{\coh}(\mathscr{D}_X^{\op})$. Then we have an isomorphism (note that $\otimes_\C$ is exact, hence has no derived functors)
\[R\!\sHom_{\mathscr{D}_X\otimes_{\C}\mathscr{D}_X^{\op}}(\mathscr{M}\otimes_{\C}\mathscr{H}^\bullet,\mathscr{D}_X)\cong R\!\sHom_{\mathscr{D}_X}(\mathscr{M},R\!\sHom_{\mathscr{D}_X^{\op}}(\mathscr{H}^\bullet,\mathscr{D}_X)).\]
Applying $H^0(R\Gamma(X,-))$, we then obtain
\[\Hom_{\mathscr{D}_X\otimes_{\C}\mathscr{D}_X^{\op}}(\mathscr{M}\otimes_{\C}\mathscr{H}^\bullet,\mathscr{D}_X)\cong \Hom_{\mathscr{D}_X}(\mathscr{M},R\!\sHom_{\mathscr{D}_X^{\op}}(\mathscr{H}^\bullet,\mathscr{D}_X)).\]
Hence the canonical homomorphism $\mathscr{M}\otimes_{\C}\mathscr{H}^\bullet\to\mathscr{D}_X$ gives rise to a canonical morphism
\[\mathscr{M}\to R\!\sHom_{\mathscr{D}_X^{\op}}(\mathscr{H}^\bullet,\mathscr{D}_X).\]
To show that this morphism is an isomorphism for $\mathscr{M}\in D_{\coh}^b(\mathscr{D}_X)$, we may assume that $X$ is affine. Then we can replace $\mathscr{M}$ with $\mathscr{D}_X$ by a five lemma argument, and the claim is then clear.
\end{proof}

\begin{proposition}\label{D-module dual of holonomic prop}
Let $\mathscr{M}$ be a coherent $\mathscr{D}_X$-module.
\begin{enumerate}
    \item[(a)] $H^i(D_X(\mathscr{M}))=0$ unless $\codim(\Ch(\mathscr{M}))-d_X\leq i\leq 0$.
    \item[(b)] $\codim(\Ch(H^i(D_X(\mathscr{M}))))\geq d_X+i$.
    \item[(c)] $\mathscr{M}$ is holonomic if and only if $H^i(D_X(\mathscr{M}))=0$ for $i\neq 0$.
    \item[(d)] If $\mathscr{M}$ is holonomic, then $D_X(\mathscr{M})\cong H^0(D_X(\mathscr{M}))$ is also holonomic.
\end{enumerate}
\end{proposition}
\begin{proof}
Since $D_X(\mathscr{M})\cong R\!\sHom_{\mathscr{D}_X}(\mathscr{M},\mathscr{D}_X)[d_x]$ as $\mathscr{O}_X$-modules, the first two assertions follow from \cref{D-module sExt with D_X prop}. The statement (d) and the only if part of (c) follow follow from (a), (b) and \cref{D-module characteristic variety dimension geq n}, so it suffices to prove that if part of (c). Assume that $H^i(D_X(\mathscr{M}))=0$ for $i\neq 0$, that is, $D_X(\mathscr{M})\cong H^0(D_X(\mathscr{M}))$. If we write $\mathscr{M}^*=H^0(D_X(\mathscr{M}))$, then $D_X(\mathscr{M}^*)=D^2_X(\mathscr{M})\cong\mathscr{M}$ and $H^0(D_X(\mathscr{M}^*))\cong \mathscr{M}$. On the other hand, by (b) we have $\codim(\Ch(H^0(D_X(\mathscr{M}^*))))\geq d_X$, and hence $D_X(\mathscr{M}^*)\cong\mathscr{M}$ is a holonomic $\mathscr{D}_X$-module.
\end{proof}

\begin{proposition}\label{D-module dual of coh char by sheaf dual}
Let $\mathscr{M}$ be an integrable connection. Then
\[D_X(\mathscr{M})\cong \sHom_{\mathscr{O}_X}(\mathscr{M},\mathscr{O}_X).\]
\end{proposition}
\begin{proof}
We consider the locally free resolution
\begin{equation}\label{D-module dual of coh char by sheaf dual-1}
\begin{tikzcd}
0\ar[r]&\mathscr{D}_X\otimes_{\mathscr{O}_X}\bigw^{d_X}\Theta_X\ar[r]&\cdots\ar[r]&\mathscr{D}_X\otimes_{\mathscr{O}_X}\Theta_X\ar[r]&\mathscr{D}_X\ar[r]&\mathscr{O}_X\ar[r]&0
\end{tikzcd}
\end{equation}
of $\mathscr{O}_X$. Since $\mathscr{M}$ is locally free over $\mathscr{O}_X$, $\mathscr{D}_X\otimes_{\mathscr{O}_X}\bigw^\bullet\Theta_X\otimes_{\mathscr{O}_X}\mathscr{M}$ is a locally free resolution of $\mathscr{M}$. Using this resolution, we can calculate $D_X(\mathscr{M})$ by the complex
\begin{align*}
\sHom_{\mathscr{D}_X}&(\mathscr{D}_X\otimes_{\mathscr{O}_X}(\bigw^\bullet\Theta_X\otimes_{\mathscr{O}_X}\mathscr{M}),\mathscr{D}_X\otimes_{\mathscr{O}_X}\Omega_X^{\otimes-1})[d_X]\\
&\cong \sHom_{\mathscr{O}_X}(\bigw^\bullet\Theta_X\otimes_{\mathscr{O}_X}\mathscr{M},\mathscr{D}_X\otimes_{\mathscr{O}_X}\Omega_X^{\otimes-1})[d_X]\\
&\cong \sHom_{\mathscr{O}_X}(\Omega_X\otimes_{\mathscr{O}_X}\bigw^\bullet\Theta_X\otimes_{\mathscr{O}_X}\mathscr{M},\Omega_X\otimes_{\mathscr{O}_X}\mathscr{D}_X\otimes_{\mathscr{D}_X}\Omega_X^{\otimes-1})[d_X].
\end{align*}
Since $\Omega_X\otimes_{\mathscr{O}_X}\bigw^\bullet\Theta_X\cong\Omega_X^\bullet$, this is isomorphic to
\begin{align*}
\sHom_{\mathscr{O}_X}&(\Omega_X^\bullet\otimes_{\mathscr{O}_X}\mathscr{M},\mathscr{O}_X)\otimes_{\mathscr{O}_X}(\Omega_X\otimes_{\mathscr{O}_X}\mathscr{D}_X\otimes_{\mathscr{D}_X}\Omega_X^{\otimes-1})[d_X]\\
&\cong (\bigw^\bullet\Theta_X\otimes_{\mathscr{O}_X}\sHom_{\mathscr{O}_X}(\mathscr{M},\mathscr{O}_X))\otimes_{\mathscr{O}_X}(\Omega_X\otimes_{\mathscr{O}_X}\mathscr{D}_X\otimes_{\mathscr{D}_X}\Omega_X^{\otimes-1})[d_X]\\
&\cong \mathscr{D}_X\otimes(\bigw^\bullet\Theta_X\otimes_{\mathscr{O}_X}\sHom_{\mathscr{O}_X}(\mathscr{M},\mathscr{O}_X))[d_X].
\end{align*}
This complex is quasi-isomorphic to $\sHom_{\mathscr{O}_X}(\mathscr{M},\mathscr{O}_X)$ in view of (\ref{D-module dual of coh char by sheaf dual-1}).
\end{proof}

For a complex $\mathscr{M}\in D^b(\mathscr{D}_X)$, we define the support of $\mathscr{M}$ by
\[\supp(\mathscr{M}):=\bigcup_i\supp(H^i(\mathscr{M})).\]
and for $\mathscr{M}\in D^b_{\coh}(\mathscr{D}_X)$, we set
\[\Ch(\mathscr{M}):=\bigcup_i\Ch(H^i(\mathscr{M})).\]
\begin{proposition}\label{D-module dual of coh characteristic variety char}
For a coherent $\mathscr{M}\in D_{\coh}^b(\mathscr{D}_X)$, we have
\[\Ch(D_X(\mathscr{M}))=\Ch(\mathscr{M}).\]
\end{proposition}
\begin{proof}
The proof of the inclusion $\Ch(D_x(\mathscr{M}))\sub\Ch(\mathscr{M})$ is reduced to the case $\mathscr{M}\in\Mod(\mathscr{D}_X)$, which is nothing but \cref{D-module sExt with D_X prop}. Then, by applying this to $D_X(\mathscr{M})$, we obtain the inverse inclusion, since $D_X^2(\mathscr{M})\cong\mathscr{M}$.
\end{proof}

In the rest of this paragraph, we give a description of $R\!\sHom_{\mathscr{D}_X}(\mathscr{M},\mathscr{N})$ for $M\in D^b_{\coh}(\mathscr{D}_X)$, $N\in D^b(\mathscr{D}_X)$, in terms of the duality functor.

\begin{lemma}\label{D-module Hom and tensor with dual isomorphic for coh}
For $M\in D^b_{\coh}(\mathscr{D}_X)$ and $N\in D^b(\mathscr{D}_X)$, we have
\[R\!\sHom_{\mathscr{D}_X}(\mathscr{M},\mathscr{N})\cong R\!\sHom_{\mathscr{D}_X}(\mathscr{M},\mathscr{D}_X)\otimes_{\mathscr{D}_X}^L\mathscr{N}.\]
\end{lemma}
\begin{proof}
Note that there is a canonical morphism
\[R\!\sHom_{\mathscr{D}_X}(\mathscr{M},\mathscr{N})\to  R\!\sHom_{\mathscr{D}_X}(\mathscr{M},\mathscr{D}_X)\otimes_{\mathscr{D}_X}^L\mathscr{N}.\]
Hence we may assume that $\mathscr{M}=\mathscr{D}_X$, in which case the assertion is obvious since both sides are isomorphic to $\mathscr{N}$.
\end{proof}

\begin{proposition}\label{D-module Hom of coh isomorphism by duality}
For $M\in D^b_{\coh}(\mathscr{D}_X)$ and $N\in D^b(\mathscr{D}_X)$, we have
\begin{align}
R\!\sHom_{\mathscr{D}_X}(\mathscr{M},\mathscr{N})&\cong(\Omega_X\otimes_{\mathscr{O}_X}^LD_X(\mathscr{M}))\otimes_{\mathscr{D}_X}^L\mathscr{N}[-d_X]\label{D-module Hom of coh isomorphism by duality-1}\\
&\cong \Omega_X\otimes_{\mathscr{D}_X}^L(D_X(\mathscr{M})\otimes_{\mathscr{O}_X}^L\mathscr{N})[-d_X]\label{D-module Hom of coh isomorphism by duality-2}\\
&\cong R\!\sHom_{\mathscr{D}_X}(\mathscr{O}_X,D_X(\mathscr{M})\otimes_{\mathscr{O}_X}^L\mathscr{N}) \label{D-module Hom of coh isomorphism by duality-3}
\end{align}
in $D^b(\C_X)$. In particular, we have 
\begin{equation}\label{D-module Hom of coh isomorphism by duality-4}
R\!\sHom_{\mathscr{D}_X}(\mathscr{O}_X,\mathscr{N})\cong\Omega_X\otimes_{\mathscr{O}_X}^L\mathscr{N}[-d_X].
\end{equation}
\end{proposition}
\begin{proof}
We first prove (\ref{D-module Hom of coh isomorphism by duality-4}). By \cref{D-module Hom and tensor with dual isomorphic for coh}, we may assume that $\mathscr{N}=\mathscr{D}_X$. In this case, by \cref{D-module resolution of Omega_X and O_X} we have
\begin{align*}
R\!\sHom_{\mathscr{D}_X}(\mathscr{O}_X,\mathscr{D}_X)&\cong \sHom_{\mathscr{D}_X}(\mathscr{D}_X\otimes_{\mathscr{O}_X}\bigw^\bullet\Theta_X,\mathscr{D}_X)\cong\sHom_{\mathscr{O}_X}(\bigw^\bullet\Theta_X,\mathscr{D}_X)\\
&\cong\Omega_X^\bullet\otimes_{\mathscr{O}_X}\mathscr{D}_X\cong\Omega_X[-d_X].
\end{align*}
Now in the general case, by \cref{D-module Hom and tensor with dual isomorphic for coh} we have
\begin{align*}
R\!\sHom_{\mathscr{D}_X}(\mathscr{M},\mathscr{N})\cong R\!\sHom_{\mathscr{D}_X}(\mathscr{M},\mathscr{D}_X)\otimes_{\mathscr{D}_X}^L\mathscr{N}\cong(\Omega_X\otimes_{\mathscr{O}_X}^LD_X(\mathscr{M}))\otimes_{\mathscr{D}_X}^L\mathscr{N}[-d_X].
\end{align*}
The second and the third isomorphisms follow from the derived version of \cref{D-module tensor with Kronecker tensor isomorphism} and (\ref{D-module Hom of coh isomorphism by duality-4}), respectively.
\end{proof}

\section{Functorial properties of \texorpdfstring{$D$}{D}-modules}
\subsection{Inverse images of \texorpdfstring{$D$}{D}-modules}
\paragraph{The transfer module \texorpdfstring{$\mathscr{D}_{X\to Y}$}{D}}
Let $f:X\to Y$ be a morphism of smooth algebraic varieties. We want to construct a $\mathscr{D}_X$-module by lifting a $\mathscr{D}_Y$-module. Let $\mathscr{M}$ be a (left) $\mathscr{D}_Y$-module and consider its inverse image
\[f^*(\mathscr{M})=\mathscr{O}_X\otimes_{f^{-1}(\mathscr{O}_Y)}f^{-1}(\mathscr{M}).\]
We can endow $f^*(\mathscr{M})$ with a (left) $\mathscr{D}_X$-module structure as follows. First, note that we have a canonical $\mathscr{O}_X$-linear homomorphism
\begin{equation}\label{D-module inverse image def-1}
\Theta_X\to f^*(\Theta_Y)=\mathscr{O}_X\otimes_{f^{-1}(\mathscr{O}_Y)}f^{-1}(\Theta_Y),\quad v\mapsto\tilde{v}
\end{equation}
obtained by taking the $\mathscr{O}_X$-dual of the homomorphism $\mathscr{O}_X\otimes_{f^{-1}(\mathscr{O}_Y)}f^{-1}(\Omega_Y^1)\to\Omega_X^1$. Then we can define a left $\mathscr{D}_X$-module structure on $f^*(\mathscr{M})$ by
\begin{equation}\label{D-module inverse image def-2}
v(a\otimes s)=v(a)\otimes s+a\tilde{v}(s),\quad v\in\Theta_X,a\in\mathscr{O}_X,s\in\mathscr{M}.
\end{equation}
Here, if we write $\tilde{v}=\sum_ia_i\otimes w_i$ with $a_i\in\mathscr{O}_X$ and $w_i\in\Theta_Y$, then
\begin{equation}\label{D-module inverse image def-3}
\tilde{v}(s)=\sum_ia_i\otimes w_i(s).
\end{equation}
This definition is independent of the choice of $\sum_ia_i\otimes w_i$. Indeed, since we can define a morphism
\[(\mathscr{O}_X\otimes_{f^{-1}(\mathscr{O}_Y)}f^{-1}(\Theta_Y))\otimes_{\C}f^{-1}(\mathscr{M})\to \mathscr{O}_X\otimes_{f^{-1}(\mathscr{O}_Y)}f^{-1}(\mathscr{M}),\quad (f\otimes v)\otimes s\mapsto f\otimes vs\]
we obtain from (\ref{D-module inverse image def-1}) a homomorphism
\[\Theta_X\otimes_{\C}(\mathscr{O}_X\otimes_{\C}f^{-1}(\mathscr{M}))\to \mathscr{O}_X\otimes_{f^{-1}(\mathscr{O}_Y)}f^{-1}(\mathscr{M})\]
which can be checked to be given by 
\[v\otimes a\otimes s\mapsto \sum_iaa_i\otimes w_i(s).\]
Moreover, it is easily seen that $v(af^*(b)\otimes s)=v(a\otimes bs)$ for $b\in\mathscr{O}_Y$, so this provides us a homomorphism $\Theta_X\otimes_{\C}f^*(\mathscr{M})\to f^*(\mathscr{M})$. Since this action satisfies the conditions of \cref{D-module ring D_X generating relation}, it can be extended to an action of $\mathscr{D}_X$. If we are given a local coordinate system $\{y_i,\partial_i\}$ of $Y$, then the action of $v\in\Theta_X$ can be written more explicitly as
\begin{equation}\label{D-module inverse image def-4}
v(a\otimes s)=v(a)\otimes s+a\sum_{i=1}^{n}v(y_i\circ f)\otimes\partial_is.
\end{equation}

Regarding $\mathscr{D}_Y$ as a left $\mathscr{D}_Y$-module by the left multiplication, we obtain a left $\mathscr{D}_X$-module $f^*(\mathscr{D}_Y)=\mathscr{O}_X\otimes_{f^{-1}(\mathscr{O}_Y)}f^{-1}(\mathscr{D}_Y)$. Then the right multiplication of $\mathscr{D}_Y$ on $\mathscr{D}_Y$ induces a right $f^{-1}(\mathscr{D}_Y)$-module structure on $f^*(\mathscr{D}_Y)$:
\[(a\otimes P)Q=a\otimes PQ,\quad a\in\mathscr{O}_X,P,Q\in\mathscr{D}_Y,\]
and it is immediate that these two actions commute, so $f^*(\mathscr{D}_Y)$ turns out to be a $(\mathscr{D}_X,f^{-1}(\mathscr{D}_Y))$-bimodule, which is denote by $\mathscr{D}_{X\to Y}$. Let $1_{X\to Y}$ denote the canonical element $1\otimes 1$ of $\mathscr{D}_{X\to Y}$. Then for $b\in\mathscr{O}_Y$, we have
\begin{equation}\label{D-module inverse image def-5}
v1_{X\to Y}=\sum_ia_i1_{X\to Y}w_i,\quad 1_{X\to Y}b=f^*(b)1_{X\to Y}.
\end{equation}

Therefore, if $\mathscr{M}$ is a left $\mathscr{D}_Y$-module, we have an isomorphism
\[f^*(\mathscr{M})\cong \mathscr{D}_{X\to Y}\otimes_{f^{-1}(\mathscr{D}_Y)}f^{-1}(\mathscr{M})\]
of left $\mathscr{D}_X$-modules. We have thus defined a functor
\[f^*:\Mod(\mathscr{D}_Y)\to\Mod(\mathscr{D}_X),\quad \mathscr{M}\mapsto \mathscr{D}_{X\to Y}\otimes_{f^{-1}(\mathscr{D}_Y)}f^{-1}(\mathscr{M}).\]

\begin{example}
Let $X=\C$ and $Y=\C$ with coordinates $\{x,\partial_x\}$ and $\{y,\partial_y\}$, respectively. Let $f$ be the morphism given by
\[f:X\to Y,\quad x\mapsto x^2.\]
Then
\[\mathscr{D}_Y=\bigoplus\mathscr{O}_Y\partial^n_y,\quad \mathscr{D}f^*(\mathscr{D}_Y)=\mathscr{D}_{X\to Y}=\bigoplus_{n\geq 0}\mathscr{O}_X\otimes_{\C}\C\partial_y^n\]
and we have
\[\partial_x(a\otimes\partial_y^n)=\frac{\partial a}{\partial x}\otimes\partial_y^n+2ax\otimes\partial_y^{n+1}.\]
While $\mathscr{D}_{X\to Y}$ is isomorphic to $\mathscr{D}_X$ in $X\setminus\{0\}$, we see that it is not coherent in a neighborhood of $x=0$. In fact, we have
\[\mathscr{D}_{X\to Y}=\bigoplus_{n\geq 0}\mathscr{O}_X(x^{-1}\partial_x)^n\sub\mathscr{D}_X[x^{-1}].\]
\end{example}

\begin{example}\label{D-module closed immersion relative inverse module}
Let $i:X\to Y$ be a closed immersion of smooth algebraic varieties. At each point $x\in X$, we can choose a local coordinate $\{y_i,\partial_{y_i}\}$ on an affine open subset of $Y$ such that $y_{r+1}=\cdots=y_n=0$ gives a local defining equation of $X$. We set $x_i=y_i\circ i$ for $i=1,\dots,r$, which gives a local coordinate $\{x_i,\partial_{x_i}\}$ of an affine open subset of $X$. The canonical morphism $\Theta_X\to\mathscr{O}_X\otimes_{i^{-1}(\mathscr{O}_Y)}i^{-1}(\Theta_Y)$ is then given by $\partial_{x_i}\mapsto\partial_{y_i}$ for $i=1,\dots,r$. Now consider
\[\mathscr{D}=\bigoplus_{\alpha_1,\dots,\alpha_r}\mathscr{O}_Y\partial_{y_1}^{\alpha_1}\cdots\partial_{y_r}^{\alpha_r}\sub\mathscr{D}_Y.\]
Since $[\partial_{y_i},\partial_{y_j}]=0$, $\mathscr{D}$ is a subring of $\mathscr{D}_Y$, and we have $\mathscr{D}_Y\cong\mathscr{D}\otimes_{\C}\C[\partial_{y_{r+1}},\dots,\partial_{y_n}]$ as a left $\mathscr{D}$-module. We therefore conclude that
\[\mathscr{D}_{X\to Y}\cong \mathscr{O}_X\otimes_{i^{-1}(\mathscr{O}_Y)}i^{-1}(\mathscr{D})\otimes_{\C}\C[\partial_{y_{r+1}},\dots,\partial_{y_n}].\]
On the other hand, it is easily seen that $\mathscr{D}_X$ is isomorphic to the submodule $\mathscr{O}_X\otimes_{i^{-1}(\mathscr{O}_Y)}i^{-1}(\mathscr{D})$ of $\mathscr{D}_{X\to Y}$, so we conclude that
\begin{equation}\label{D-module closed immersion relative inverse module-1}
\mathscr{D}_{X\to Y}\cong\mathscr{D}_X\otimes_{\C}\C[\partial_{y_{r+1}},\dots,\partial_{y_n}].
\end{equation}
as a left $\mathscr{D}_X$-module. In particular, $\mathscr{D}_{X\to Y}$ is a locally free $\mathscr{D}_X$-module of infinite rank (unless $r=n$).
\end{example}

\begin{proposition}\label{D-module smooth morphism relative D-module}
Let $f:X\to Y$ be a smooth morphism. Then $\mathscr{D}_{X\to Y}$ is generated by $1_{X\to Y}$ as a left $\mathscr{D}_X$-module.
\end{proposition}
\begin{proof}
We can locally write $f(x,y)=y$ in appropriate coordinate systems $y=(y_1,\dots,y_m)$ of $Y$ and $(x,y)=(x_1,\dots,x_n,y_1,\dots,y_m)$ of $X$. It then follows from (\ref{D-module inverse image def-4}) that
\[\partial_{x_i}(a\otimes P)=0,\quad \partial_{y_i}(a\otimes P)=a\otimes\partial_{y_i}P\for a\in\mathscr{O}_X,P\in\mathscr{D}_Y.\]
In particular, we see that $1_{X\to Y}\partial_{y_i}=\partial_{y_i}1_{X\to Y}$, so $\mathscr{D}_{X\to Y}$ is generated by $1_{X\to Y}$ as a left $\mathscr{D}_X$-module.
\end{proof}

Let $f:X\to Y$ be a smooth morphism of smooth algebraic varieties and $\Omega_{X/Y}^\bullet$ denote the sheaf of differential forms relative to $f$, that is,
\begin{align}
\Omega_{X/Y}^1&=\coker(f^*\Omega_Y^1\to\Omega_X^1),\label{D-module relative differential form def-1} \\
\Omega_{X/Y}^p&=\bigw^p\Omega_{X/Y}^1=\Omega_X^p/\big(\im(f^*(\Omega_Y^1)\to \Omega_X^1)\wedge \Omega_X^{p-1}\big).\label{D-module relative differential form def-2}
\end{align}
We then have the relative de Rham complex
\[\begin{tikzcd}
\Omega_{X/Y}^\bullet:\cdots\ar[r]&0\ar[r]&\Omega_{X/Y}^0\ar[r,"d^0_{X/Y}"]&\Omega_{X/Y}^1\ar[r]&\cdots\ar[r]&\Omega_{X/Y}^n\ar[r]&0\ar[r]&\cdots 
\end{tikzcd}
\]
($n$ is the relative dimension of $f$.) Since the differential $d_{X/Y}$ are differential homomorphisms of degree $1$, we obtain a complex of right $\mathscr{D}_X$-modules
\begin{equation}\label{D-module relative complex of D_X tensor Omega}
\begin{tikzcd}[column sep=6mm]
\Omega_{X/Y}^\bullet\otimes_{\mathscr{O}_X}\mathscr{D}_X:\cdots\ar[r]&0\ar[r]&\Omega_{X/Y}^0\otimes_{\mathscr{O}_X}\mathscr{D}_X\ar[r]&\cdots\ar[r]&\Omega_{X/Y}^n\otimes_{\mathscr{O}_X}\mathscr{D}_X\ar[r]&0\ar[r]&\cdots 
\end{tikzcd}
\end{equation}
by \cref{D-module differential module char by Hom of tensor}. Applying $\sHom_{\mathscr{D}_X}(-,\mathscr{D}_X)$ to this complex, we get\
\begin{equation}\label{D-module relative complex of D_X tensor Theta}
\begin{tikzcd}[column sep=6mm]
\mathscr{D}_X\otimes_{\mathscr{O}_X}\bigw^\bullet\Theta_{X/Y}:\cdots\ar[r]&\mathscr{D}_X\otimes_{\mathscr{O}_X}\bigw^n\Theta_{X/Y}\ar[r]&\cdots\ar[r]&\mathscr{D}_X\otimes_{\mathscr{O}_X}\bigw^1\Theta_{X/Y}\ar[r]&\cdots 
\end{tikzcd}
\end{equation}
where 
\[\Theta_{X/Y}=\sHom_{\mathscr{O}_X}(\Omega_{X/Y}^1,\mathscr{O}_X)=\ker(\Theta_X\to f^*(\Theta_Y)).\]

\begin{proposition}\label{D-module relative D-module resolution}
Let $f:X\to Y$ be a smooth morphism of relative dimension $n$ between smooth algebraic varieties. Then the following sequence is exact 
\begin{equation}\label{D-module relative D-module resolution-1}
\begin{tikzcd}[column sep=6mm]
0\ar[r]&\mathscr{D}_X\otimes_{\mathscr{O}_X}\bigw^n\Theta_{X/Y}\ar[r]&\cdots\ar[r]&\mathscr{D}_X\otimes_{\mathscr{O}_X}\bigw^0\Theta_{X/Y}\ar[r]&\mathscr{D}_{X\to Y}\ar[r]&0
\end{tikzcd}
\end{equation}
\end{proposition}
\begin{proof}
We define a good filtration of $\mathscr{D}_X\otimes_{\mathscr{O}_X}\bigw^k\Theta_{X/Y}$ by
\[F_i(\mathscr{D}_X\otimes_{\mathscr{O}_X}\bigw^k\Theta_{X/Y})=F_{i-k}(\mathscr{D}_X)\otimes_{\mathscr{O}_X}\bigw^k\Theta_{X/Y},\]
and equip $\mathscr{D}_{X\to Y}$ with the quotient filtration from $\mathscr{D}_X$. Then (\ref{D-module relative D-module resolution-1}) is a complex of filtered modules. Taking associated graded modules, we obtain a complex of $\gr(\mathscr{D}_X)$-modules
\begin{equation}\label{D-module relative D-module resolution-2}
\begin{tikzcd}[column sep=6mm]
0\ar[r]&\gr(\mathscr{D}_X\otimes_{\mathscr{O}_X}\bigw^n\Theta_{X/Y})\ar[r]&\cdots\ar[r]&\gr(\mathscr{D}_X\otimes_{\mathscr{O}_X}\bigw^0\Theta_{X/Y})\ar[r]&\gr(\mathscr{D}_{X\to Y})\ar[r]&0
\end{tikzcd}
\end{equation}
If we write locally $\Theta_{X/Y}=\bigoplus_{i=1}^{n}\mathscr{O}_Xv_i$, then (\ref{D-module relative D-module resolution-2}) is the Koszul complex with respect to $(v_1,\dots,v_n)$, which is exact since the codimension of the zero set of $\{v_1,\dots,v_n\}$ in $T^*X$ equals to $n$. We then conclude that (\ref{D-module relative D-module resolution-1}) is exact.
\end{proof}

\paragraph{The derived inverse images of \texorpdfstring{$D$}{D}-modules}
The language of derived categories is most suitable for the systematic study of inverse images of $D$-modules. Let $f:X\to Y$ be a morphism of smooth algebraic varieties, then the functor
\[f^*=\mathscr{O}_X\otimes_{f^{-1}(\mathscr{O}_Y)}f^{-1}(-):\Mod(\mathscr{D}_Y)\to\Mod(\mathscr{D}_X)\]
is a right exact functor, hence extends, via left derivation, to a triangulated functor
\[Lf^*:D^-(\mathscr{D}_Y)\to D^-(\mathscr{D}_X).\]
Since the flat dimension of $\mathscr{O}_Y$ is finite, this functor sends $D^b(\mathscr{D}_Y)$ to $D^b(\mathscr{D}_X)$, and hence induces a functor
\[Lf^*:D^b(\mathscr{D}_Y)\to D^b(\mathscr{D}_X).\]
For a bounded complex $\mathscr{N}$ of $\mathscr{D}_Y$-modules, by taking a bounded flat resolution $\mathscr{L}\to\mathscr{N}$, we can express $Lf^*(\mathscr{N})$ as $f^*(\mathscr{L})$.

\begin{proposition}\label{D-module inverse image of composition prop}
Let $f:X\to Y$ and $g:Y\to Z$ be morphisms of smooth algebraic varieties, then
\[Lf^*\circ Lg^*\cong L(g\circ f)^*.\]
\end{proposition}
\begin{proof}
We first note that
\begin{align*}
Lf^*(\mathscr{D}_{Y\to Z})&=\mathscr{O}_X\otimes_{f^{-1}(\mathscr{O}_Y)}^Lf^{-1}(\mathscr{D}_{Y\to Z})\\
&=\mathscr{O}_X\otimes_{f^{-1}(\mathscr{O}_Y)}^Lf^{-1}(\mathscr{O}_Y\otimes_{g^{-1}(\mathscr{O}_Z)}g^{-1}(\mathscr{D}_Z))\\
&=\mathscr{O}_X\otimes_{f^{-1}(\mathscr{O}_Y)}^Lf^{-1}(\mathscr{O}_Y)\otimes_{(g\circ f)^{-1}(\mathscr{O}_Z)}^L(g\circ f)^{-1}(\mathscr{D}_Z)\\
&=\mathscr{O}_X\otimes_{(g\circ f)^{-1}(\mathscr{O}_Z)}^L(g\circ f)^{-1}(\mathscr{D}_Z)=\mathscr{D}_{X\to Z}
\end{align*}
where we have used the fact that $\mathscr{D}_Z$ is a locally free $\mathscr{O}_Z$-module. We thus obtain isomorphisms
\[\mathscr{D}_{X\to Z}\cong\mathscr{D}_{X\to Y}\otimes_{f^{-1}(\mathscr{D}_Y)}^Lf^{-1}(\mathscr{D}_{Y\to Z})\cong \mathscr{D}_{X\to Y}\otimes_{f^{-1}(\mathscr{D}_Y)}^Lf^{-1}(\mathscr{D}_{Y\to Z})\]
and therefore
\begin{align*}
L(g\circ f)^*(\mathscr{M})&=\mathscr{D}_{X\to Z}\otimes_{(g\circ f)^{-1}(\mathscr{D}_Y)}^L(g\circ f)^{-1}(\mathscr{M})\\
&\cong (\mathscr{D}_{X\to Y}\otimes_{f^{-1}(\mathscr{D}_Y)}f^{-1}(\mathscr{D}_{Y\to Z}))\otimes_{f^{-1}(g^{-1}(\mathscr{D}_Y))}^Lf^{-1}(g^{-1}(\mathscr{M}))\\
&\cong \mathscr{D}_{X\to Y}\otimes_{f^{-1}(\mathscr{D}_Y)}^Lf^{-1}(\mathscr{D}_{Y\to Z}\otimes_{g^{-1}(\mathscr{D}_Y)}^Lg^{-1}(\mathscr{M}))\cong Lf^*(Lg^*(\mathscr{M})),
\end{align*}
whence our claim.
\end{proof}

\begin{proposition}\label{D-module inverse image of qcoh is qcoh}
Let $f:X\to Y$ be a morphism of smooth algebraic varieties, then $Lf^*$ sends $D_{\qcoh}^b(\mathscr{D}_Y)$ to $D_{\qcoh}^b(\mathscr{D}_X)$.
\end{proposition}
\begin{proof}
Let $\mathscr{M}\in D_{\qcoh}^b(\mathscr{D}_Y)$, then as a complex of $\mathscr{O}_X$-modules, we have
\begin{align*}
Lf^*(\mathscr{M})=\mathscr{O}_X\otimes_{f^{-1}(\mathscr{O}_Y)}^Lf^{-1}(\mathscr{M}).
\end{align*}
The assertion then follows from the corresponding result for the derived tensor product on the category $\Qcoh(\mathscr{O}_X)$.
\end{proof}

\begin{remark}\label{D-module inverse image fuctor not coherent eg}
We note that $Lf^*(\mathscr{D}_Y)=\mathscr{D}_{X\to Y}\otimes_{f^{-1}(\mathscr{D}_Y)}^Lf^{-1}(\mathscr{D}_Y)=\mathscr{D}_{X\to Y}$. If $f$ is a closed immersion with $\dim(X)<\dim(Y)$, then the $\mathscr{D}_X$-module $\mathscr{D}_{X\to Y}$ is locally of infinite rank (cf. \cref{D-module closed immersion relative inverse module}). Therefore, the functor $Lf^*$ does not necessarily send $D_{\coh}^b(\mathscr{D}_Y)$ to $D_{\coh}^b(\mathscr{D}_X)$.
\end{remark}

\begin{proposition}\label{D-module derived inverse image of smooth morphism prop}
Let $f:X\to Y$ be a smooth morphism between smooth algebraic varieties.
\begin{enumerate}
    \item[(a)] If $\mathscr{M}$ is a left $\mathscr{D}_Y$-module, then $L^if^*(\mathscr{M})=0$ for $i\neq 0$ (hence we can write $f^*$ instead of $Lf^*$).
    \item[(b)] If $\mathscr{M}$ is a coherent $\mathscr{D}_Y$-module, then $f^*(\mathscr{M})$ is a coherent $\mathscr{D}_X$-module.
\end{enumerate}
\end{proposition}
\begin{proof}
The first assertion follows from the flatness of $\mathscr{O}_X$ over $f^{-1}(\mathscr{O}_Y)$, since $f$ is flat. To see that $f^*(\mathscr{M})$ is a coherent $\mathscr{D}_X$-module if $\mathscr{M}$ is coherent, we use \cref{D-module coherent D_X-module iff qcoh and ft}, so let $\mathscr{D}_X^{\oplus m}\to\mathscr{M}$ be a surjective homomorphism. Then by applying $f^*$, we obtain a surjective homomorphism $\mathscr{D}_{X\to Y}^{\oplus m}\to f^*(\mathscr{M})$, and it suffices to note that there is a surjective homomorphism $\mathscr{D}\to\mathscr{D}_{X\to Y}$ given by $P\mapsto P1_{X\to Y}$ (cf. \cref{D-module smooth morphism relative D-module}).
\end{proof}

\begin{proposition}\label{D-module derived inverse image of closed immersion}
Let $i:X\to Y$ be a closed immersion and set $d=\codim_Y(X)$. Then for any $\mathscr{M}\in\Mod(\mathscr{D}_Y)$, we have $i^*(\mathscr{M})\in D^{[-d,0]}(\mathscr{D}_X)$.
\end{proposition}
\begin{proof}
Let $n=\dim(Y)$, then we have a locally free resolution 
\begin{equation}\label{D-module derived inverse image of closed immersion-1}
\begin{aligned}
\begin{tikzcd}
0\ar[r]&\mathscr{K}_{n-d}\ar[r]&\cdots\ar[r]&\mathscr{K}_1\ar[r]&0\ar[r]&\mathscr{K}_0\ar[r]&\mathscr{O}_X\ar[r]&0
\end{tikzcd}
\end{aligned}
\end{equation}
of the $i^{-1}(\mathscr{O}_Y)$-module $\mathscr{O}_X$ (Koszul resolution, see, eg. [Matm Theorem 43]). From this resolution, we then obtain a locally free resolution of the right $i^{-1}(\mathscr{D}_Y)$-module $\mathscr{D}_{X\to Y}$:
\[\begin{tikzcd}
0\ar[r]&\mathscr{K}_{n-d}\otimes_{i^{-1}(\mathscr{O}_Y)}\mathscr{D}_Y\ar[r]&\cdots\ar[r]&\mathscr{K}_0\otimes_{i^{-1}(\mathscr{O}_Y)}\mathscr{D}_Y\ar[r]&\mathscr{D}_{X\to Y}\ar[r]&0
\end{tikzcd}\]
Since $Li^*(\mathscr{M})=\mathscr{D}_{X\to Y}\otimes_{i^{-1}(\mathscr{D}_Y)}^Li^{-1}(\mathscr{M})$, it is then represented by the complex
\[\begin{tikzcd}
0\ar[r]&\mathscr{K}_{n-d}\otimes_{i^{-1}(\mathscr{O}_Y)}i^{-1}(\mathscr{M})\ar[r]&\cdots\ar[r]&\mathscr{K}_0\otimes_{i^{-1}(\mathscr{O}_Y)}i^{-1}(\mathscr{M})\ar[r]&0
\end{tikzcd}\]
This proves our assertion, since this complex is concentrated at degrees $[-d,0]$.
\end{proof}

\subsection{External tensor product}
Let $X$ and $Y$ be two smooth algebraic varieties and $\pr_1:X\times Y\to X$, $\pr_2:X\times Y\to Y$ be the canonical projections. For an $\mathscr{O}_X$-module $\mathscr{F}$ and an $\mathscr{O}_Y$-module $\mathscr{G}$, we can define an $\mathscr{O}_{X\times Y}$-module $\mathscr{F}\boxtimes\mathscr{G}$ by
\begin{align*}
\mathscr{F}\boxtimes\mathscr{G}&:=(\mathscr{O}_{X\times Y}\otimes_{\pr_1^{-1}(\mathscr{O}_X)}\mathscr{F})\otimes_{\pr_2^{-1}(\mathscr{O}_Y)}\pr_2^{-1}(\mathscr{G})\\
&=\mathscr{O}_{X\times Y}\otimes_{\pr_1^{-1}(\mathscr{O}_X)\otimes_\C \pr_2^{-1}(\mathscr{O}_Y)}(\pr_1^{-1}(\mathscr{F})\otimes_{\C}\pr_2^{-1}(\mathscr{G})).
\end{align*}
It is well known that this functor is exact with respect to $\mathscr{F}$ and $\mathscr{G}$, hence extends to a functor
\[(-)\boxtimes(-):D^b(\mathscr{O}_X)\times D^b(\mathscr{O}_Y)\to D^b(\mathscr{O}_{X\times Y}).\]
Furthermore, we have $\supp(\mathscr{F}\boxtimes\mathscr{G})=\supp(\mathscr{F})\times\supp(\mathscr{G})$.\par

We note that the external tensor product of $\mathscr{D}_X$ and $\mathscr{D}_Y$ is given by
\[\mathscr{D}_X\boxtimes\mathscr{D}_Y=\mathscr{O}_{X\times Y}\otimes_{\pr_1^{-1}(\mathscr{O}_X)\otimes_{\C}\pr_2^{-1}(\mathscr{O}_Y)}(\pr_1^{-1}(\mathscr{D}_X)\otimes_{\C}\pr_2^{-1}(\mathscr{D}_Y))\cong\mathscr{D}_{X\times Y},\]
so for a $\mathscr{D}_X$-module $\mathscr{M}$ and a $\mathscr{D}_Y$-module $\mathscr{N}$, we have
\begin{align*}
\mathscr{M}\boxtimes\mathscr{N}&=\mathscr{O}_{X\times Y}\otimes_{\pr_1^{-1}(\mathscr{O}_X)\otimes_{\C}\pr_2^{-1}(\mathscr{O}_Y)}(\pr_1^{-1}(\mathscr{M})\otimes_\C\pr_2^{-1}(\mathscr{N}))\\
&\cong \mathscr{D}_{X\times Y}\otimes_{\pr_1^{-1}(\mathscr{D}_X)\otimes_{\C}\pr_2^{-1}(\mathscr{D}_Y)}(\pr_1^{-1}(\mathscr{M})\otimes_\C\pr_2^{-1}(\mathscr{N})).
\end{align*}
This means the $\mathscr{O}_X$-module $\mathscr{M}\boxtimes\mathscr{N}$ is canoncially endowed with a left $\mathscr{D}_{X\times Y}$-module structure, so we obtain a bifunctor
\[(-)\boxtimes(-):D^b(\mathscr{D}_X)\times D^b(\mathscr{D}_Y)\to D^b(\mathscr{D}_{X\times Y})\]
for derived categories such that the following diagram is commutative:
\[\begin{tikzcd}[column sep=15mm]
D^b(\mathscr{D}_X)\otimes D^b(\mathscr{D}_Y)\ar[d]\ar[r,"(-)\boxtimes(-)"]&D^b(\mathscr{D}_{X\times Y})\ar[d]\\
D^b(\mathscr{O}_X)\otimes D^b(\mathscr{O}_Y)\ar[r,"(-)\boxtimes(-)"]&D^b(\mathscr{O}_{X\times Y})
\end{tikzcd}\]
It is easily seen that the functor $(-)\boxtimes(-)$ sends $D^b_{\qcoh}(\mathscr{D}_X)\times D^b_{\qcoh}(\mathscr{D}_Y)$ (resp $D^b_{\coh}(\mathscr{D}_X)\times D^b_{\coh}(\mathscr{D}_Y)$) to $D^b_{\qcoh}(\mathscr{D}_{X\times Y})$ (resp. $D^b_{\coh}(\mathscr{D}_{X\times Y})$), and we have
\[\pr_1^*(\mathscr{M})\cong\mathscr{M}\boxtimes\mathscr{O}_Y,\quad \pr_2^*(\mathscr{N})\cong \mathscr{O}_X\boxtimes\mathscr{N}.\]

Let $X$ be a smooth algebraic variety and $\Delta_X:X\to X\times X$ be the diagonal morphism. For $\mathscr{M},\mathscr{N}\in\Mod(\mathscr{D}_X)$, we easily seen that $\mathscr{M}\otimes_{\mathscr{O}_X}\mathscr{N}$ is isomorphic to $\Delta_X^*(\mathscr{M}\boxtimes\mathscr{N})$ as a $\mathscr{D}_X$-module. Moreover, the external tensor products of flat modules are flat, so for $\mathscr{M},\mathscr{N}\in D^b(\mathscr{D}_X)$ we have a canonical isomorphism
\[\mathscr{M}\otimes_{\mathscr{O}_X}^L\mathscr{N}\cong L\Delta_X^*(\mathscr{M}\boxtimes\mathscr{N}).\]

\begin{proposition}\label{D-module inverse image and tensor prop}
Let $f:X\to Y$ and $f':X'\to Y'$ be morphisms of smooth algebraic varieties. Then for $\mathscr{M},\mathscr{N}\in D^b(\mathscr{D}_Y)$ and $\mathscr{M}'\in D^b(\mathscr{D}_{Y'})$, we have
\begin{gather*}
L(f\times f')^*(\mathscr{M}\boxtimes\mathscr{M}')\cong Lf^*(\mathscr{M})\boxtimes Lf'^*(\mathscr{M}'),\label{D-module inverse image and tensor prop-1}\\
Lf^*(\mathscr{M}\otimes_{\mathscr{O}_Y}\mathscr{N})\cong Lf^*(\mathscr{M})\otimes_{\mathscr{O}_X}^LLf^*(\mathscr{N}).\label{D-module inverse image and tensor prop-2}
\end{gather*}
\end{proposition}
\begin{proof}
The first statement follows from $(f\times f')^*(\mathscr{M}\boxtimes\mathscr{N}')\cong f^*(\mathscr{M})\boxtimes f'^*(\mathscr{M}')$ for $\mathscr{M}\in\Mod(\mathscr{D}_Y)$, $\mathscr{M}'\in\Mod(\mathscr{D}_Y)$. The second one then follows as follows:
\begin{equation*}
\begin{aligned}
Lf^*(\mathscr{M}\otimes_{\mathscr{O}_Y}\mathscr{N})&\cong Lf^*L\Delta_Y^*(\mathscr{M}\boxtimes\mathscr{N})\cong L\Delta_X^*L(f\times f)^*(\mathscr{M}\boxtimes\mathscr{N})\\
&\cong L\Delta_X^*(Lf^*(\mathscr{M})\boxtimes Lf^*(\mathscr{N}))\cong Lf^*(\mathscr{M})\otimes_{\mathscr{O}_X}^LLf^*(\mathscr{N}).
\end{aligned}
\end{equation*}
where we have used the equality $(f,f)\circ\Delta_X=\Delta_Y\circ f$.
\end{proof}

\begin{proposition}\label{D-module derived tensor and base change}
Let $\mathscr{M},\mathscr{N}\in D^b(\mathscr{D}_X)$ and $\mathscr{L}\in D^b(\mathscr{D}_X^{\op})$. Then we have canonical isomorphisms of $\C_X$-modules
\[(\mathscr{L}\otimes_{\mathscr{O}_X}^L\mathscr{N})\otimes_{\mathscr{D}_X}^L\mathscr{M}\cong\mathscr{L}\otimes_{\mathscr{D}_X}^L(\mathscr{M}\otimes_{\mathscr{O}_X}^L\mathscr{N})\]
\end{proposition}
\begin{proof}
By taking flat resolutions, we may assume that $\mathscr{M},\mathscr{N}\in\Mod(\mathscr{D}_X)$ and $\mathscr{L}\in\Mod(\mathscr{D}_X^{\op})$. The assertion then follows from \cref{D-module tensor with Kronecker tensor isomorphism}.
\end{proof}

\begin{proposition}\label{D-module characteristic variety of external tensor char}
For a coherent $\mathscr{D}_X$-module $\mathscr{M}$ and a coherent $\mathscr{D}_Y$-module $\mathscr{N}$, we have
\[\Ch(\mathscr{M}\boxtimes\mathscr{N})=\Ch(\mathscr{M})\times\Ch(\mathscr{N}).\]
\end{proposition}
\begin{proof}
Let $F(\mathscr{M})$ and $F(\mathscr{N})$ be good filtrations of $\mathscr{M}$ and $\mathscr{N}$, respectively. We define a good filtration of $\mathscr{M}\boxtimes\mathscr{N}$ by
\[F_k(\mathscr{M}\boxtimes\mathscr{N})=\sum_{i+j=k}F_i(\mathscr{M})\boxtimes F_j(\mathscr{N}).\]
Then we have $\gr(\mathscr{M}\boxtimes\mathscr{N})=\gr(\mathscr{M})\boxtimes\gr(\mathscr{N})$, hence
\[\widetilde{\gr(\mathscr{M}\boxtimes\mathscr{N})}=\widetilde{\gr(\mathscr{M})}\boxtimes\widetilde{\gr(\mathscr{N})}.\]
This proves the assertion, as we have remarked.
\end{proof}

\subsection{Direct image of \texorpdfstring{$D$}{D}-modules}
\paragraph{The transfer module \texorpdfstring{$\mathscr{D}_{Y\leftarrow X}$}{D}}
Suppose that $v(y)=\int u(x,y)dx$ makes sense for a function $u(x,y)$, let us consider how to derive differential equations for $v(y)$ from those for $u(x,y)$. Supposing, in addtion, that Stokes's theorem $\int\frac{\partial u(x,y)}{\partial x_i}dx=0$ holds, we obtain
\[\int\frac{\partial}{\partial x_i}S(x,y,\partial_x,\partial_y)u(x,y)=0\]
for all differential operators $S(x,y,\partial_x,\partial_y)$, so for
\[Q(y,\partial_y)=\sum_i\partial_{x_i}S_i(x,y,\partial_x,\partial_y)+P(x,y,\partial_x,\partial_y),\]
we have
\[Q(y,\partial_y)v(y)=\int P(x,y,\partial_x,\partial_y)u(x,y)dx.\]
Furthermore, if $P(x,y,\partial_x,\partial_y)u=0$, then $Q(y,\partial_y)v(y)=0$.\par
We now describe the above consideration in the languate of $D$-modules. Let $X$ be a smooth algebraic variety with a coordinate system $(x,y)$ and $Y$ be a submanifold with a coordinate system $y$. Then the above consideration means that we can associate a $\mathscr{D}_X$-module $\mathscr{M}$ with a $\mathscr{D}_Y$-module
\[\mathscr{M}/(\sum_i\partial_{x_i}\mathscr{M})=(\mathscr{D}_X/\sum_i\partial_{x_i}\mathscr{D}_X)\otimes_{\mathscr{D}_X}\mathscr{M}.\]
This can be generalized to an arbitrary morphism, which is the subject of this paragraph.\par

Let $f:X\to Y$ be a morphisms of smooth algebraic varieties. The right $\mathscr{D}_Y$-module structure of $\mathscr{D}_Y$ gives via side-changing a left $\mathscr{D}_Y$-module structure on $\mathscr{D}_Y\otimes_{\mathscr{O}_Y}\Omega_Y^{\otimes-1}$, whose inverse image by $f$ is the left $\mathscr{D}_X$-module
\[f^{-1}(\mathscr{D}_Y\otimes_{\mathscr{O}_Y}\Omega_Y^{\otimes-1})=f^{-1}(\mathscr{D}_Y\otimes_{\mathscr{O}_Y}\Omega_Y^{\otimes-1})\otimes_{f^{-1}(\mathscr{O}_Y)}\mathscr{O}_X.\]
By side-changing again, we then obtain a right $\mathscr{D}_X$-module
\begin{align*}
f^{-1}(\mathscr{D}_Y\otimes_{\mathscr{O}_Y}\Omega_Y^{\otimes-1})\otimes_{f^{-1}(\mathscr{O}_Y)}\Omega_X&=f^{-1}(\mathscr{D}_Y)\otimes_{f^{-1}(\mathscr{O}_Y)}f^{-1}(\Omega_Y^{\otimes-1})\otimes_{f^{-1}(\mathscr{O}_Y)}\Omega_X\\
&\cong f^{-1}(\mathscr{D}_Y)\otimes_{f^{-1}(\mathscr{O}_Y)}\Omega_{X/Y}
\end{align*}
where we write $\Omega_{X/Y}=\Omega_X\otimes_{f^{-1}(\mathscr{O}_Y)}f^{-1}(\Omega_Y^{\otimes-1})$. Since the right and left action of $\mathscr{D}_Y$ commute, we see that $f^{-1}(\mathscr{D}_Y)\otimes_{f^{-1}(\mathscr{O}_Y)}\Omega_{X/Y}$ is an $(f^{-1}(\mathscr{D}_Y),\mathscr{D}_X)$-bimodule, which is denoted by $\mathscr{D}_{Y\leftarrow X}$.\par

Recall that we have defined a $(\mathscr{D}_X,f^{-1}(\mathscr{D}_Y))$-bimodule $\mathscr{D}_{X\to Y}=\mathscr{O}_X\otimes_{f^{-1}(\mathscr{O}_Y)}f^{-1}(\mathscr{D}_Y)$. Since the category of left $\mathscr{D}$-modules and that of right $\mathscr{D}_X$-modules are equivalent, we can switch $\mathscr{D}_{X\to Y}$ to a $(f^{-1}(\mathscr{D}_Y),\mathscr{D}_X)$-bimodule, which is explicitly given by
\begin{equation}\label{D-module direct and inverse relative module isomorphism}
\begin{aligned}
\Omega_X\otimes_{\mathscr{O}_X}\mathscr{D}_{X\to Y}\otimes_{f^{-1}(\mathscr{O}_Y)}f^{-1}(\Omega_Y^{\otimes-1})&=\Omega_X\otimes_{f^{-1}(\mathscr{O}_Y)}f^{-1}(\mathscr{D}_Y)\otimes_{f^{-1}(\mathscr{O}_Y)}f^{-1}(\Omega_Y^{\otimes-1})\\
&\cong f^{-1}(\mathscr{D}_Y)\otimes_{f^{-1}(\mathscr{O}_Y)}\Omega_{X/Y}\cong\mathscr{D}_{X\leftarrow Y}.
\end{aligned}
\end{equation}
In other words, the bimodule $\mathscr{D}_{Y\leftarrow X}$ is obtained by side-changing from $\mathscr{D}_{X\to Y}$.\par 

Let us explicitly describe the action of $\mathscr{D}_X$ on $\mathscr{D}_{Y\leftarrow X}$. The action of $\mathscr{O}_X\sub\mathscr{D}_X$ is obtained from the $\mathscr{O}_X$-module structure of $\Omega_{X/Y}$, and the action of $\Theta_X\sub\mathscr{D}_X$ is given as follows. Let $\tilde{v}=\sum a_i\otimes w_i$ be the image of $v\in\Theta_X$ under the canonical homomorphism $\Theta_X\to f^*(\Theta_Y)=\mathscr{O}_X\otimes_{f^{-1}(\mathscr{O}_Y)}f^{-1}(\Theta_X)$. Then for $\omega\in\Omega_X$, a generator $\theta$ of $\Omega_Y$, and $P\in\mathscr{D}_Y$, we have
\begin{equation}\label{D-module direct image relative module action def-1}
(P\otimes(\omega/\theta))v=\sum_iPw_i\otimes a_i\omega/\theta-P\otimes\mathfrak{Lie}_v(\omega)/\theta+\sum_iP\otimes a_i(\mathfrak{Lie}_{w_i}(\theta)/\theta)\omega/\theta.
\end{equation}
Taking a coordinate system $\{x_i,\partial_{x_i}\}$ of $X$ and a coordinate system $\{y_j,\partial_{y_j}\}$ of $Y$, we then have
\begin{equation}\label{D-module direct image relative module action def-2}
(P\otimes a(x)\,dx/dy)\partial_{x_i}=\sum_jP\partial_{y_j}\otimes\frac{\partial f_j(x)}{\partial x_i}a(x)\,dx/dy-P\otimes\frac{\partial a(x)}{\partial x_i}dx/dy
\end{equation}
where $dx=dx_1\wedge\cdots\wedge dx_n$ and $dy=dy_1\wedge\cdots dy_m$.

\begin{example}\label{D-module closed immersion relative direct module local char}
Let $i:X\to Y$ be a closed immersion of smooth algebraic varieties. As in the situation of \cref{D-module closed immersion relative inverse module}, we take a local coordinate $y=(y_1,\dots,y_n)$ and let $x_i=y_i\circ i$ for $i=1,\dots,r$. Then we have 
\[\mathscr{D}_{Y\leftarrow X}=i^{-1}(\mathscr{D}_Y)\otimes_{i^{-1}(\mathscr{O}_Y)}i^{-1}(\Omega_Y^{\otimes-1})\otimes_{i^{-1}(\mathscr{O}_Y)}\Omega_X.\]
We can locally identify $i^{-1}(\Omega_Y^{\otimes-1})\otimes_{i^{-1}(\mathscr{O}_Y)}\Omega_X$ with $\mathscr{O}_X$ via the section $dx/dy$, so if we set
\[\mathscr{D}=\bigoplus_{\alpha_1,\dots,\alpha_n}\mathscr{O}_Y\partial_{y_1}^{\alpha_1}\cdots\partial_{y_n}^{\alpha_n}\sub\mathscr{D}_Y,\]
then $\mathscr{D}_Y\cong\C[\partial_{y_{r+1}},\dots,\partial_{y_n}]\otimes_{\C}\mathscr{D}$ as a right $\mathscr{D}$-module and we have
\begin{equation}\label{D-module closed immersion relative direct module local char-1}
\mathscr{D}_{Y\leftarrow X}\cong \C[\partial_{y_{n+1}},\dots,\partial_{y_n}]\otimes_{\C}i^{-1}(\mathscr{D})\otimes_{i^{-1}(\mathscr{O}_Y)}\mathscr{O}_X.
\end{equation}
From (\ref{D-module direct image relative module action def-2}), we see that the right $\mathscr{D}_X$-action of the right-hand side of (\ref{D-module closed immersion relative direct module local char-1}) is induced by the right $\mathscr{D}_X$-action on $i^{-1}(\mathscr{D})\otimes_{i^{-1}(\mathscr{O}_Y)}\mathscr{O}_Y$ given by
\[(P\otimes 1)\partial_{x_i}=(P\partial_{y_i})\otimes 1,\quad (P\otimes 1)a=P\otimes a,\]
where $P\in\mathscr{D}$ and $a\in\mathscr{O}_X$. We therefore conclude that $i^{-1}(\mathscr{D})\otimes_{i^{-1}(\mathscr{O}_Y)}\mathscr{O}_X\cong\mathscr{D}_X$, so we obtain a local isomorphism
\[\mathscr{D}_{Y\leftarrow X}\cong\C[\partial_{y_{r+1}},\dots,\partial_{y_n}]\otimes_{\C}\mathscr{D}_X.\]
In particular, $\mathscr{D}_{X\to Y}$ and $\mathscr{D}_{Y\leftarrow X}$ are isomorphic as $\mathscr{O}_X$-modules.
\end{example}

\begin{proposition}\label{D-module smooth morphism relative direct module prop}
Let $f:X\to Y$ be a smooth morphism of relative dimension $n$. Then 
\begin{enumerate}
    \item[(a)] The right $\mathscr{D}_X$-module $\mathscr{D}_{Y\leftarrow X}$ is coherent.
    \item[(b)] We have an exact sequence
    \[\begin{tikzcd}
    0\ar[r]&\Omega_{X/Y}^0\otimes_{\mathscr{O}_X}\mathscr{D}_X\ar[r]&\cdots\ar[r]&\Omega_{X/Y}^d\otimes_{\mathscr{O}_X}\mathscr{D}_X\ar[r]&\mathscr{D}_{Y\leftarrow X}\ar[r]&0
    \end{tikzcd}\]
    \item[(c)] We have canonical isomorphisms
    \begin{gather*}
    R\!\sHom_{\mathscr{D}_X}(\mathscr{D}_{X\to Y},\mathscr{D}_X)\cong \mathscr{D}_{Y\leftarrow X}[-n]\in D^b(f^{-1}(\mathscr{D}_Y)\otimes\mathscr{D}_X^{\op}),\\
    R\!\sHom_{\mathscr{D}_X}(\mathscr{D}_{Y\leftarrow X},\mathscr{D}_X)\cong \mathscr{D}_{X\to Y}[-n]\in D^b(\mathscr{D}_X\otimes f^{-1}(\mathscr{D}_Y)).
    \end{gather*}
\end{enumerate}
\end{proposition}
\begin{proof}
The first assertion follows from \cref{D-module derived inverse image of smooth morphism prop} and the isomorphism (\ref{D-module direct and inverse relative module isomorphism}), and the second assertion is proved just like \cref{D-module relative D-module resolution}, by replacing $\Theta_{X/Y}$ with $\Omega_{X/Y}$. Now since $\Omega_{X/Y}$ is locally free, we see from (b) that $R\!\sHom_{\mathscr{D}_X}(\mathscr{D}_{X\to Y},\mathscr{D}_X)$ is quasi-isomorphic to the complex
\[\begin{tikzcd}
0\ar[r]&\mathscr{D}_X\otimes_{\mathscr{O}_X}\Theta_{X/Y}^n\ar[r]&\cdots\ar[r]&\mathscr{D}_X\otimes_{\mathscr{O}_X}\Theta_{X/Y}^n\ar[r]&0
\end{tikzcd}\]
which is quasi-isomorphic to $\mathscr{D}_{X\to Y}[-n]$ by \cref{D-module relative D-module resolution}. The second statement of (c) can be proved similarly.
\end{proof}

\paragraph{The case for a closed immersion \texorpdfstring{$i:X\to Y$}{i}}
\begin{proposition}\label{D-module closed immersion direct image relative module dual prop}
Let $i:X\to Y$ be a closed immersion and $d=\codim_Y(X)$. Then
\begin{enumerate}
    \item[(a)] $\mathscr{D}_{Y\leftarrow X}$ and $\mathscr{D}_{X\to Y}$ are coherent over $i^{-1}(\mathscr{D}_Y)$.
    \item[(b)] For any $\mathscr{M}\in D^+(\mathscr{D}_Y)$, we have a canonical isomorphism
    \begin{gather*}
    R\!\sHom_{i^{-1}(\mathscr{D}_Y)}(\mathscr{D}_{Y\leftarrow X},i^{-1}(\mathscr{M}))\cong Li^*(\mathscr{M})[-d]\in D^b(\mathscr{D}_X).
    \end{gather*}
\end{enumerate}
\end{proposition}
\begin{proof}
The first assertion is clear from the general property of $i^{-1}$. To see (b), it suffices to show the isomorphism
\begin{equation}\label{D-module closed immersion direct image relative module dual prop-1}
R\!\sHom_{i^{-1}(\mathscr{D}_Y)}(\mathscr{D}_{Y\leftarrow X},i^{-1}(\mathscr{D}_Y))\cong\mathscr{D}_{X\to Y}[-d].
\end{equation}
Indeed, from (\ref{D-module closed immersion direct image relative module dual prop-1}) we conclude that
\begin{align*}
Li^*(\mathscr{M})&=\mathscr{D}_{X\to Y}\otimes_{i^{-1}(\mathscr{D}_Y)}^Li^{-1}(\mathscr{M})\cong R\!\sHom_{i^{-1}(\mathscr{D}_Y)}(\mathscr{D}_{Y\leftarrow X})\otimes_{i^{-1}(\mathscr{D}_Y)}^Li^{-1}(\mathscr{M})[d]\\
&\cong R\!\sHom_{i^{-1}(\mathscr{D}_Y)}(\mathscr{D}_{Y\leftarrow X},i^{-1}(\mathscr{M}))[d].
\end{align*}
We also note that (\ref{D-module closed immersion direct image relative module dual prop-1}) is equivalent to
\begin{equation}\label{D-module closed immersion direct image relative module dual prop-2}
R\!\sHom_{i^{-1}(\mathscr{D}_Y^{\op})}(\mathscr{D}_{X\to Y},i^{-1}(\mathscr{D}_Y))\cong\mathscr{D}_{Y\leftarrow X}[-d]
\end{equation}
by side changing operation. To this end, we have
\begin{align*}
R\!\sHom_{i^{-1}(\mathscr{D}_Y^{\op})}(\mathscr{D}_{X\to Y},i^{-1}(\mathscr{D}_Y))&\cong R\!\sHom_{i^{-1}(\mathscr{D}_Y^{\op})}(\mathscr{O}_X\otimes_{i^{-1}(\mathscr{O}_Y)}i^{-1}(\mathscr{D}_Y),i^{-1}(\mathscr{D}_Y))\\
&\cong R\!\sHom_{i^{-1}(\mathscr{O}_Y)}(\mathscr{O}_X,i^{-1}(\mathscr{D}_Y))\\
&\cong i^{-1}(\mathscr{D}_Y)\otimes_{i^{-1}(\mathscr{O}_Y)}R\!\sHom_{i^{-1}(\mathscr{O}_Y)}(\mathscr{O}_X,i^{-1}(\mathscr{O}_Y)).
\end{align*}
By using the Koszul resolution (\ref{D-module derived inverse image of closed immersion-1}), we see that $R\!\sHom_{i^{-1}(\mathscr{O}_Y)}(\mathscr{O}_X,i^{-1}(\mathscr{O}_Y))$ is represented by the complex $\check{\mathscr{K}}_0\to\cdots\to\check{\mathscr{K}}_d$, where $\check{\mathscr{K}}_j=\sHom_{i^{-1}(\mathscr{O}_Y)}(\mathscr{K}_j,i^{-1}(\mathscr{O}_Y))$. note that $\mathscr{K}_d$ is a locally free $i^{-1}(\mathscr{O}_Y)$-module of rank one and we have a canonical prefect pairing $\mathscr{K}_j\otimes_{i^{-1}(\mathscr{O}_Y)}\mathscr{K}_{d-j}\to\mathscr{K}_d$ for each $j$. We then conclude that $\check{\mathscr{K}}_j\cong\mathscr{K}_{d-j}\otimes_{i^{-1}(\mathscr{O}_Y)}\check{\mathscr{K}}_d$, so
\begin{align*}
R\!\sHom_{i^{-1}(\mathscr{O}_Y)}(\mathscr{O}_X,i^{-1}(\mathscr{O}_Y))&\cong [\mathscr{K}_d\to\cdots\to \mathscr{K}_0]\otimes_{i^{-1}(\mathscr{O}_Y)}\check{\mathscr{K}}_d\\
&=\mathscr{O}_X\otimes_{i^{-1}(\mathscr{O}_Y)}\check{\mathscr{K}}_d[-d]\cong i^{-1}(\Omega_Y^{\otimes-1})\otimes_{i^{-1}(\mathscr{O}_Y)}\Omega_X[-d].
\end{align*}
Therefore, we have
\begin{align*}
R\!\sHom_{i^{-1}(\mathscr{O}_Y)}(\mathscr{O}_X,i^{-1}(\mathscr{O}_Y))&\cong i^{-1}(\mathscr{D}_Y)\otimes_{i^{-1}(\mathscr{O}_Y)}i^{-1}(\Omega_Y^{\otimes-1})\otimes_{i^{-1}(\mathscr{O}_Y)}\Omega_X[-d]\cong \mathscr{D}_{Y\leftarrow X}[-d]
\end{align*}
in view of the definition of $\mathscr{D}_{Y\leftarrow X}$.
\end{proof}

Inspired by \cref{D-module closed immersion direct image relative module dual prop}, for a closed immersion $i:X\to Y$ of smooth algebraic varieties we define a left exact functor
\[i^!:\Mod(\mathscr{D}_Y)\to\Mod(\mathscr{D}_X),\quad \mathscr{M}\mapsto \sHom_{i^{-1}(\mathscr{D}_Y)}(\mathscr{D}_{Y\leftarrow X},i^{-1}(\mathscr{M})).\]
It turns out that this is the "right" definition of the extrodinary inverse image functor for $D$-modules. On the other hand, we also note that following result.
\begin{proposition}\label{D-module upper shriek for closed immersion char}
Let $i:X\to Y$ be a closed immersion with $d=\codim_Y(X)$. Then for $\mathscr{M}\in D^+(\mathscr{D}_Y)$ we have
\[Ri^!(\mathscr{M})\cong R\!\sHom_{i^{-1}(\mathscr{D}_Y)}(\mathscr{D}_{Y\leftarrow X},i^{-1}(\mathscr{M}))\cong Li^*(\mathscr{M})[d].\]
\end{proposition}
\begin{proof}
The second isomorphism is proved in \cref{D-module closed immersion direct image relative module dual prop}. To see the first one, we first show that
\begin{equation}\label{D-module upper shriek for closed immersion char-1}
i^!(\mathscr{M})\cong\sHom_{i^{-1}(\mathscr{D}_Y)}(\mathscr{D}_{Y\leftarrow X},i^{-1}(\Gamma_X(\mathscr{M}))),\quad \mathscr{M}\in\Mod(\mathscr{D}_Y)
\end{equation}
where $\Gamma_X(\mathscr{M})$ denotes the subsheaf of $\mathscr{M}$ consisting of sections supported in $X$. To this end, it suffices to show that $\psi(s)\in i^{-1}(\Gamma_X(\mathscr{M}))$ for any $\psi\in\sHom_{i{^-1}(\mathscr{D}_Y)}(\mathscr{D}_{Y\leftarrow X},i^{-1}(\mathscr{M}))$ and $s\in\mathscr{D}_{Y\leftarrow X}$. Since this question is local, we may take a local coordinate as in \cref{D-module closed immersion relative inverse module}. Then we have
\[\mathscr{D}_{Y\leftarrow X}\cong\C[\partial_{y_{r+1}},\dots,\partial_{y_n}]\otimes_\C\mathscr{D}_X.\]
Since the $i^{-1}(\mathscr{D}_Y)$-module $\C[\partial_{y_{r+1}},\dots,\partial_{y_n}]\otimes_\C\mathscr{D}_X$ is generated by $1\otimes 1$, we may assume that $s=1\otimes 1$. Let $\mathscr{J}\sub\mathscr{O}_Y$ be the defining ideal of $X$. By $i^{-1}(\mathscr{J})s=0$, we have $i^{-1}(\mathscr{J})\psi(s)=0$, so $\psi(s)\in i^{-1}(\Gamma_X(\mathscr{M}))$ and we get (\ref{D-module upper shriek for closed immersion char-1}).\par
We next show that
\begin{equation}
Ri^!(\mathscr{M})=R\!\sHom_{i^{-1}(\mathscr{D}_Y)}(\mathscr{D}_{Y\leftarrow X},i^{-1}R\Gamma_X(\mathscr{M})),\quad \mathscr{M}\in D^+(\mathscr{D}_Y).
\end{equation}
For this, it is sufficient to show that if $\mathscr{I}$ is an injective $\mathscr{D}_Y$-module, then $i^{-1}(\Gamma_X(\mathscr{I}))$ is an injective $i^{-1}(\mathscr{D}_Y)$-module. But this follows from
\begin{align*}
\Hom_{i^{-1}(\mathscr{D}_Y)}(\mathscr{K},i^{-1}(\Gamma_X(\mathscr{I})))&\cong \Hom_{i^{-1}(\mathscr{D}_Y)}(i^{-1}i_*(\mathscr{K}),i^{-1}\Gamma_X(\mathscr{I}))\\
&\cong \Hom_{\mathscr{D}_Y}(i_*(\mathscr{K}),i_*i^{-1}\Gamma_X(\mathscr{I}))\\
&\cong \Hom_{\mathscr{D}_Y}(i_*(\mathscr{K}),\Gamma_X(\mathscr{I}))\cong\Hom_{\mathscr{D}_Y}(i_*(\mathscr{K}),\mathscr{I})
\end{align*}
for any $i^{-1}(\mathscr{D}_Y)$-module $\mathscr{K}$.\par
It remains to show that the canonical morphism
\[R\!\sHom_{i^{-1}(\mathscr{D}_Y)}(\mathscr{D}_{Y\leftarrow X},i^{-1}R\Gamma_X(\mathscr{M}))\to R\!\sHom_{i^{-1}(\mathscr{D}_Y)}(i^{-1}(\mathscr{D}_{Y\leftarrow X}),i^{-1}(\mathscr{M}))\]
is an isomorphism. Let $j:Y\setminus X\to Y$ be the complementary open immersion. By the distinguished triangle
\[\begin{tikzcd}
R\Gamma_X(\mathscr{M})\ar[r]&\mathscr{M}\ar[r]&Rj_*j^{-1}(\mathscr{M})\ar[r,"+1"]&{}
\end{tikzcd}\]
it then suffices to show that $R\!\sHom_{i^{-1}(\mathscr{D}_Y)}(\mathscr{D}_{Y\leftarrow X},i^{-1}Rj_*j^{-1}(\mathscr{M}))=0$, which is equivalent the the assertion
\[R\!\sHom_{i^{-1}(\mathscr{D}_Y)}(\mathscr{D}_{X\to Y},i^{-1}Rj_*j^{-1}(\mathscr{M}))=0 \for \mathscr{M}\in D^+(\mathscr{D}_Y^{\op})\]
by side-changing. On the other hand, note that
\begin{align*}
R\!\sHom_{i^{-1}(\mathscr{D}_Y^{\op})}(\mathscr{D}_{X\to Y},i^{-1}Rj_*j^{-1}(\mathscr{M}))&=R\!\sHom_{i^{-1}(\mathscr{D}_Y^{\op})}(\mathscr{O}_X\otimes_{i^{-1}(\mathscr{O}_Y)}i^{-1}(\mathscr{D}_Y),i^{-1}Rj_*j^{-1}(\mathscr{M}))\\
&\cong R\!\sHom_{i^{-1}(\mathscr{O}_Y)}(\mathscr{O}_X,i^{-1}R_j*j^{-1}(\mathscr{M}))\\
&\cong \mathscr{O}_X\otimes_{i^{-1}(\mathscr{O}_Y)}^Li^{-1}Rj_*j^{-1}(\mathscr{M}),
\end{align*}
so the claim follows from \cref{scheme closed and open complement i^*Rj_* zero prop}.
\end{proof}

\begin{lemma}\label{scheme closed and open complement i^*Rj_* zero prop}
Let $i:X\to Y$ be a closed immersion of algebraic varieties. Set $U=Y\setminus X$ and denote by $j:U\to X$ the complementary open immersion. Then for any $\mathscr{K}\in D^b(\mathscr{O}_U)$, we have $\mathscr{O}_X\otimes_{i^{-1}(\mathscr{O}_Y)}^Li^{-1}Rj_*(\mathscr{K})=0$.
\end{lemma}
\begin{proof}
For any $\mathscr{K}\in D^b(\mathscr{O}_U)$, we have
\begin{align*}
i_*(\mathscr{O}_X\otimes_{i^{-1}(\mathscr{O}_Y)}^Li^{-1}Rj_*(\mathscr{K}))=i_*(\mathscr{O}_X)\otimes_{\mathscr{O}_Y}^LRj_*(\mathscr{K})=Rj_*(j^{-1}i_*(\mathscr{O}_X)\otimes_{\mathscr{O}_{U}}^L\mathscr{K})=0,
\end{align*}
where we have used the projection formula and the fact that $j^{-1}i_*=0$. Since $i_*$ is fully faithful, this completes the proof.
\end{proof}

\begin{remark}
In view of \cref{D-module upper shriek for closed immersion char}, it is therefore quite convenient to use the shifted functor $Lf^*[d_{Y/X}]$ which in the case of closed immersions coincides with $Ri^!$, we thus define
\[f^!=Lf^*[d_{Y/X}]:D^b(\mathscr{D}_X)\to D^b(\mathscr{D}_Y)\]
for an arbitrary morphism $f:X\to Y$. As we have remarked, this definition turns out to give the "right" extrodinary inverse image functor for $D$-modules.
\end{remark}

\paragraph{The derived direct image of \texorpdfstring{$D$}{D}-modules}
Let $f:X\to Y$ be a morphism of smooth algebraic varieties and $\mathscr{M}$ be a $\mathscr{D}_X$-module. If we define its integral (or direct image) to be the $\mathscr{D}_Y$-module $f_*(\mathscr{D}_{Y\leftarrow X}\otimes_{\mathscr{D}_X}\mathscr{M})$, it would equal to
\[f_*(\coker(\Omega_{X/Y}^{d_{X/Y}-1})\otimes_{\mathscr{O}_X}\mathscr{M}\to\Omega_{X/Y}^{d_{X/Y}-1}\otimes_{\mathscr{O}_X}\mathscr{M})\]
for $f$ smooth. However, this operation is better behaved if we consider the setting of derived categories. By taking a flat resolution of $\mathscr{M}$ and an injective resolution of $\mathscr{N}$, we therefore define a functor
\[f_+:D^b(\mathscr{D}_X)\to D^b(\mathscr{D}_Y),\quad \mathscr{M}\mapsto Rf_*(\mathscr{D}_{Y\leftarrow X}\otimes_{\mathscr{D_X}}^L\mathscr{M})\]
called the \textbf{integral of $\mathscr{M}$ along fibers of $\bm{f}$}. Note that we also have a functor $f_+:D^b(\mathscr{D}_X^{\op})\to D^b(\mathscr{D}_Y^{\op})$ given by
\[f_+(\mathscr{M})=Rf_*(\mathscr{M}\otimes_{\mathscr{D}_X}^L\mathscr{D}_{X\to Y}),\quad \mathscr{M}\in D^b(\mathscr{D}_X^{\op}).\]
In view of (\ref{D-module direct and inverse relative module isomorphism}), it is not hard to see that we have a commutative diagram
\[\begin{tikzcd}
D^b(\mathscr{D}_X)\ar[r,"f_+"]\ar[d,swap,"\Omega_X\otimes_{\mathscr{O}_X}(-)"]&D^b(\mathscr{D}_Y)\ar[d,"\Omega_Y\otimes_{\mathscr{O}_Y}(-)"]\\
D^b(\mathscr{D}_X^{\op})\ar[r]&D^b(\mathscr{D}_Y^{\op})
\end{tikzcd}\]

\begin{proposition}\label{D-module direct image composition prop}
Let $f:X\to Y$ and $g:Y\to Z$ be morphisms of smooth algebraic varieties. Then we have $(g\circ f)_+=g_+\circ f_+$.
\end{proposition}
\begin{proof}
Similar to the proof of \cref{D-module inverse image of composition prop}, we have isomorphisms
\[\mathscr{D}_{Z\leftarrow X}\cong f^{-1}(\mathscr{D}_{Z\leftarrow Y})\otimes_{f^{-1}(\mathscr{D}_Y)}\mathscr{D}_{Y\leftarrow X}\cong f^{-1}(\mathscr{D}_{Z\leftarrow Y})\otimes_{f^{-1}(\mathscr{D}_Y)}^L\mathscr{D}_{Y\leftarrow X}\]
of complexes of $((g\circ f)^{-1}(\mathscr{D}_Z),\mathscr{D}_X)$-modules. For $\mathscr{M}\in D^b(\mathscr{D}_X)$, by definition we have
\[g_+f_+(\mathscr{M})=Rg_*(\mathscr{D}_{Z\leftarrow X}\otimes_{\mathscr{D}_Y}^LRf_*(\mathscr{D}_{Y\leftarrow X}\otimes_{\mathscr{D}_X}^L\mathscr{M})).\]
We now claim that the canonical morphism
\[\mathscr{D}_{Z\leftarrow X}\otimes_{\mathscr{D}_Y}^LRf_*(\mathscr{D}_{Y\leftarrow X}\otimes_{\mathscr{D}_X}^L\mathscr{M})\to Rf_*(f^{-1}(\mathscr{D}_{Z\leftarrow X})\otimes_{f^{-1}(\mathscr{D}_Y)}^L(\mathscr{D}_{Y\leftarrow X}\otimes_{\mathscr{D}_X}^L\mathscr{M}))\]
is an isomorphism. In fact, we have a canonical isomorphism
\[\mathscr{F}\otimes_{\mathscr{D}_Y}^LRf_*(\mathscr{G})\cong Rf_*(f^{-1}(\mathscr{F})\otimes_{f^{-1}(\mathscr{D}_Y)}^L\mathscr{G})\]
for $\mathscr{F}\in D^-_{\qcoh}(\mathscr{D}_Y^{\op})$, $\mathscr{G}\in D^b(f^{-1}(\mathscr{D}_Y))$. To see this, we may assume that $Y$ is affine, so that we can then replace $\mathscr{F}$ by a complex of free right $\mathscr{D}_Y$-modules belonging to $D^-_{\qcoh}(\mathscr{D}_Y^{\op})$. In this case, it suffices to prove our claim for $\mathscr{F}=\mathscr{D}_Y^{\oplus I}$. Now we have
\[\mathscr{F}\otimes_{\mathscr{D}_Y}^LRf_*(\mathscr{G})\cong Rf_*(\mathscr{G})^{\oplus I},\quad Rf_*(f^{-1}(\mathscr{F})\otimes_{f^{-1}(\mathscr{D}_Y)}^L\mathscr{G})\cong Rf_*(\mathscr{G}^{\oplus I})\]
so the claim follows from the fact that $Rf_*$ commutes with direct sums. With these, we finally conclude that
\begin{align*}
g_+f_+(\mathscr{M})&\cong Rg_*Rf_*(f^{-1}(\mathscr{D}_{Z\leftarrow Y})\otimes_{f^{-1}(\mathscr{D}_Y)}^L(\mathscr{D}_{Y\leftarrow X}\otimes_{\mathscr{D}_X}^L\mathscr{M}))\\
&\cong R(g\circ f)_*((f^{-1}(\mathscr{D}_{Z\leftarrow Y})\otimes_{f^{-1}(\mathscr{D}_Y)}^L\mathscr{D}_{Y\leftarrow X})\otimes_{\mathscr{D}_X}^L\mathscr{M})\\
&\cong R(g\circ f)_*(\mathscr{D}_{Z\leftarrow X}\otimes_{\mathscr{D}_X}^L\mathscr{M})\cong (g\circ f)_*(\mathscr{M})
\end{align*}
and this completes the proof.
\end{proof}

\begin{example}\label{D-module open immersion direct image char}
Let $j:U\to X$ be an open immersion of algebraic varieties. Then we have $\mathscr{D}_{X\leftarrow U}=j^{-1}(\mathscr{D}_X)=\mathscr{D}_U$, so $j_+=Rj_*$.
\end{example}

\begin{example}\label{D-module closed immersion direct image char}
Let $i:X\to Y$ be a closed immersion of smooth algebraic varieties. Take a local coordinate $\{y_i,\partial_{y_i}\}$ as in \cref{D-module closed immersion relative direct module local char}, for $\mathscr{M}\in\Mod(\mathscr{D}_X)$, we then have $H^p(i_+(\mathscr{M}))=0$ for $p\neq 0$, and
\[H^0(i_+(\mathscr{M}))\cong \C[\partial_{y_{r+1}},\dots,\partial_{y_n}]\otimes_{\C}i_*(\mathscr{M})\in\Mod(\mathscr{D}_Y).\]
\end{example}

\begin{proposition}\label{D-module closed immersion direct image prop}
Let $i:X\to Y$ be a closed immersion of smooth algebraic varieties.
\begin{enumerate}
    \item[(a)] The restriction $i_+:\Mod(\mathscr{D}_X)\to\Mod(\mathscr{D}_Y)$ is an exact functor.
    \item[(b)] The functor $i_+$ sends $\Qcoh(\mathscr{D}_X)$ to $\Qcoh(\mathscr{D}_Y)$.
\end{enumerate}
\end{proposition}
\begin{proof}
This follows from the explicit local description given in \cref{D-module closed immersion direct image char}.
\end{proof}

\begin{proposition}\label{D-module closed immersion direct image adjunction prop}
Let $i:X\to Y$ be a closed immersion of smooth algebraic varieties.
\begin{enumerate}
    \item[(a)] There exists a functorial isomorphism
    \[R\!\sHom_{\mathscr{D}_Y}(i_+(\mathscr{M}),\mathscr{N})\cong i_*R\!\sHom_{\mathscr{D}_X}(\mathscr{M},i^!(\mathscr{N})),\]
    where $\mathscr{M}\in D^-(\mathscr{D}_X)$, $\mathscr{N}\in D^+(\mathscr{D}_Y)$.
    \item[(b)] The functor $i^!:D^b(\mathscr{D}_Y)\to D^b(\mathscr{D}_X)$ is right adjoint to $i_+:D^b(\mathscr{D}_X)\to D^b(\mathscr{D}_Y)$.
\end{enumerate}
\end{proposition}
\begin{proof}
Since $H^0(R\Hom_{\mathscr{D}_Y}(\mathscr{K},\mathscr{L}))\cong\Hom_{D^b(\mathscr{D}_Y)}(\mathscr{K},\mathscr{L})$, the second statement follows from the first one by taking $H^0(R\Gamma(Y,-))$. We note that for $\mathscr{M}\in\Mod(\mathscr{D}_X)$ and $\mathscr{N}\in\Mod(\mathscr{D}_Y)$, there is a canonical isomorphism
\[\sHom_{\mathscr{D}_X}(\mathscr{M},\sHom_{i^{-1}(\mathscr{D}_Y)}(\mathscr{D}_{Y\leftarrow X},i^{-1}(\mathscr{N})))\cong \sHom_{i^{-1}(\mathscr{D}_Y)}(\mathscr{D}_{Y\leftarrow X}\otimes_{\mathscr{D}_X}\mathscr{M},i^{-1}(\mathscr{N}))\]
from which we obtain
\[R\!\sHom_{\mathscr{D}_X}(\mathscr{M},R\!\sHom_{i^{-1}(\mathscr{D}_Y)}(\mathscr{D}_{Y\leftarrow X},i^{-1}(\mathscr{N})))\cong R\!\sHom_{i^{-1}(\mathscr{D}_Y)}(\mathscr{D}_{Y\leftarrow X}\otimes_{\mathscr{D}_X}^L\mathscr{M},i^{-1}(\mathscr{N}))\]
for $\mathscr{M}\in D^-(\mathscr{D}_X)$, $\mathscr{N}\in D^+(\mathscr{D}_Y)$. Therefore, we have
\begin{align*}
R\!\sHom_{\mathscr{D}_Y}(i_+(\mathscr{M}),\mathscr{N})&\cong R\!\sHom_{\mathscr{D}_Y}(i_*(\mathscr{D}_{Y\leftarrow X}\otimes_{\mathscr{D}_X}^L\mathscr{M}),\mathscr{N})\\
&\cong R\!\sHom_{\mathscr{D}_Y}(i_*(\mathscr{D}_{Y\leftarrow X}\otimes_{\mathscr{D}_X}^L\mathscr{M}),R\Gamma_X(\mathscr{N}))\\
&\cong R\!\sHom_{\mathscr{D}_Y}(i_*(\mathscr{D}_{Y\leftarrow X}\otimes_{\mathscr{D}_X}^L\mathscr{M}),i_*i^{-1}R\Gamma_X(\mathscr{N}))\\
&\cong i_*R\!\sHom_{\mathscr{D}_Y}(i^{-1}i_*(\mathscr{D}_{Y\leftarrow X}\otimes_{\mathscr{D}_X}^L\mathscr{M}),i^{-1}R\Gamma_X(\mathscr{N}))\\
&\cong i_*R\!\sHom_{\mathscr{D}_Y}(\mathscr{D}_{Y\leftarrow X}\otimes_{\mathscr{D}_X}^L\mathscr{M},i^{-1}R\Gamma_X(\mathscr{N}))\\
&\cong i_*R\!\sHom_{\mathscr{D}_Y}(\mathscr{M}),R\!\sHom_{i^{-1}(\mathscr{D}_Y)}(\mathscr{D}_{Y\leftarrow X},i^{-1}R\Gamma_X(\mathscr{N}))\\
&\cong i_*R\!\sHom_{\mathscr{D}_X}(\mathscr{M},i^!(\mathscr{N})),
\end{align*}
where we have used \cref{D-module upper shriek for closed immersion char} in the last isomorphism and its proof.
\end{proof}

We now consider a special case: let $Z$ be a smooth algebraic variety and assume that $f:X=Y\times Z\to Y$ is the canonical projection. To compute the derived tensor product $\mathscr{D}_{Y\leftarrow X}\otimes_{\mathscr{D}_X}^L\mathscr{M}$, we use the resolution of the right $\mathscr{D}_X$-module $\mathscr{D}_{Y\leftarrow X}$ given in \cref{D-module smooth morphism relative direct module prop}. Let $n=\dim(Z)$; for $\mathscr{M}\in\Qcoh(\mathscr{D}_X)$, we define its \textbf{relative de Rham complex $DR_{X/Y}(\mathscr{M})$} by
\[DR_{X/Y}(\mathscr{M})^i=\Omega_{X/Y}^{n+i}\otimes_{\mathscr{O}_X}\mathscr{M}.\]
In view of \cref{D-module differential module char inverse map}, the differential of $DR_{X/Y}(\mathscr{M})$ is given by
\[d(\omega s)=d\omega\otimes s+\sum_{i=1}^{n}(dz_i\wedge\omega)\otimes\partial_is,\]
where $\{z_i,\partial_i\}$ is a local coordinate of $Z$. Note that each term of $DR_{X/Y}(\mathscr{M})$ is an $f^{-1}(\mathscr{D}_Y)$-module given by
\[P(\omega\otimes s)=\omega\otimes ((P\otimes 1)s),\]
where we denote by $P\mapsto P\otimes 1$ the canonical homomorphism $f^{-1}(\mathscr{D}_Y)\to\mathscr{D}_X$. By \cref{D-module smooth morphism relative direct module prop}, we have
\[\mathscr{D}_{Y\leftarrow X}\otimes_{\mathscr{D}_X}^L\mathscr{M}\cong DR_{X/Y}(\mathscr{M})\]
in the derived category of $f^{-1}(\mathscr{D}_Y)$-modules.

\begin{proposition}\label{D-module projection direct image prop}
Let $Y$ and $Z$ be smooth algebraic varieties and $f:X=Y\times Z\to Y$ be the projection. Let $n=\dim(Z)$.
\begin{enumerate}
    \item[(a)] For $\mathscr{M}\in\Mod(\mathscr{D}_X)$, we have $f_+(\mathscr{M})\cong Rf_*(DR_{X/Y}(\mathscr{M}))\in D^{[-n,n]}(\mathscr{D}_Y)$.
    \item[(b)] The functor $f_+$ sends $D^b_{\qcoh}(\mathscr{D}_X)$ to $D^b_{\qcoh}(\mathscr{D}_Y)$.
\end{enumerate}
\end{proposition}
\begin{proof}
The first assertion in (a) follows from the above consideration and the definition of $f_+$, and the second one follows from the fact that $f_*$ has cohomological dimension $n$. In order to prove (b), it is sufficient to show that $R^if_*(DR_{X/Y}(\mathscr{M}))$ is a quasi-coherent $\mathscr{O}_Y$-module for each $i$, which is true since $DR_{X/Y}(\mathscr{M})$ is a complex of quasi-coherent $\mathscr{O}_X$-modules.   
\end{proof}

\begin{corollary}\label{D-module direct image functor qcoh}
Let $f:X\to Y$ be a morphism of smooth algebraic varieties. Then $f_+$ sends $D^b_{\qcoh}(\mathscr{D}_X)$ to $D^b_{\qcoh}(\mathscr{D}_Y)$.
\end{corollary}
\begin{proof}
Note that any morphism $f:X\to Y$ is a composition of a closed immersion $i:X\to X\times Y$ (the graph morphism) and a projection $X\times Y\to Y$. Therefore the corollary follows from \cref{D-module direct image composition prop}, \cref{D-module closed immersion direct image prop} and \cref{D-module projection direct image prop}.
\end{proof}

To conclude our discussion, we prove a K\"unneth formula for the direct image functor. This can also be considered as a generalization of Fubini's theorem on integrations. Before this, we establish the following lemma, which is a special case of K\"unneth formula:
\begin{lemma}\label{D-module integral product with id Kunneth formula}
Let $f:X\to Y$ be a morphism of algebraic varieties and $S$ be an algebraic variety. For $\mathscr{M}\in D^b_{\qcoh}(\mathscr{O}_X)$ and $\mathscr{N}\in D^b_{\qcoh}(\mathscr{O}_S)$, the canonical homomorphism
\[Rf_*(\mathscr{M})\boxtimes\mathscr{N}\to R(f\times\id_S)_*(\mathscr{M}\boxtimes\mathscr{N}).\]
\end{lemma}
\begin{proof}
Since the question is local, we may assume that $S$ is affine. Then there exists an isomorphism $\mathscr{F}\cong\mathscr{N}$ such that $\mathscr{F}^i$ is a projective $\mathscr{O}_S$-module for each $i$ and $\mathscr{F}^i=0$ for $|i|\gg 0$. Hence we may assume from the beginning that $\mathscr{N}=\mathscr{O}_S$. Consider the cartesian square
\[\begin{tikzcd}
X\times S\ar[r,"p"]\ar[d,swap,"f\times\id_S"]&X\ar[d,"f"]&\\
Y\times S\ar[r,"q"]&Y
\end{tikzcd}\]
where $p,q$ are projections. By the base change theorem, we then have
\begin{equation*}
Rf_*(\mathscr{M})\boxtimes\mathscr{O}_S\cong q^*Rf_*(\mathscr{M})\cong R(f\times\id_S)_*p^*(\mathscr{M})\cong R(f\times\id_S)_*(\mathscr{M}\boxtimes\mathscr{O}_T).\qedhere
\end{equation*}
\end{proof}

\begin{proposition}\label{D-module integral Kunneth formula}
Let $f:X\to Y$ and $f':X'\to Y'$ be morphisms of smooth algebraic varieties. Then for $\mathscr{M}\in D^b_{\qcoh}(\mathscr{D}_X)$ and $\mathscr{M}'\in D^b_{\qcoh}(\mathscr{D}_{X'})$, we have a canonical isomorphism
\[f_+(\mathscr{M})\boxtimes f'_+(\mathscr{M}')\cong (f\times f')_+(\mathscr{M}\boxtimes\mathscr{M}').\]
\end{proposition}
\begin{proof}
By decomposing $f\times f'$ into the composite of $X\times X'\to Y\times X'\to Y\times Y'$, it is sufficient to show that for a morphism $f:X\to Y$ of smooth algebraic varieties and a smooth algebraic variety $S$ the canonical morphism
\[f_+(\mathscr{M})\boxtimes \mathscr{N}\to (f\times\id_S)_+(\mathscr{M}\boxtimes\mathscr{N})\]
is an isomorphism, where $\mathscr{M}\in D^b_{\qcoh}(\mathscr{D}_X)$ and $\mathscr{N}\in D^b_{\qcoh}(\mathscr{S})$. By decomposing $f$ into the composition of $\Gamma_f:X\to X\times Y$ and the projection $X\times Y\to Y$, we may assume that $f$ is either a closed immersion or a projection. Moreover, we may assume that $\mathscr{M}\in\Qcoh(\mathscr{D}_X)$ and $\mathscr{N}\in\Qcoh(\mathscr{D}_Y)$.\par
Assume that $i:X\to Y$ is a closed immersion. Since the question is local, we may take a local coordinate $\{y_i,\partial_{y_i}\}$ of $Y$ so that $y_{r+1},\cdots,y_n$ give the defining equations of $X$. Then by \cref{D-module closed immersion relative direct module local char}, we have
\begin{align*}
i_+(\mathscr{M})\boxtimes\mathscr{N}&\cong(\C[\partial_{y_{r+1}},\dots,\partial_{y_n}]\otimes_\C i_*(\mathscr{M}))\boxtimes\mathscr{N}\\
&\cong \C[\partial_{y_{r+1}},\dots,\partial_{y_n}]\otimes_\C(i\times 1)_*(\mathscr{M}\boxtimes\mathscr{N})\\
&\cong (i\times\id_S)(\mathscr{M}\boxtimes\mathscr{N}).
\end{align*}

On the other hand, if $f:X\to Y$ is a projection, then we have seen that
\begin{align*}
f_+(\mathscr{M})\boxtimes\mathscr{N}&\cong Rf_*(DR_{X/Y}(\mathscr{M}))\boxtimes\mathscr{N},\\
(f\times\id_S)_*(\mathscr{M}\boxtimes\mathscr{N})&\cong R(f\times\id_S)_*(DR_{X\times S/Y\times S}(\mathscr{M}\boxtimes\mathscr{N})).
\end{align*}
Now, since $DR_{X/Y}(\mathscr{M})$ is a complex of quasi-coherent $\mathscr{O}_X$-modules, by \cref{D-module integral product with id Kunneth formula} we have
\begin{align*}
Rf_*(DR_{X/Y}(\mathscr{M}))\boxtimes\mathscr{N}&\cong R(f\times\id_S)_*(DR_{X/Y}(\mathscr{M}))\boxtimes\mathscr{N}\\
&\cong R(f\times\id_S)_*(DR_{X\times S/Y\times S}(\mathscr{M}\boxtimes\mathscr{N}))
\end{align*}
and therefore
\begin{align*}
Rf_*(DR_{X/Y}(\mathscr{M}))\boxtimes\mathscr{N}\cong R(f\times\id_S)_*(DR_{X\times S/Y\times S}(\mathscr{M}\boxtimes\mathscr{N})).
\end{align*}
This completes the proof.
\end{proof}

\subsection{Kashiwara's equivalence}
We have seen in \cref{D-module closed immersion direct image prop} that for a closed immersion $i:X\to Y$, the direct image functor $i_+:\Qcoh(\mathscr{D}_X)\to \Qcoh(\mathscr{D}_Y)$ is an exact functor. In this case, the image of a $\mathscr{D}_X$-module under $i_+$ is a $\mathscr{D}_Y$-module supported in $X$. Let us denote by $\Qcoh^X(\mathscr{D}_Y)$ (resp. $\Coh^X(\mathscr{D}_Y)$) the full subcategory of $\Qcoh(\mathscr{D}_Y)$ (resp. $\Coh(\mathscr{D}_Y)$) consisting of $\mathscr{D}_Y$-modules that are supported in $X$. We then have the following characterization of the essential image of $i_+$, which plays a fundamental role in various studies of $D$-modules.

\begin{theorem}[\textbf{Kashiwara's equivalence}]\label{D-module closed immersion Kashiwara equivalence on ab cat}
Let $i:X\to Y$ be a closed immersion of smooth algebraic variaties. Then the functor $i_+$ induces equivalences
\[\Qcoh(\mathscr{D}_X)\stackrel{\sim}{\to} \Qcoh^X(\mathscr{D}_Y),\quad \Coh(\mathscr{D}_X)\stackrel{\sim}{\to} \Coh^X(\mathscr{D}_Y)\]
of abelian categories, whose quasi-inverse is given by $i^!$. Moreover, for any $\mathscr{N}\in\Qcoh^X(\mathscr{D}_Y)$, we have $H^p(i^!(\mathscr{N}))=0$ for $p\neq 0$.
\end{theorem}

Similar to the case of abelian categories, we denote by $D_{\qcoh}^{b,X}(\mathscr{D}_Y)$ (resp. $D_{\coh}^{b,X}(\mathscr{D}_Y)$) the full subcategory of $D_{\qcoh}^b(\mathscr{D}_Y)$ (resp. $D^b_{\coh}(\mathscr{D}_Y)$) consisting of complexes $\mathscr{N}$ whose coholomogy class $H^*(\mathscr{N})$ are supported in $X$.
\begin{corollary}\label{D-module closed immersion Kashiwara equivalence on triangle cat}
For $\mathscr{N}=\Coh$ or $\Qcoh$, the functor
\[i_+:D^b_\mathcal{N}(\mathscr{D}_X)\to D^{b,X}_\mathcal{N}(\mathscr{D}_Y)\]
gives an equivalence of triangulated categories, whose quasi-inverse is given by $i^!$.
\end{corollary}

\begin{example}
We consider the $\mathscr{D}_Y$-module
\[\mathscr{B}_{X|Y}=i_+(\mathscr{O}_X)\in \Qcoh^X(\mathscr{D}_Y).\]
If $\{y_i,\partial_i\}$ is a local coordinate system of $Y$ such that $y_{r+1},\dots,y_n$ give the defining equations of $X$, then by \cref{D-module closed immersion direct image char} we have
\[\mathscr{B}_{X|Y}=\C[\partial_{y_{r+1}},\dots,\partial_{y_n}]\otimes_{\C}i_*(\mathscr{O}_X)=\mathscr{D}_Y/\Big(\sum_{i=1}^{r}\mathscr{D}_Y\partial_i+\sum_{j=r+1}^n\mathscr{D}_Yy_j\Big).\]
In particular, for $X=\{x\}$ where $x\in Y$, we get
\[\mathscr{B}_{\{x\}|Y}=\mathscr{D}_Y/\mathscr{D}_Y\m_x=\mathscr{D}_Y\delta_x\cong \C[\partial_1,\dots,\partial_n]\delta_x,\]
where $\m_x=(y_1,\dots,y_n)$ is the maximal ideal at $x$ and $\delta_x\equiv 1$ mod $\m_x\in\mathscr{B}_{\{x\}|Y}$. Here we use the notation $\delta_x$ since the corresponding system $y_ju=0$ ($1\leq j\leq n$) of differential equations is the one satisfied by the Dirac delta function supported at $\{x\}$. By Kashiwara's equivalence, we have the correspondence
\[\Qcoh^{\{x\}}(\mathscr{D}_Y)\cong \{\text{the category of $\C$-vector spaces}\},\]
so objects of $\Qcoh^{\{x\}}(\mathscr{D}_Y)$ are direct sums of $\mathscr{B}_{\{x\}|Y}$.
\end{example}

We now give an application of Kashiwara's equivalence theorem.
\begin{theorem}\label{D-module projective space D-affine}
A product of a projective space and a smooth affine variety is $D$-affine.
\end{theorem}

\begin{theorem}\label{D-module proper morphism direct image coherence}
Let $f:X\to Y$ be a proper morphism. Then for any $\mathscr{M}\in D^b_{\coh}(\mathscr{D}_X)$, the direct image $f_+(\mathscr{M})$ belongs to $D^b_{\coh}(\mathscr{D}_Y)$.
\end{theorem}

\subsection{Base change theorem for direct images}
Let $X$ be a topological space, $Z$ a closed subset, and $U=X\setminus Z$ the complementary open subset of $X$. We denote by $i:Z\to X$ and $j:U\to X$ the immersions. Then by \cref{sheaf open and closed complement exact sequence on shriek}, for an injective sheaf $\mathscr{F}$ on $X$ we get an exact sequence
\[\begin{tikzcd}
0\ar[r]&\Gamma_Z(\mathscr{F})\ar[r]&\mathscr{F}\ar[r]&j_*j^{-1}(\mathscr{F})\ar[r]&0
\end{tikzcd}\]
where $\Gamma_Z(\mathscr{F})$ is the sheaf of sections of $\mathscr{F}$ supported in $Z$. For any $\mathscr{F}\in D^b(\C_X)$, we then obtain a distinguished triangle
\[\begin{tikzcd}
R\Gamma_Z(\mathscr{F})\ar[r]&\mathscr{F}\ar[r]&Rj_*j^{-1}(\mathscr{F})\ar[r,"+1"]&{}
\end{tikzcd}\]

Considering this distinguished triangle in the case where $X$ is a smooth algebraic variety and $\mathscr{F}\in D^b(\mathscr{D}_X)$, we obtain the following result.
\begin{proposition}\label{D-module open and closed complement dt of shriek}
Let $X$ be a smooth algebraic variety and $Z$ be a closed smooth subvariety of $X$. Set $U=X\setminus Z$ and denote by $i:Z\to X$ and $j:U\to X$ the immersions.
\begin{enumerate}
    \item[(a)] For $\mathscr{M}\in D_{\qcoh}^b(\mathscr{D}_X)$, we have a canonical distinguished triangle
    \[\begin{tikzcd}
    R\Gamma_Z(\mathscr{M})\ar[r]&\mathscr{M}\ar[r]&j_+j^!(\mathscr{M})\ar[r,"+1"]&{}
    \end{tikzcd}\]
    \item[(b)] We have $i^!j_+(\mathscr{N})=0$ for $\mathscr{N}\in D^b_{\qcoh}(\mathscr{D}_U)$ and $R\Gamma_Z(\mathscr{M})=i_+i^!(\mathscr{M})$ for $\mathscr{M}\in D^b_{\qcoh}(\mathscr{D}_X)$.
\end{enumerate}
\end{proposition}
\begin{proof}
For an open immersion $j:U\to X$, we have $j^!=j^{-1}$ and $j_+=Rj_*$, whence assertion (a). The isomorphism $i^!j_+=0$ follows from \cref{scheme closed and open complement i^*Rj_* zero prop}. To see that $R\Gamma_Z=i_+i^!$ holds on $D^b_{\qcoh}(\mathscr{D}_X)$, we note that since $j_+j^!(\mathscr{M})\in D^b_{\qcoh}(\mathscr{D}_X)$, we have $R\Gamma_Z(\mathscr{M})\in D_{\qcoh}^{b,Z}(\mathscr{D}_X)$, and therefore $R\Gamma_Z(\mathscr{M})\cong i_+i^!R\Gamma_Z(\mathscr{M})$ by \cref{D-module closed immersion Kashiwara equivalence on triangle cat}. It then suffices to show that $i^!R\Gamma_Z(\mathscr{M})\cong i^!(\mathscr{M})$. For this, we can apply $i^!$ to the distinguished triangle in (a), and note that $i^!j_+=0$ by the first assertion of (b).
\end{proof}

\begin{theorem}[\textbf{Base Change Theorem}]\label{D-module base change theorem for shriek and integral}
Let $f:X\to Y$ and $g:Y'\to Y$ be morphisms of smooth algebraic varieties and consider the fiber product
\[\begin{tikzcd}
X'\ar[r,"f'"]\ar[d,swap,"g'"]&Y'\ar[d,"g"]\\
X\ar[r,"f"]&Y
\end{tikzcd}\]
Then there is a canonical isomorphism of functors
\[g^!f_+\cong f'_+g'^!:D^b_{\qcoh}(\mathscr{D}_X)\to D^b_{\qcoh}(\mathscr{D}_{Y'}).\]
\end{theorem}

\begin{corollary}[\textbf{Projection Formula}]\label{D-module direct image functor projection formula}
Let $f:X\to Y$ be a morphism of smooth varieties. Then for $\mathscr{M}\in D_{\qcoh}^b(\mathscr{D}_X)$ and $\mathscr{N}\in D_{\qcoh}^b(\mathscr{D}_Y)$, we have a canonical isomorphism
\[f_+(\mathscr{M}\otimes_{\mathscr{O}_X}^LLf^*(\mathscr{N}))\cong f_+(\mathscr{M})\otimes_{\mathscr{O}_Y}^L\mathscr{N}.\] 
\end{corollary}
\begin{proof}
Applying \cref{D-module base change theorem for shriek and integral} to the Cartesian square
\[\begin{tikzcd}
X\ar[r,"\Gamma_f"]\ar[d,swap,"f"]&X\times Y\ar[d,"f\times \id_Y"]\\
Y\ar[r,"\Delta_Y"]&Y\times Y
\end{tikzcd}\]
we obtain
\begin{equation*}
f_+(\mathscr{M}\otimes_{\mathscr{O}_X}^LLf^*(\mathscr{N}))\cong f_+(L\Gamma_f^*(\mathscr{M}\boxtimes\mathscr{N}))\cong L\Delta_Y^*((f\times\id_Y)_+(\mathscr{M}\boxtimes\mathscr{N}))\cong  f_+(\mathscr{M})\otimes_{\mathscr{O}_Y}^L\mathscr{N}.\qedhere
\end{equation*}
\end{proof}

\subsection{Inverse images in the non-characteristic case}
We have shown in \cref{D-module derived inverse image of smooth morphism prop} that the inverse image of a coherent $D$-module with respect to a smooth morphism is again coherent. However, this is not true in general for non-smooth morphisms, as we saw in \cref{D-module inverse image fuctor not coherent eg}. We now give a sufficient conidtion on the coherence of the inverse image of a coherent $D$-module, which is more general than smoothness.\par
For a morphism $f:X\to Y$ of smooth algebraic varieties, we have a canonical morphism
\[\rho_f:X\times_YT^*Y\to T^*X\]
which is the morphism gathering all homomorphisms $df_x^*:T^*_{f(x)}Y\to T^*_xX$ dual to $df_x:T_xX\to T_{f(x)}Y$. Let $\varpi_f:X\times_YT^*Y\to T^*Y$ denote the canonical projection, then we have
\[\varphi_f^*(\omega_Y)=\rho_f^*(\omega_X)\]
where $\omega_X$ and $\omega_Y$ denote the canonical $1$-forms on $T^*X$ and $T^*Y$, respectively. Consider the diagram
\[\begin{tikzcd}
X\ar[d]\ar[d,swap,"f"]&X\times_YT^*Y\ar[l]\ar[r,"\rho_f"]\ar[d,swap,"\varpi_f"]&T^*X\\
Y&T^*Y\ar[l]
\end{tikzcd}\]
Let $T^*_XX$ be the zero section of $X$ and
\[T^*_XY:=\rho_f^{-1}(T^*_XX)\sub X\times_YT^*Y.\]
If we choose a local cooredinate for $X$ and $Y$, then $T^*_XY$ can be written locally as
\[T^*_XY=\{(x,y,\xi)\in X\times_YT^*Y:\text{$y=f(x)$ and $\xi\in\ker(df_x^*)$}\}.\]
In particular, if $f$ is a closed immersion, then $T^*_XY$ is the conormal bundle of $X$ in $Y$.

\begin{lemma}

\end{lemma}

Let $f:X\to Y$ be a morphism of smooth algebraic varieties and $\mathscr{N}$ be a coherent $\mathscr{D}_Y$-module. We say that $f$ is \textbf{non-characteristic with respect to $\mathscr{M}$} if 
\[\varpi_f^{-1}(\Ch(\mathscr{N}))\cap T^*_XY\sub X\times_YT_Y^*Y.\]
This definition is motivated by the theory of linear partial differential equations, as we see below.

\begin{example}

\end{example}

\begin{example}
A smooth morphism $f:X\to Y$ is non-characteristic with respect to any coherent $\mathscr{D}_Y$-module. In fact, in this case the associated homomorphism $df_x^*:T_{f(x)}^*Y\to T^*_xX$ is injective for any $x\in X$, so $T_X^*Y$ is contaiend in $X\times_YT^*_YY$.
\end{example}

\begin{theorem}\label{D-module non-characteristic inverse image prop}
Let $f:X\to Y$ be a morphism of smooth algebraic varieties and $\mathscr{N}$ be a coherent $\mathscr{D}_Y$-module such that $f$ is non-characteristic with respect to $\mathscr{N}$.
\begin{enumerate}
    \item[(a)] $H^i(Lf^*(\mathscr{N}))=0$ for $i\neq 0$.
    \item[(b)] $H^0(Lf^*(\mathscr{N}))$ is a coherent $\mathscr{D}_X$-module.
    \item[(c)] $\Ch(H^0(Lf^*(\mathscr{M})))=\rho_f\varpi_f^{-1}(\Ch(\mathscr{M}))$. 
\end{enumerate}
\end{theorem}

\begin{remark}
Note that by the assumption of being non-characteristic, the morphism
\[\rho_f:\varpi_f^{-1}(\Ch(\mathscr{N}))\to T^*X\]
is finite (i.e. it is closed and all fibers are finite). Therefore, $\rho_f\varpi_f^{-1}(\Ch(\mathscr{N}))$ is a closed algebraic subset of $T^*X$.
\end{remark}

\subsection{Relations with the duality functors}
In this paragraph, we consider the relations between the duality functor and various functors on the derived category of $D$-modules. In particular, we shall prove that $f_+$ and $f^!$ commute with the duality functor $D$, and establish an adjunction formula for $f_+$.

\begin{theorem}\label{D-module duality functor and f^!}
Let $f:X\to Y$ be a morphism of smooth algebraic varieties, and $\mathscr{M}$ be a coherent $\mathscr{D}_Y$-module.
\begin{enumerate}
    \item[(a)] Assume that $Lf^*(\mathscr{M})\in D^b_{\coh}(\mathscr{D}_X)$, then there exists a canonical isomorphism
    \[D_X(Lf^*(\mathscr{M}))\to Lf^*(D_Y(\mathscr{M})).\]
    \item[(b)] If $f$ is non-characteristic with respect to $\mathscr{M}$ (hence $Lf^*(\mathscr{M})=f^*(\mathscr{M})$ is coherent by \cref{D-module non-characteristic inverse image prop}), then the morphism in (a) is an isomorphism.
\end{enumerate}
\end{theorem}

\begin{proposition}\label{D-module proper morphism trace map}
Let $f:X\to Y$ be a proper morphism of smooth algebraic varieties. Then we have a trace homomorphism
\[\tr_f:f_+(\mathscr{O}_X)[d_X]\to \mathscr{O}_Y[d_Y].\]
\end{proposition}

\begin{theorem}\label{D-module proper morphism duality functor and direct image commute}
Let $f:X\to Y$ be a proper morphism of smooth algebraic varieties. Then we have a canonical isomorphism of functors
\[f_+D_X\stackrel{\sim}{\to} D_Yf_+:D^b_{\coh}(\mathscr{D}_X)\to D_{\coh}^b(\mathscr{D}_Y).\]
\end{theorem}

\begin{corollary}[\textbf{Adjunction formula}]\label{D-module proper morphism adjunction formula}
Let $f:X\to Y$ be a proper morphism of smooth algebraic varieties. Then we have an isomorphism
\[R\!\sHom_{\mathscr{D}_Y}(f_+(\mathscr{M}),\mathscr{N})\stackrel{\sim}{\to} Rf_*R\!\sHom_{\mathscr{D}_X}(\mathscr{M},f^!(\mathscr{N}))\]
for $\mathscr{M}\in D^b_{\coh}(\mathscr{D}_X)$ and $\mathscr{N}\in D^b(\mathscr{D}_Y)$.
\end{corollary}

\begin{theorem}
Let $f:X\to Y$ be a smooth morphism of smooth algebraic varieties. Then we have an isomorphism
\[R\!\sHom_{\mathscr{D}_Y}(\mathscr{N},f_+(\mathscr{M}))\stackrel{\sim}{\to} Rf_*R\!\sHom_{\mathscr{D}_X}(f^!(\mathscr{N}),\mathscr{M})\]
for $\mathscr{M}\in D^b(\mathscr{D}_X)$ and $\mathscr{N}\in D^b_{\coh}(\mathscr{D}_Y)$.
\end{theorem}

\section{Holonomic \texorpdfstring{$D$}{D}-modules}
In this section we study functorial behaviors of holonomic systems and show that any simple object in the abelian category of holonomic $\mathscr{D}_X$-modules is a minimal extension of an integrable connection on a locally closed smooth subvariety $Y$ of $X$.

\subsection{The category of holonomic \texorpdfstring{$D$}{D}-modules}
Recall that the dimension of the characteristic variety $\Ch(\mathscr{M})$ of a (nontrivial) coherent $\mathscr{D}_X$-module $\mathscr{M}$ satisfies the inequality $\dim(\Ch(\mathscr{M}))\geq\dim(X)$ and that a coherent $\mathscr{D}_X$-module $\mathscr{M}$ is called \textbf{holonomic} if $\dim(\Ch(\mathscr{M}))=\dim(X)$ or $\mathscr{M}=0$. We denote by $\Mod_h(\mathscr{D}_X)$ the full subcategory of $\Coh(\mathscr{D}_X)$ consisting of holonomic $\mathscr{D}_X$-modules.

\begin{proposition}\label{D-module homolomic category prop}
Let $X$ be a smooth algebraic variety.
\begin{enumerate}
    \item[(a)] For an exact sequence $0\to\mathscr{M}'\to\mathscr{M}\to\mathscr{M}''\to 0$ in $\Coh(\mathscr{D}_X)$, $\mathscr{M}$ is holonomic if and only if $\mathscr{M}',\mathscr{M}''$ are holonomic.
    \item[(b)] Any holonomic $\mathscr{D}_X$-module has finite length. In other words, the category $\Mod_h(\mathscr{D}_X)$ is Artinian.
\end{enumerate}
\end{proposition}
\begin{proof}
The first statement follows from $\Ch(\mathscr{M})=\Ch(\mathscr{M}')\cup\Ch(\mathscr{M}'')$, and the second one is proved using the characteristic cycle as follows. For a holonomic $\mathscr{D}_X$-module $\mathscr{M}$ consider its characteristic cycle
\[\Cyc(\mathscr{M})=\sum_V\mult_V(\mathscr{M})\cdot V.\]
Note that $\dim(V)=d_X$ for any $V\in\Ch(\mathscr{M})$. We define the total multiplicity of $\mathscr{M}$ to be
\[\mult(\mathscr{M})=\sum_Vm_V(\mathscr{M}).\]
Then by \cref{D-module coh associated cycle additive}, the total multiplicity is addigive, and $\mult(\mathscr{M})=0$ if and only if $\Ch(\mathscr{M})=\emp$, if and only if $\mathscr{M}=0$. The second assertion then follows by induction on $\mult(\mathscr{M})$.
\end{proof}

We denote by $D_h^b(\mathscr{D}_X)$ the full subcategory of $D^b_{\coh}(\mathscr{D}_X)$ consisting of objects $\mathscr{M}\in D^b_{\coh}(\mathscr{D}_X)$ whose cohomology groups are holonomic. By \cref{D-module homolomic category prop}, this is a full triangulated subcategory of $D^b_{\coh}(\mathscr{D}_X)$.\par
The following result is the first important step in the study of holonomic $D$-modules. It suggests that we can say that a holonomic $\mathscr{D}$-module is generically an integrable connection.

\begin{proposition}\label{D-module holonomic generically locally free}
Let $\mathscr{M}$ be a holonomic $\mathscr{D}_X$-module. Then there exists an open dense subset $U\sub X$ such that $\mathscr{M}|_U$ is coherent over $\mathscr{O}_U$. In other words, $\mathscr{M}|_U$ is an integral connection on $U$.
\end{proposition}
\begin{proof}
Let $T^*_XX$ be the zero section of $X$ in $T^*X$ and set $S=\Ch(\mathscr{M})\setminus T_X^*X$. If $S=\emp$, then $\Ch(\mathscr{M})$ is contained in $T^*_XX$ and $\mathscr{M}$ is an integral connection by \cref{D-module coherent over O_X iff locally free}, so we may assume that $S\neq\emp$. Since $S$ is conic, the dimension of each fiber of $\pi|_S:S\to\pi(S)$ is strictly positive and hence $\dim(\pi(S))<\dim(S)\leq\dim(X)$. There then exists a nonempty open subset $U\sub X$ such that $U\subset X\setminus\pi(S)$, and we have $\Ch(\mathscr{M}|_U)\setminus T^*_UU=\emp$ in view of the local nature of the characteristic variety. We then conclude that $\mathscr{M}|_U$ is coherent over $\mathscr{O}_U$ by \cref{D-module coherent over O_X iff locally free}, whence the proposition.
\end{proof}

Recall that if $U\sub X$ is an open subset and $\mathscr{N}$ is a coherent submodule of $\mathscr{M}|_U$, then there exists a coherent submodule $\widetilde{\mathscr{N}}$ of $\mathscr{M}$ whose restriction on $U$ is equal to $\mathscr{N}$ (cf. \autoref{scheme qcoh sheaf extension subsection}). We now prove that this result is also true for holonomic modules, that is, we can assume that both $\mathscr{N}$ and $\widetilde{\mathscr{N}}$ are holonomic.
\begin{proposition}\label{D-module holonomic open subset extension exist}
Let $\mathscr{M}\in\Qcoh(\mathscr{D}_X)$. For an open subset $U\sub X$, suppose that we are given a holonomic submodule $\mathscr{N}$ of $\mathscr{M}|_U$. Then there exists a holonomic submodule $\widetilde{\mathscr{N}}$ of $\mathscr{M}$ such that $\widetilde{\mathscr{N}}|_U=\mathscr{N}$.
\end{proposition}
\begin{proof}
By \cref{scheme local Noe qcoh extension} and \cref{scheme local Noe qcoh is inductive limit ft}, we may assume that $\mathscr{M}$ is coherent and $\mathscr{M}|_U=\mathscr{N}$. Set $\mathscr{L}=H^0(D_X(\mathscr{M}))$. By \cref{D-module dual of holonomic prop}~(b), we have $\codim(\Ch(\mathscr{L}))\geq d_X$, so $\mathscr{L}$ is a holonomic $\mathscr{D}_X$. Moreover, its dual module $\widetilde{\mathscr{N}}=D_X(\mathscr{L})$ is also holonomic by \cref{D-module dual of holonomic prop}~(d). Since we have $\mathscr{L}=H^0(D_X(\mathscr{M}))\cong\tau^{\geq 0}(D_X(\mathscr{M}))$ by \cref{D-module dual of holonomic prop}~(a), there is a distinguished triangle
\[\begin{tikzcd}
\mathscr{K}\ar[r]&D_X(\mathscr{M})\ar[r]&\mathscr{L}\ar[r,"+1"]&{}
\end{tikzcd}\]
where $\mathscr{K}=\tau^{-\leq -1}(D_X(\mathscr{M}))$. By applying $D_X$, we obtain a distinguished triangle
\[\begin{tikzcd}
\widetilde{\mathscr{N}}\ar[r]&\mathscr{M}\ar[r]&D_X(\mathscr{K})\ar[r,"+1"]&{}
\end{tikzcd}\]
Since the duality functor commutes with restrictions to open subsets, we conclude that
\[\widetilde{\mathscr{N}}|_U=D_U(\mathscr{L}|_U)=D_U^2(\mathscr{M}|_U)=\mathscr{M}|_U=\mathscr{N}.\]
It remains to show that the canonical morphism $\widetilde{\mathscr{N}}\to\mathscr{M}$ is injective, for which we will show that
\begin{equation}\label{D-module holonomic open subset extension exist-1}
H^i(D_X(\tau^{\geq-k}\mathscr{K}))=0\for i>0,k>0.
\end{equation}
(Note that $\tau^{\geq-k}\mathscr{K}\cong\mathscr{K}$ for $k\gg 0$, in view of \cref{D-module dual of holonomic prop}.) To this end, let us first prove that
\begin{equation}\label{D-module holonomic open subset extension exist-2}
H^i(D_X(H^{-k}(\mathscr{K})[k]))=H^{i-k}(D_X(H^{-k}(\mathscr{K})))=0\for i<0,k>0.
\end{equation}
For $k>0$ we have $H^{-k}(\mathscr{K})\cong H^{-k}(D_X(\mathscr{M}))$ and $\codim(\Ch(H^{-k}(\mathscr{K})))\geq d_X-k$ by \cref{D-module dual of holonomic prop}~(b), so (\ref{D-module holonomic open subset extension exist-2}) is a concequence of \cref{D-module dual of holonomic prop}~(a). We now prove (\ref{D-module holonomic open subset extension exist-1}) by induction on $k$. If $k=1$, then we have $\tau^{\geq-k}(\mathscr{K})=H^{-k}(\mathscr{K})[k]$, and the assertion follows from (\ref{D-module holonomic open subset extension exist-2}). In the general case $k\geq 2$, by applying $D_X$ to the distinguished triangle
\[\begin{tikzcd}
H^{-k}(\mathscr{K})[k]\ar[r]&\tau^{\geq-k}\mathscr{K}\ar[r]&\tau^{\geq-(k-1)}\mathscr{K}\ar[r,"+1"]&{}
\end{tikzcd}\]
we obtain a distinguished triangle
\[\begin{tikzcd}
D_X(\tau^{\geq-(k-1)}\mathscr{K})\ar[r]&D_X(\tau^{\geq-k}\mathscr{K})\ar[r]&D_X(H^{-k}(\mathscr{K})[k])\ar[r,"+1"]&{}
\end{tikzcd}\]
so the assertion follows from (\ref{D-module holonomic open subset extension exist-2}) and the induction hypothesis.
\end{proof}

\subsection{Functors for holonomic \texorpdfstring{$D$}{D}-modules}
We now consider the bahavaior of holonomic $D$-modules under various functors. We first note the following result, which is a concequence of \cref{D-module dual of holonomic prop}.

\begin{proposition}\label{D-module holonomic duality preserve}
The duality functor $D_X$ induces isomorphisms
\[\Mod_h(\mathscr{D}_X)\stackrel{\sim}{\to} \Mod_h(\mathscr{D}_X^{\op}),\quad D^b_h(\mathscr{D}_X)\stackrel{\sim}{\to} D^b_h(\mathscr{D}_X^{\op}).\]
\end{proposition}

Let $X$ and $Y$ be smooth algebraic varieties. Since $\Ch(\mathscr{M}\boxtimes\mathscr{N})=\Ch(\mathscr{M})\times\Ch(\mathscr{N})$ for $\mathscr{M}\in\Coh(\mathscr{D}_X)$ and $\mathscr{N}\in\Coh(\mathscr{D}_Y)$, the following is also immediate:
\begin{proposition}\label{D-module holonomic external product functor}
The external tensor product $\boxtimes$ induces functors
\begin{align*}
(-)\boxtimes(-)&:\Mod_h(\mathscr{D}_X)\times\Mod_h(\mathscr{D}_Y)\to \Mod_h(\mathscr{D}_{X\times Y}),\\
(-)\boxtimes(-)&:D^b_h(\mathscr{D}_X)\times D^b_h(\mathscr{D}_Y)\to D^b_h(\mathscr{D}_{X\times Y}).
\end{align*}
\end{proposition}

Now recall that for a morphism $f:X\to Y$ of smooth algebraic varieties, we have defined functors
\[f_+:D^b_{\qcoh}(\mathscr{D}_X)\to D^b_{\qcoh}(\mathscr{D}_Y),\quad f^!:D^b_{\qcoh}(\mathscr{D}_Y)\to D^b_{\qcoh}(\mathscr{D}_X).\]
Moreover, if $f$ is proper (resp. smooth), the functor $f_+$ (resp. $f^!$) preserves the coherency (cf. \cref{D-module proper morphism direct image coherence} and \cref{D-module derived inverse image of smooth morphism prop}) and we obtain functors
\[f_+:D^b_{\coh}(\mathscr{D}_X)\to D^b_{\coh}(\mathscr{D}_Y),\quad \text{(resp. $f^!:D^b_c(\mathscr{D}_Y)\to D^b_c(\mathscr{D}_X)$)}.\]
However, neither $f_+$ nor $f^!$ preserves the coherency for general morphisms $f$. A surprising fact, which we will show in this paragraph, is that the holonomicity is nevertheless preserved by these functors for any morphism $f:X\to Y$. In other words, the coherence for $f_+$ and $f^!$ is guaranteed if we restrict ourselves to holonomic $D$-modules.

\begin{theorem}\label{D-module direct and inverse image of holonomic module prop}
Let $f:X\to Y$ be a morphism of smooth algebraic varieties. Then $f_+$ sends $D^b_h(\mathscr{D}_X)$ to $D^b_h(\mathscr{D}_Y)$ and $f^!$ sends $D^b_h(\mathscr{D}_Y)$ to $D^b_h(\mathscr{D}_X)$.
\end{theorem}
\begin{corollary}\label{D-module holonomic tensor product is holonomic}
The internal tensor product $\otimes_{\mathscr{O}_X}^L$ induces a functor
\[(-)\otimes_{\mathscr{O}_X}^L(-):D^b_h(\mathscr{D}_X)\times D^b_h(\mathscr{D}_X)\to D^b_h(\mathscr{D}_X).\]
\end{corollary}
\begin{proof}
This follows from \cref{D-module holonomic external product functor} and \cref{D-module direct and inverse image of holonomic module prop}, since $(-)\otimes_{\mathscr{O}_X}^L(-)=L\Delta_X^*((-)\boxtimes(-))$, where $\Delta_X$ is the diagonal morphism.
\end{proof}

The proof of \cref{D-module direct and inverse image of holonomic module prop} is rather involved, so we need some reduction. We first note that taking direct image under a closed immersion preserves holonomic $D$-modules.

\begin{lemma}\label{D-module holonomic direct image under closed immersion prop}
Let $i:X\to Y$ be a closed immersion. Then for $\mathscr{M}\in D^b_{\coh}(\mathscr{D}_X)$, we have $\mathscr{M}\in D^b_h(\mathscr{D}_X)$ if and only if $i_+(\mathscr{M})\in D^b_h(\mathscr{D}_Y)$.
\end{lemma}
\begin{proof}
Since $i_+$ is exact (cf. \cref{D-module closed immersion direct image prop}), we may assume that $\mathscr{M}\in\Coh(\mathscr{D}_X)$. Let
\[\begin{tikzcd}
T^*Y&X\times_YT^*Y\ar[l,swap,hook,"\varpi"]\ar[r,tail,"\rho"]&T^*X
\end{tikzcd}\]
be the canonical morphisms. Then we have $\Ch(i_+(\mathscr{M}))=\varpi\rho^{-1}(\Ch(\mathscr{M}))$ by (\cite{Hotta}, Lemma 2.3.5). Since $\varpi$ is a closed immersion and $\rho$ is a smooth surjective morphisms with $d$-dimension fibers ($d$ is the codimension of $X$ in $Y$), we conclude that
\[\dim(\Ch(i_+(\mathscr{M})))=\dim(\Ch(\mathscr{M}))+d\]
from which the claim follows.
\end{proof}

\subsection{Adjunction formulas}
Let $f:X\to Y$ be a morphism of smooth algebraic varieties. Recall that we have defined functors $f_+$ and $f^!$ on the derived category of $D$-modules. We now define new functors using the duality functor $D$:
\begin{align*}
f_!:=D_Yf_+D_X&:D_h^b(\mathscr{D}_X)\to D_h^b(\mathscr{D}_Y),\\
f^+:=D_Xf^!D_Y&:D_h^b(\mathscr{D}_Y)\to D_h^b(\mathscr{D}_X).
\end{align*}
We now justify our notations by showing that $(f_!,f^!)$ and $(f^+,f_+)$ are adjont pairs.

\begin{theorem}\label{D-module adjunction of six functor for holonomic module}
For $\mathscr{M}\in D_h^b(\mathscr{D}_X)$ and $\mathscr{N}\in D^b_h(\mathscr{D}_Y)$, we have canonical isomorphisms
\begin{gather*}
R\!\sHom_{\mathscr{D}_Y}(f_!(\mathscr{M}),\mathscr{N})\stackrel{\sim}{\to} Rf_*R\!\sHom_{\mathscr{D}_X}(\mathscr{M},f^!(\mathscr{N})),\\
Rf_*R\!\sHom_{\mathscr{D}_X}(f^+(\mathscr{N}),\mathscr{M})\stackrel{\sim}{\to} R\!\sHom_{\mathscr{D}_Y}(\mathscr{N},f_+(\mathscr{M})).
\end{gather*}
\end{theorem}
\begin{proof}
We first note that by (\ref{D-module direct and inverse relative module isomorphism}) and the projection formula for $\mathscr{O}_X$-modules, for $\mathscr{E}\in D^b(\mathscr{D}_X)$ we have
\begin{align*}
Rf_*((\Omega_X\otimes_{\mathscr{O}_X}^L\mathscr{E})\otimes_{\mathscr{D}_X}^L\mathscr{D}_{X\to Y})&\cong Rf_*(\mathscr{E}\otimes_{\mathscr{D}_X}^L(\Omega_X\otimes_{\mathscr{O}_X}^L\mathscr{D}_{X\to Y}))\\
&\cong Rf_*(\mathscr{E}\otimes_{\mathscr{D}_X}^L\mathscr{D}_{Y\leftarrow X}\otimes_{f^{-1}(\mathscr{O}_Y)}^Lf^{-1}(\Omega_Y))\\
&\cong Rf_*(\mathscr{E}\otimes_{\mathscr{D}_X}^L\mathscr{D}_{Y\leftarrow X})\otimes_{\mathscr{O}_Y}^L\Omega_Y,
\end{align*}
so by (\ref{D-module Hom of coh isomorphism by duality-1}), we have
\begin{align*}
Rf_*R\!\sHom_{\mathscr{D}_X}(\mathscr{M},f^!(\mathscr{N}))&\cong Rf_*((\Omega_X\otimes_{\mathscr{O}_X}^LD_X(\mathscr{M}))\otimes_{\mathscr{D}_X}^Lf^!(\mathscr{N}))[-d_X]\\
&\cong Rf_*((\Omega_X\otimes_{\mathscr{O}_X}^LD_X(\mathscr{M}))\otimes_{\mathscr{D}_X}^LLf^*(\mathscr{N}))[-d_Y]\\
&\cong Rf_*((\Omega_X\otimes_{\mathscr{O}_X}^LD_X(\mathscr{M}))\otimes_{\mathscr{D}_X}^L\mathscr{D}_{X\to Y}\otimes_{f^{-1}(\mathscr{D}_Y)}^Lf^{-1}(\mathscr{N}))[-d_Y]\\
&\cong Rf_*((\Omega_X\otimes_{\mathscr{O}_X}^LD_X(\mathscr{M}))\otimes_{\mathscr{D}_X}^L\mathscr{D}_{X\to Y})\otimes_{\mathscr{D}_Y}^L\mathscr{N}[-d_Y]\\
&\cong (Rf_*(D_X(\mathscr{M})\otimes_{\mathscr{D}_X}^L\mathscr{D}_{Y\leftarrow X})\otimes_{\mathscr{O}_X}^L\Omega_Y)\otimes_{\mathscr{D}_Y}^L\mathscr{N}[-d_Y]\\
&\cong R\!\sHom_{\mathscr{D}_Y}(f_+(D_X(\mathscr{M})),\mathscr{N}).
\end{align*} 
This proves the first assertion, and the second one follows by taking duality.
\end{proof}

\begin{corollary}\label{D-module adjoint pair for holonomic module}
For $\mathscr{M}\in D_h^b(\mathscr{D}_X)$ and $\mathscr{N}\in D^b_h(\mathscr{D}_Y)$, we have canonical isomorphisms
\begin{gather*}
\Hom_{\mathscr{D}_Y}(f_!(\mathscr{M}),\mathscr{N})\stackrel{\sim}{\to} \Hom_{\mathscr{D}_X}(\mathscr{M},f^!(\mathscr{N})),\\
\Hom_{\mathscr{D}_X}(f^+(\mathscr{N}),\mathscr{M})\stackrel{\sim}{\to} \Hom_{\mathscr{D}_Y}(\mathscr{N},f_+(\mathscr{M})).
\end{gather*}
\end{corollary}
\begin{proof}
This follows from \cref{D-module adjunction of six functor for holonomic module} by applying $H^0R\Gamma(Y,-)$.
\end{proof}

\begin{theorem}\label{D-module holonomic morphism f_! to f_+}
There is a morphism of functors
\[f_!\to f_+:D^b_h(\mathscr{D}_X)\to D_h^b(\mathscr{D}_Y).\]
Moreover, if $f$ is proper, then this morphism is an isomorphism.
\end{theorem}
\begin{proof}
By Hironaka's desingularization theorem (\cite{Hi}), there exists a smooth completion $\widetilde{X}$ of $X$. Since $X$ is quasi-projective, a desingularization $\widetilde{X}$ of the Zariski closure $\widebar{X}$ of $X$ in the projective space is such a completion (even if $X$ is not quasi-projective, there exists a smooth completion by a theorem due to Nagata). Therefore, the map $f:X\to Y$ factorizes as
\[\begin{tikzcd}
X\ar[r,hook,"g"]&X\times Y\ar[r,hook,"j"]&\widetilde{X}\times Y\ar[r,"p"]&Y
\end{tikzcd}\]
where $g$ is the graph morphism of $f$ and $p$ is the canonical projection. In this situation, $g$ and $p$ are proper and $j$ is an open immersion, so we can reduce our problem to the cases of proper morphisms and open immersions. If $f$ is proper, we have an isomorphism $f_!=D_Yf_+D_X\cong f_+$ by \cref{D-module proper morphism duality functor and direct image commute}, so let us consider the case where $f=j:X\to Y$ is an open immersion. Let $\mathscr{M}\in D^b_h(\mathscr{D}_X)$, then by \cref{D-module adjoint pair for holonomic module} and \cref{D-module open immersion direct image char}, we have
\begin{align*}
\Hom_{D^b_h(\mathscr{D}_Y)}(j_!(\mathscr{M}),j_+(\mathscr{M}))&\cong \Hom_{D^b_h(\mathscr{D}_X)}(\mathscr{M},j^!j_+(\mathscr{M}))\cong \Hom_{D^b_h(\mathscr{D}_X)}(\mathscr{M},j^{-1}Rj_*(\mathscr{M}))\\
&\cong \Hom_{D^b_h(\mathscr{D}_X)}(\mathscr{M},\mathscr{M}),
\end{align*}
from which we obtain the desired morphism $j_!(\mathscr{M})\to j_+(\mathscr{M})$ as the image of the identity morphism on $\mathscr{M}$.
\end{proof}

\subsection{Finiteness property}
In this paragraph we prove the coherence of solution spaces for holonomic $D$-modules. For this, we need the following lemma.
\begin{lemma}\label{D-module coherent projective locus open dense}
Let $\mathscr{M}$ be a coherent $\mathscr{D}_X$-module. Then there exists an open dense subset $U\sub X$ such that $\mathscr{M}|_U$ is projective over $\mathscr{O}_U$.
\end{lemma}
\begin{proof}
Take a good filtration of $\mathscr{M}$, then $\gr(\mathscr{M})$ is coherent over $\pi_*(\mathscr{O}_{T^*X})$, so there exists an open dense subset $U\sub X$ such that $\gr(\mathscr{M})|_U$ is free over $\pi_*(\mathscr{O}_{T^*U})$. By shrinking $U$ is necessary, we may assume that $\gr(\mathscr{M})|_U$ is free over $\mathscr{O}_U$. This implies that each $F_i(\mathscr{M})/F_{i-1}(\mathscr{M})|_U$ (and hence each $F_i(\mathscr{M})|_U$) is projective over $\mathscr{O}_U$, so $\mathscr{M}|_U$ is projective over $\mathscr{O}_U$.
\end{proof}

\begin{theorem}\label{D-module holonomic iff integrable connection straitification}
The following conditions on $\mathscr{M}\in D^b_{\coh}(\mathscr{D}_X)$ are equivalent:
\begin{enumerate}
    \item[(\rmnum{1})] $\mathscr{M}\in D^b_h(\mathscr{D}_X)$.
    \item[(\rmnum{2})] There exists a decreasing sequence
    \[X=X_0\supset X_1\supset\cdots\supset X_m\supset\emp\]
    of closed subsets of $X$ such that $X_k\setminus X_{k+1}$ is smooth and the cohomology sheaves $H^p(i_k^!(\mathscr{M}))$ are integrable connections, where $i_k:X_k\setminus X_{k+1}\to X$ is the canonical inclusion.
    \item[(\rmnum{3})] For any $x\in X$, the cohomology groups $H^p(i_x^!(\mathscr{M}))$ are finite dimensional over $\C$, where $i_x:\{x\}\to X$ is the canonical inclusion.
\end{enumerate}
\end{theorem}

\subsection{Minimal extensions}
A non-zero coherent $D$-module $\mathscr{M}$ is called simple if it contains no coherent $D$-submodules other than $\mathscr{M}$ or $0$. \cref{D-module homolomic category prop} implies that for any holonomic $D$-module $\mathscr{M}$ there exists a finite sequence
\[\mathscr{M}=\mathscr{M}_0\supset\mathscr{M}_1\supset\cdots\supset \mathscr{M}_n\supset 0\]
of holonomic $D$-submodules such that $\mathscr{M}_i/\mathscr{M}_{i+1}$ is simple for each $i$ (Jordan-H\"older series of $\mathscr{M}$). In this subsection, we will give a classification of simple holonomic $D$-modules. More precisely, we will construct simple holonomic $D$-modules from integrable connections on locally closed smooth subvarieties using functors introduced in earlier sections, and show that any simple holonomic $D$-module is of this type. This construction corresponds via the Riemann-Hilbert correspondence to the minimal extension (Deligne-Goresky-MacPherson extension) in the category of perverse sheaves.\par
Let $Y$ be a (locally closed) smooth subvariety of a smooth algebraic variety $X$. Assume that the inclusion map $i:Y\to X$ is affine. Then $\mathscr{D}_{X\leftarrow Y}$ is locally free over $\mathscr{D}_Y$ and $Ri_*=i_*$ (higher cohomology groups vanish). Therefore, for a holonomic $\mathscr{D}_Y$-module $\mathscr{M}$ we have $H^j(i_+(\mathscr{M}))=H^j(i_!(\mathscr{M}))=0$ for $j\neq 0$. Namely, we may regard $i_+(\mathscr{M})$ and $i_!(\mathscr{M})$ as $\mathscr{D}_X$-modules. These $\mathscr{D}_X$-modules are holonomic by \cref{D-module direct and inverse image of holonomic module prop} and \cref{D-module holonomic duality preserve}. By \cref{D-module holonomic morphism f_! to f_+} we have a morphism $i_!(\mathscr{M})\to i_+(\mathscr{M})$ in $\Mod_h(\mathscr{D}_X)$, whose image $L(Y,\mathscr{M})$ is called the \textbf{minimal extension} of $\mathscr{M}$. By \cref{D-module homolomic category prop}, $L(Y,\mathscr{M})$ is a holonomic $\mathscr{D}_X$-module.

\begin{theorem}\label{D-module holonomic simple module char by minimal extension}
Let $X$ be a smooth algebraic variety.
\begin{enumerate}
    \item[(a)] Let $Y$ be a locally closed smooth connected subvariety of $X$ such that $i:Y\to X$ is affine, and $\mathscr{M}$ be a simple holonomic $\mathscr{D}_Y$-module. Then the minimal extension $L(Y,\mathscr{M})$ is also simple, and it is characterized as the unique simple submodule (resp. unique simple quotient module) of $i_+(\mathscr{M}$) (resp. of $i_!(\mathscr{M})$).
    \item[(b)] Any simple holonomic $\mathscr{D}_X$-module is isomorphic to the minimal extension $L(Y,\mathscr{M})$ for some pair $(Y,\mathscr{M})$, where $Y$ is as in (a) and $\mathscr{M}$ is a simple integrable connection on $Y$.
    \item[(c)] Let $(Y,\mathscr{M})$ and $(Y',\mathscr{M}')$ be pairs as in (a). Then $L(Y,\mathscr{M})\cong L(Y',\mathscr{M}')$ if and only if $\widebar{Y}=\widebar{Y}'$ and $\mathscr{M}|_U\cong\mathscr{M}'|_{U}$ for an open dense subset $U$ of $Y\cap Y'$.
\end{enumerate}
\end{theorem}

\begin{proposition}\label{D-module holonomic minimal extension commutes with dual}
Let $Y$ be a locally closed smooth subvariety of $X$ such that $i:Y\to X$ is affine, and let $\mathscr{M}$ be an integrable connection on $Y$. Then we have
\[D_X(L(Y,\mathscr{M}))\cong L(Y,D_Y(\mathscr{M})).\]
\end{proposition}
\begin{proof}
By the exactness of the duality functor, we have
\begin{align*}
D_X(L(Y,\mathscr{M}))&\cong\im(D_X(i_+(\mathscr{M}))\to D_X(i_!(\mathscr{M})))\cong\im(i_!(D_Y(\mathscr{M}))\to i_+(D_Y(\mathscr{M})))\\
&=L(Y,D_Y(\mathscr{M})),
\end{align*}
which proves the claim.
\end{proof}

\section{Analytic \texorpdfstring{$D$}{D}-modules and the de Rham functor}
\subsection{Analytic \texorpdfstring{$D$}{D}-modules}
In the algebraic case holonomicity is preserved under the inverse and direct images; however, in our analytic situation this is true for inverse images but not for general direct images.

\begin{theorem}\label{D-module analytic holonomic inverse image}
Let $f:X\to Y$ be a morphism of complex manifolds, and $\mathscr{M}$ be a holonomic $\mathscr{D}_Y$-module. Then we have $Lf^*(\mathscr{M})\in D^b_h(\mathscr{D}_X)$.
\end{theorem}

\begin{theorem}\label{D-module analytic holonomic direct image under proper}
Let $f:X\to Y$ be a proper morphism of complex manifolds. Assume that a holonomic $\mathscr{D}_X$-module $\mathscr{M}$ admits a good filtration locally on $Y$. Then we have $f_+(\mathscr{M})\in D^b_h(\mathscr{D}_Y)$.
\end{theorem}

\cref{D-module analytic holonomic inverse image} is proved using the theory of b-functions (see Kashiwara [Kas7]), and \cref{D-module analytic holonomic direct image under proper} can be proved using $\Ch(f_+(\mathscr{M}))=\varpi_f\rho_f^{-1}(\Ch(\mathscr{M}))$ and some results from symplectic geometry. We note that in both theorems if we only consider the situation where $f$ comes from a morphism of smooth algebraic varieties and $\mathscr{M}$ is associated to an algebraic holonomic $D$-module, then they are consequences of the corresponding facts on algebraic $D$-modules.

\begin{example}
Let us give an example so that the holonomicity is not preserved by the direct image with respect to a non-proper morphism of complex manifolds even if it comes from a morphism of smooth algebraic varieties. Set $X=\C\setminus\{0\}$, $Y=\C$ and let $x$ be the canonical coordinate of $Y=\C$. Let $j:X\to Y$ be the embedding, which is regarded as a morphism of algebraic varieties. If we regard it as a morphism of complex manifolds, we denote it by $j^{\an}:X^{\an}\to Y^{\an}$. Then we have
\[H^0(j_+(\mathscr{O}_X))=j_*(\mathscr{O}_X),\quad H^0(j^{\an}_+(\mathscr{O}_{X^{\an}}))=j^{\an}_*(\mathscr{O}_{X^{\an}}).\]
Note that $j_*(\mathscr{O}_X)=\mathscr{O}_Y[x^{-1}]$ is holonomic, while $j^{\an}_*(\mathscr{O}_{X^{\an}})$ contains non-meromorphisc functions like $e^{x^{-1}}$ and is much larger than $\mathscr{O}_{Y^{\an}}[x^{-1}]$. The $\mathscr{D}_{Y^{\an}}$-module $\mathscr{O}_{Y^{\an}}[x^{-1}]$ is holonomic, but $j^{\an}_*(\mathscr{O}_{X^{\an}})$ is not even a coherent $\mathscr{D}_{Y^{\an}}$-module.
\end{example}

\subsection{Solution complexes and de Rham functors}
Let $X$ be a compact manifold. For $\mathscr{M}\in D^b(\mathscr{D}_X)$, we set
\[DR_X(\mathscr{M}):=\Omega_X\otimes_{\mathscr{D}_X}^L\mathscr{M},\quad \Sol_X(\mathscr{M}):=R\!\sHom_{\mathscr{D}_X}(\mathscr{M},\mathscr{O}_X).\]
We call $DR_X(\mathscr{M})\in D^b(\C_X)$ (resp. $\Sol_X(\mathscr{M})\in D^(\C_X)$) the de Rham complex (resp. the solution complex) of $\mathscr{M}\in D^b(\mathscr{D}_X)$. Then $DR_X(-)$ and $\Sol_X(-)$ define functors
\[DR_X:D^b(\mathscr{D}_X)\to D^b(\C_X),\quad \Sol_X:D^b(\mathscr{D}_X)\to D^b(\C_X)^{\op}.\]
A motivation for introducing the solution complexes $\Sol_X(\mathscr{M})=R\!\sHom_{\mathscr{D}_X}(\mathscr{M},\mathscr{O}_X)$ came from the theory of linear partial differential equations. In fact, for a coherent $\mathscr{D}_X$-module $\mathscr{M}$ the sheaf $\Hom_{\mathscr{D}_X}(\mathscr{M},\mathscr{O}_X)$ (on $X$) is the sheaf of holomorphic solutions to the system of linear PDEs corresponding to $\mathscr{M}$. By (an analogue in the analytic situation of) \cref{D-module Hom of coh isomorphism by duality}, we have the following.

\begin{proposition}\label{D-module analytic DR and Sol duality relation}
For $\mathscr{M}\in D^b_{\coh}(\mathscr{D}_X)$ we have
\[DR_X(\mathscr{M})\cong R\!\sHom_{\mathscr{D}_X}(\mathscr{O}_X,\mathscr{M})[d_X]\cong \Sol_X(D_X(\mathscr{M}))[d_X].\]
\end{proposition}

Hence properties of $\Sol_X$ can be deduced from those of $DR_X$. The functor $DR_X$ has the advantage that it can be computed using a resolution of the right $D_X$-module $\Omega_X$. In fact, similar to \cref{D-module resolution of Omega_X and O_X} we have a locally free resolution
\[\begin{tikzcd}
0\ar[r]&\Omega_X^0\otimes_{\mathscr{O}_X}\mathscr{D}_X\ar[r]&\cdots\ar[r]&\Omega_X^{d_X}\otimes_{\mathscr{O}_X}\mathscr{D}_X\ar[r]&\Omega_X\ar[r]&0
\end{tikzcd}\]
of the right $\mathscr{D}_X$-module $\Omega_X$. It follows that for $\mathscr{M}\in\Mod(\mathscr{D}_X)$ the object $DR_X(\mathscr{M})[-d_X]$ of the derived category is represented by the complex
\[\Omega_X^\bullet\otimes_{\mathscr{O}_X}\mathscr{M}=\big[\Omega_X^0\otimes_{\mathscr{O}_X}\mathscr{M}\to\cdots\to \Omega_X^{d_X}\otimes_{\mathscr{O}_X}\mathscr{M}\big]\]
where the differential $d^p:\Omega_X^p\otimes_{\mathscr{O}_X}\mathscr{M}\to\Omega_X^{p+1}\otimes_{\mathscr{O}_X}\mathscr{M}$ is given by
\[d^p(\omega\otimes s)=d\omega\otimes s+\sum_idx_i\wedge\omega\otimes\partial_is,\quad \omega\in\Omega_X^p,s\in\mathscr{M}\]
where $\{x_i,\partial_i\}$ is a local coordinate system of $X$.\par
Let us consider the case where $\mathscr{M}$ is an integrable connection of rank $r$ (a coherent $\mathscr{D}_X$-module which is locally free of rank $r$ over $\mathscr{O}_X$). In this case the $0$-th cohomology sheaf $\mathscr{L}:=H^0(\Omega_X^\bullet\otimes_{\mathscr{O}_X}\mathscr{M})\cong\sHom_{\mathscr{D}_X}(\mathscr{O}_X,\mathscr{M})$ of $\Omega_X^\bullet\otimes_{\mathscr{O}_X}\mathscr{M}$ coincides with the kernel of the sheaf homomorphism
\[d^0=\nabla:\mathscr{M}\cong\Omega_X^0\otimes_{\mathscr{O}_X}\mathscr{M}\to\Omega_X^1\otimes_{\mathscr{O}_X}\mathscr{M}\]
which is the sheaf
\[\mathscr{M}^\nabla=\{s\in\mathscr{M}:\nabla s=0\}=\{s\in\mathscr{M}:\Theta_Xs=0\}\]
of horizontal sections of the integrable connection $\mathscr{M}$. It is a locally free $\C_X$-module of rank $r$ by the classical Frobenius theorem.\par
A locally free $\C_X$-module of finite rank is often called a \textbf{local system} on $X$. We denote by $\Loc(X)$ the category of local systems on $X$. Using the local system $\mathscr{L}=\mathscr{M}^\nabla$, we have a $\mathscr{D}_X$-linear isomorphism $\mathscr{O}_X\otimes_{\C_X}\mathscr{L}\cong\mathscr{M}$. Conversely, for a local system $\mathscr{L}$ we can define an integrable connection $\mathscr{M}$ by $\mathscr{M}=\mathscr{O}_X\otimes_{\C_X}\mathscr{L}$ and 
\[\nabla=d\otimes\id_\mathscr{L}:\mathscr{O}_X\otimes_{\C_X}\mathscr{L}\cong\Omega_X^0\otimes_{\mathscr{O}_X}\mathscr{M}\to\Omega_X^1\otimes_{\C_X}\mathscr{L}\cong\Omega_X^1\otimes_{\mathscr{O}_X}\mathscr{M}\]
such that $\mathscr{M}^\nabla=\mathscr{L}$. As a result, the category of integrable connections on $X$ is equivalent to that of local systems on $X$.\par
Under the identification $\mathscr{O}_X\otimes_{\C_X}\mathscr{L}\cong\mathscr{M}$, the differentials in the complex $\Omega_X^\bullet\otimes_{\mathscr{O}_X}\mathscr{M}$ are written explicitly by
\[d\otimes\id_\mathscr{L}:\Omega_X^p\otimes_{\C_X}\mathscr{L}\to\Omega_X^{p+1}\otimes_{\C_X}\mathscr{L}.\]
Therefore, the higher cohomology groups $H^i(\Omega_X^\bullet\otimes_{\mathscr{O}_X}\mathscr{M})$ of the complex $\Omega_X^\bullet\otimes_{\mathscr{O}_X}\mathscr{M}$ vanish by the holomorphic Poincar\'e lemma, and we get finally a quasi-isomorphism $\Omega_X^\bullet\otimes_{\mathscr{O}_X}\mathscr{M}\cong\mathscr{L}=\mathscr{M}^\nabla$ for an integrable connection $\mathscr{M}$. We have therefore proved the following theorem.

\begin{theorem}\label{D-module analytic integral connection and local system}
Let $\mathscr{M}$ be an integrable connection of rank $r$ on a complex manifold $X$. Then $DR_X(\mathscr{M})$ is concentrated at degree $-d_X$ and $H^{-d_X}(DR_X(\mathscr{M}))$ is a local system on $X$. Moreover, we have an equivalence
\[H^{-d_X}(DR_X(-)):\Conn(X)\stackrel{\sim}{\to} \Loc(X)\]
of categories.
\end{theorem}

We also note the following relation of $DR_X$ and the higher direct image functor.
\begin{theorem}\label{D-module analytic DR_X and higher direct image}
Let $f:X\to Y$ be a morphism of complex manifolds. For $\mathscr{M}\in D^b(\mathscr{D}_X)$ we have an isomorphism in $D^b(\C_Y)$:
\[Rf_*(DR_X(\mathscr{M}))\cong DR_Y(f_+(\mathscr{M})).\]
\end{theorem}
\begin{proof}
We note that $Rf_*(DR_X(\mathscr{M}))=Rf_*(\Omega_X\otimes_{\mathscr{D}_X}^L\mathscr{M})$ and
\begin{align*}
DR_Y(f_+(\mathscr{M}))&=\Omega_Y\otimes_{\mathscr{D}_Y}^LRf_*(\mathscr{D}_{Y\leftarrow X}\otimes_{\mathscr{D}_X}^L\mathscr{M})\cong Rf_*(f^{-1}(\Omega_Y)\otimes_{f^{-1}(\mathscr{D}_Y)}^L\mathscr{D}_{Y\leftarrow X}\otimes_{\mathscr{D}_X}^L\mathscr{M}).
\end{align*}
It is therefore sufficient to show that $\Omega_X\cong f^{-1}(\Omega_Y)\otimes_{f^{-1}(\mathscr{D}_Y)}^L\mathscr{D}_{Y\leftarrow X}$, which follows from the definition of $\mathscr{D}_{Y\leftarrow X}$.
\end{proof}

\subsection{Constructible sheaves}
For a morphism $f:X\to Y$ of analytic spaces we have functors
\begin{alignat*}{3}
Rf_*&:D^b(\C_X)\to D^b(\C_Y),&\quad\quad&& f^{-1}&:D^b(\C_Y)\to D^b(\C_X),\\
Rf_!&:D^b(\C_X)\to D^b(\C_Y),&\quad\quad&& f^!&:D^b(\C_Y)\to D^b(\C_X),
\end{alignat*}
where $f^!$ is right adjoint to $Rf_!$. For $\mathscr{K}\in D^b(\C_X)$ and $\mathscr{L}\in D^b(\C_Y)$, we define
\[\mathscr{K}\boxtimes_\C\mathscr{L}=\pr_1^{-1}(\mathscr{K})\otimes_{\C_{X\times Y}}\pr_2^{-1}(\mathscr{L}),\]
where $\pr_1:X\times Y\to X$ and $\pr_2:X\times Y\to Y$ are projections.\par
For an analytic space $X$, the dualizing complex of $X$ is defined by
\[\omega_X=p_X^!(\C)\in D^b(\C_X)\] 
where $p_X:X\to\pt$ is the unique morphism. If $X$ is a compact manifold, $\omega_X$ is isomorphic to $\C_X[2d_X]$. The \textbf{Verdier dual} $D_X(\mathscr{F})$ of $\mathscr{F}\in D^b(\C_X)$ is defined by
\[D_X(\mathscr{F}):=R\!\sHom_{\C_X}(\mathscr{F},\omega_X)\in D^b(\C_X)\]
and we thus obtain a functor
\[D_X:D^b(\C_X)\to D^b(\C_X)^{\op}.\]

We recall that a locally finite partition $X=\coprod_{\alpha\in A}X_\alpha$ of an analytic space $X$ by locally closed analytic subsets $X_\alpha$ is called a \textbf{stratification} of $X$ if, for any $\alpha\in A$, $X_\alpha$ is smooth (hence a complex manifold) and $\widebar{X}_\alpha=\coprod_{\beta\in B}X_\beta$ for a subset $B$ of $A$. Each complex manifold $X_\alpha$ for $\alpha\in A$ is called a \textbf{stratum} of the stratification $X=\coprod_{\alpha\in A}X_\alpha$.\par
A $\C_X$-module $\mathscr{F}$ is called a \textbf{constructible sheaf} on $X$ if there exists a stratification $X=\coprod_{\alpha\in A}X_\alpha$ of $X$ such that the restriction $F|_{X_\alpha}$ is a local system on $X_\alpha$ for each $\alpha\in A$. For an analytic space $X$, we denote by $D^b_c(X)$ the full subcategory of $D^b(\C_X)$ consisting of bounded complexes of $\C_X$-modules whose cohomology groups are constructible.

\begin{example}
On the complex plane $X=\C$ let us consider the ordinary differential equation 
\[x(\frac{d}{dx}-\lambda)u=0\]
where $\lambda\in\C$ is a constant. Denote by $\mathscr{O}_X$ the sheaf of holomorphic functions on $X$ and define a subsheaf $\mathscr{F}\sub\mathscr{O}_X$ of holomorphic solutions to this ordinary equation by
\[\mathscr{F}=\{u\in\mathscr{O}_X:(x\frac{d}{dx}-\lambda)u=0\}.\]
Then the sheaf $\mathscr{F}$ is constructible with respect to the stratification $X=(\C-\{0\})\amalg\{0\}$ of $X$. Indeed, the restriction $\mathscr{F}|_{\C-\{0\}}\cong\C x^\lambda$ is a locally free sheaf of rank one over $\C_{\C-\{0\}}$ and the stalk of $\mathscr{F}$ at $0$ is given by
\[\mathscr{F}_0=\begin{cases}
\C&\lambda=0,1,2,\dots,\\
0&\text{otherwise}.
\end{cases}\] 
\end{example}

For an algebraic variety $X$, we denote the underlying analytic space by $X^{\an}$. For a morphism $f:X\to Y$ of algebraic varieties we denote the corresponding morphism for analytic spaces by $f^{\an}:X^{\an}\to Y^{\an}$. A locally finite partition $X=\coprod_{\alpha\in A}X_\alpha$ of an algebraic variety $X$ by locally closed subvarieties $X_\alpha$ is called a stratification of $X$ if each $X_\alpha$ is smooth and $\widebar{X}_\alpha=\coprod_{\beta\in B}X_\beta$ for a subset $B$ of $A$. It is clear that a stratification $X=\coprod_{\alpha\in A}X_\alpha$ of an algebraic variety $X$ induces a stratification $X^{\an}=\coprod_{\alpha\in A}X_\alpha^{\an}$ of the corresponding analytic space $X^{\an}$.

\begin{definition}
Let $X$ be an algebraic variety. A $\C_{X^{\an}}$-module $\mathscr{F}$ is called an \textbf{algebraically constructible sheaf} if there exists a stratification $X=\coprod_{\alpha\in A}X_\alpha$ of $X$ such that $\mathscr{F}|_{X_\alpha^{\an}}$ is a locally constant sheaf on $X_\alpha^{\an}$ for each $\alpha\in A$.
\end{definition}

For an algebraic variety $X$, we denote by $D^b_c(X)$ the full subcategory of $D^b(\C_{X^{\an}})$ consisting of bounded complexes of $\C_{X^{\an}}$-modules whose cohomology groups are algebraically constructible (note that $D^b_c(X)$ is not a subcategory of $D^b(\C_X)$ but of $D^b(\C_{X^{\an}})$). We write $\omega_{X^{\an}}$ and $D_{X^{\an}}$ simply as $\omega_X$ and $D_X$. For a morphism $f:X\to Y$ of algebraic varieties, we write $(f^{\an})^{-1}$, $(f^{\an})^!$, $Rf_*^{\an}$, $Rf_!^{\an}$ as $f^{-1}$, $f^!$, $Rf_*$, $Rf_!$, respectively.

\begin{theorem}\label{sheaf on LHS constructible sheaf functor prop}
Let $X$ be an algebraic variety or an analytic space.
\begin{enumerate}
    \item[(a)] We have $\omega_X\in D^b_c(X)$ and the functor $D_X$ preserves the category $D^b_c(X)$ and $D_X\circ D_X\cong\id$ on $D^b_c(X)$.
    \item[(b)] Let $f:X\to Y$ be a morphism of algebraic varieties or analytic spaces. Then $f^{-1}$ and $f^!$ induces functors $D^b_c(Y)\to D^b_c(X)$ and we have $f^!=D_X\circ f^{-1}\circ D_Y$ on $D^b_c(Y)$.
    \item[(c)] Let $f:X\to Y$ be a morphism of algebraic varieties or analytic spaces, where we assume that $f$ is proper in the case where $f$ is a morphism of analytic spaces. Then $Rf_*$ and $Rf_!$ induce functors $D^b_c(X)\to D^b_c(Y)$, and we have $Rf_!=D_Y\circ Rf_*\circ D_X$ on $D^b_c(X)$.
    \item[(d)] The functor $(-)\otimes_\C(-)$ induces
    \[(-)\otimes_\C(-):D^b_c(X)\times D^b_c(X)\to D^b_c(X).\] 
\end{enumerate}
\end{theorem}

We also recall that an object $\mathscr{F}\in D^b_c(X)$ is called a perverse sheaf if we have
\[\dim(\supp(H^i(\mathscr{F})))\leq -i,\quad \dim(\supp(H^i(D_X(\mathscr{F}))))\leq -i\]
for any $i\in\Z$. We denote by $\Perv(\C_X)$ the full subcategory of $D^b_c(X)$ consisting of perverse sheaves.

\subsection{Kashiwara's constructibility theorem}
We now prove some basic properties of holomorphic solutions to holonomic $D$-modules. If $\mathscr{M}$ is a holonomic $\mathscr{D}_X$-module on a complex manifold $X$, its holomorphic solution complex $\Sol_X(\mathscr{M})=R\!\sHom_{\mathscr{D}_X}(\mathscr{M},\mathscr{O}_X)$ possesses very rigid structures. Namely, all the cohomology groups of $\Sol_X(\mathscr{M})$ are constructible sheaves on $X$, so we have $\Sol_X(\mathscr{M})\in D^b_c(X)$. This is the famous constructibility theorem due to Kashiwara. In particular, we obtain
\[\dim(H^i(\Sol_X(\mathscr{M}))_x)<+\infty\]
for every $i\in\Z$ and $x\in X$. Moreover, in his Ph.D. thesis [Kas3], Kashiwara essentially proved that $\Sol_X(\mathscr{M})[d_X]$ satisfies the conditions of perverse sheaves, although the theory of perverse sheaves did not exist at that time. Let us give a typical example. Let $Y$ be a complex submanifold of $X$ with codimension $d=d_X-d_Y$. Then for the holonomic $\mathscr{D}_X$-module $\mathscr{M}=\mathscr{B}_{Y|X}$, the complex
\[\Sol_X(\mathscr{M})[d_X]\cong(\C_Y[-d])[d_X]=\C_Y[d_Y]\]
is a perverse sheaf on $X$. Before giving the proof of Kashiwara's results, let us recall the following fact. It was shown by Kashiwara that for any holonomic $\mathscr{D}_X$-module there exists a Whitney stratification $X=\coprod_{\alpha\in A}X_\alpha$ of $X$ such that $\Ch(\mathscr{M})\sub\coprod_{\alpha\in A}T_{X_\alpha}^*X$. This follows from the geometric fact that $\Ch(\mathscr{M})$ is a $\C^\times$-invariant Lagrangian analytic subset of $T^*X$. Let us fix such a stratification for a holonomic system $\mathscr{M}$.

\begin{proposition}\label{D-module holonomic locally constant on Whitney stratification}
Let $\mathscr{F}=R\!\sHom_{\mathscr{D}_X}(\mathscr{M},\mathscr{O}_X)\in D^b(\C_X)$. Then $H^i(\mathscr{F})|_{X_\alpha}$ is a locally constant sheaf on $X_\alpha$ for any $i\in\Z$ and $\alpha\in A$.
\end{proposition}

\begin{proposition}\label{D-module holonomic RHom by O_X stalk finite dimensional}
Let $\mathscr{M}$ be a holonomic $\mathscr{D}_X$-module. Then for each $i\in\Z$ and $x\in X$, the stalk $H^i(R\!\sHom_{\mathscr{D}_X}(\mathscr{M},\mathscr{O}_X)_x)$ at $x$ is a finite-dimensional vector space over $\C$.
\end{proposition}

By \cref{D-module analytic DR and Sol duality relation}, \cref{D-module holonomic locally constant on Whitney stratification} and \cref{D-module holonomic RHom by O_X stalk finite dimensional}, we obtain Kashiwara's constructibility theorem:

\begin{theorem}\label{D-module holonomic constructiblity}
Let $\mathscr{M}$ be a holonomic $\mathscr{D}_X$-module over a complex manifold $X$. Then $\Sol_X(\mathscr{M})=R\!\sHom_{\mathscr{D}_X}(\mathscr{M},\mathscr{O}_X)$ and $DR_X(\mathscr{M})=\Omega_X\otimes_{\mathscr{D}_X}^L\mathscr{M}$ are objects of $D^b_c(X)$.
\end{theorem}

\begin{corollary}\label{D-module holonomic dual of DR_X and Sol_X char}
Let $\mathscr{M}$ be a holonomic $\mathscr{D}_X$-module and $D_X(\mathscr{M})$ its dual. Then we have isomorphisms
\[D_X(DR_X(\mathscr{M}))\cong DR_X(D_X(\mathscr{M})),\quad D_X(\Sol_X(\mathscr{M})[d_X])\cong \Sol_X(D_X(\mathscr{M}))[d_X].\]
\end{corollary}

\begin{theorem}\label{D-module holonomic DR_X and Sol_X perverse}
Let $X$ be a complex manifold and $\mathscr{M}$ a holonomic $\mathscr{D}_X$-module. Then $\Sol_X(\mathscr{M})[d_X]$ and $DR_X(\mathscr{M})$ are perverse sheaves on $X$.
\end{theorem}
\begin{proof}
By $DR_X(\mathscr{M})\cong\Sol_X(D_X(\mathscr{M}))[d_X]$, it is sufficient to prove that $\mathscr{F}=\Sol_X(\mathscr{M})[d_X]$ is a perverse sheaf for any holonomic $\mathscr{D}_X$-module $\mathscr{M}$. Moreover, we have $D_X(\Sol_X(\mathscr{M})[d_X])\cong\Sol_X(D_X(\mathscr{M}))[d_X]$ by \cref{D-module holonomic dual of DR_X and Sol_X char}, so it suffices to prove that $\dim(\supp(H^i(\mathscr{F})))\leq -i$ for $i\in\Z$. We take a Whitney stratification $X=\coprod_{\alpha\in A}X_\alpha$ of $X$ such that $\Ch(\mathscr{M})\sub\coprod_{\alpha\in A}T^*_{X_\alpha}X$ and let $i_\alpha:X_\alpha\hookrightarrow X$ for $\alpha\in A$. Then by \cref{D-module holonomic locally constant on Whitney stratification}, the complex $i_\alpha^{-1}(\mathscr{F})$ has locally constant cohomology groups for $\alpha\in A$. For $i\in\Z$, set $Z=\supp(H^i(\mathscr{F}))$, then $Z$ is a union of connected components of strata $X_\alpha$'s and we need to prove that $\dim(Z)=d_Z\leq-i$. Choose a smooth point $z$ of $Z$ contained in a stratum $X_\alpha$ such that $\dim(X_\alpha)=\dim(Z)$ and take a germ of complex submanifold $Y$ of $X$ at $z$ which intersects with $Z$ transversally at $z\in Z$ ($\dim(Y)=d_Y=d_X-d_Z$). We can choose the pair $(z,Y)$ so that $Y$ is non-characteristic for $\mathscr{M}$, because we have the estimate $\Ch(\mathscr{M})\sub\coprod_{\alpha\in A}T^*_{X_\alpha}X$. Therefore, by the Cauchy-Kowalevski-Kashiwara theorem, we obtain
\[\mathscr{F}|_Y=R\!\sHom_{\mathscr{D}_X}(\mathscr{M},\mathscr{O}_X)|_Y[d_X]\cong R\!\sHom_{\mathscr{D}_Y}(\mathscr{M}_Y,\mathscr{O}_Y)[d_X].\]
Our assumption $H^i(\mathscr{F})_z\neq 0$ implies that $\sExt_{\mathscr{D}_Y}^{i+d_X}(\mathscr{M}_Y,\mathscr{O}_Y)_z\neq 0$. On the other hand, by \cref{D-module global dimension of stalk n} and
\[R\!\sHom_{\mathscr{D}_Y}(\mathscr{M}_Y,\mathscr{O}_Y)\cong R\!\sHom_{\mathscr{D}_Y}(\mathscr{M}_Y,\mathscr{D}_Y)\otimes_{\mathscr{D}_Y}^L\mathscr{O}_Y,\]
we have $\sExt_{\mathscr{D}_Y}^i(\mathscr{M}_Y,\mathscr{O}_Y)=0$ for $i>d_Y$. We then conclude that $i+d_X\leq d_Y$, which means $d_Z=d_X-d_Y\leq -i$ and this completes the proof.
\end{proof}

\section{Meromorphic connections}
\subsection{Meromorphic connections in the one-dimensional case}
\paragraph{Systems of ODEs and meromorphic connections}\label{D-module mero conn over C paragraph}
We start from the classical theory of ordinary differential equations (ODEs for short). We always consider the problem in an open neighborhood of $x=0\in\C$. Here the complex plane $\C$ is considered as a complex manifold and we use only the classical topology. Set $\mathscr{O}=\mathscr{O}_{\C,0}$ and denote by $K$ its quotient field. Then $K$ is the field of meromorphic functions with possible poles at $x=0$. Note that $\mathscr{O}$ and $K$ are identified with the ring of convergent power series $\C\{\!\{x\}\!\}$ at $x=0$ and its quotient field $\C\{\!\{x\}\!\}[x^{-1}]$, respectively.\par
For a matrix $A(x)=(a_{ij}(x))\in\mathcal{M}_n(K)$, let us consider the system of ODEs
\begin{equation}\label{D-modle meromorphic connection over C ODE}
\frac{d}{dx}u(x)=A(x)u(x)
\end{equation}
where $u(x)=(u_1(x),\dots,u_n(x))^t$ is a column vector of unknown functions. Setting $v(x)=T^{-1}u(x)$ for an invertible matrix $T=T(x)\in\GL_n(K)$, the equation (\ref{D-modle meromorphic connection over C ODE}) can be rewritten as
\[\frac{d}{dx}v(x)=\Big(T^{-1}AT-T^{-1}\frac{d}{dx}T\Big)v(x).\]
Therefore, we say that two systems
\[\frac{d}{dx}u(x)=A(x)u(x),\quad A(x)\in\mathcal{M}_n(K)\]
and 
\[\frac{d}{dx}v(x)=B(x)v(x),\quad B(x)\in\mathcal{M}_n(K)\]
are equivalent if there exists $T\in\GL_n(K)$ such that $B=T^{-1}AT-T^{-1}\frac{d}{dx}T$.\par
As solutions to (\ref{D-modle meromorphic connection over C ODE}) we consider holomorphic (possibly multivalued) solutions on a punctured disk $B_\eps^*=\{x\in\C:0<|x|<\eps\}$, where $\eps$ is a sufficiently small positive number. Namely, let $\widetilde{K}$ denote the ring consisting of possibly multivalued holomorphic functions defined on a punctured disk $B^*_\eps$ for a sufficiently small $\eps>0$. Then we say that $u(x)=(u_1(x),\dots,u_n(x))^t$ is a solution to (\ref{D-modle meromorphic connection over C ODE}) if it belongs to $\widetilde{K}^n$ and satisfies (\ref{D-modle meromorphic connection over C ODE}).\par
Let us now reformulate these classical notions by the modern language of meromorphic connections. Let $M$ be a finite-dimensional vector space over $K$ endowed with a $\C$-linear map $\nabla:M\to M$. Then $M$ (or more precisely the pair $(M,\nabla)$) is called a \textbf{meromorphic connection} (at $x=0$) if it satisfies the condition
\begin{equation}\label{D-modle meromorphic connection over C-1}
\nabla(fu)=\frac{df}{dx}u+f\nabla u,\quad f\in K,u\in M.
\end{equation}
If $(M,\nabla)$ and $(N,\nabla)$ are meromorphic connections, a $K$-linear map $\varphi:M\to N$ is called a morphism of meromorphic connections if it satisfies $\varphi\circ\nabla=\nabla\circ\varphi$. In this case we write $\varphi:(M,\nabla)\to (N,\nabla)$.
\begin{remark}
The condition (\ref{D-modle meromorphic connection over C-1}) can be replaced with the weaker one
\begin{equation}\label{D-modle meromorphic connection over C-2}
\nabla(fu)=\frac{df}{dx}u+f\nabla u,\quad f\in \mathscr{O},u\in M.
\end{equation}
Indeed, if the condition (\ref{D-modle meromorphic connection over C-2}) holds, then for $f\in\mathscr{O}-\{0\}$, $g\in\mathscr{O}$, $u\in M$, we have
\[\nabla(gu)=\nabla(ff^{-1}gu)=f'f^{-1}gu+f\nabla(f^{-1}gu)\]
and hence
\begin{align*}
\nabla(f^{-1}gu)&=-f^{-1}f'gu+f^{-1}\nabla(gu)=(-f^{-1}f'g+f^{-1}g')u+f^{-1}g\nabla u\\
&=(f^{-1}g)'u+f^{-1}g\nabla u.
\end{align*}
\end{remark}

Meromorphic connections naturally form an abelian category. Note that for a meromorphic connection $(M,\nabla)$ the vector space $M$ is a left $\mathscr{D}_{\C,0}$-module by the action $\frac{d}{dx}u=\nabla u$. Note also that $\nabla$ is uniquely extended to an element of $\End_{\C}(\widetilde{K}\otimes_KM)$ satisfying
\[\nabla(fu)=\frac{df}{dx}u+f\nabla u,\quad f\in\widetilde{K},u\in M,\]
and $\widetilde{K}\otimes_KM$ is also a left $\mathscr{D}_{\C,0}$-module. We say that $u\in\widetilde{K}\otimes_KM$ is a \textbf{horizontal section} of $(M,\nabla)$ if $\nabla u=0$.\par
Let $(M,\nabla)$ be a meromorphic connection and choose a $K$-basis $\{e_i\}_{1\leq i\leq n}$ of $M$. Then the matrix $A(x)=(a_{ij}(x))\in\mathcal{M}_n(K)$ defined by
\begin{equation}\label{D-modle meromorphic connection over C connection matrix}
\nabla e_j=-\sum_{i=1}^{n}a_{ij}(x)e_i
\end{equation}
is called the connection matrix of $(M,\nabla)$ with respect to the basis $\{e_i\}_{1\leq i\leq n}$. In terms of this basis the action of $\nabla$ is described by
\[\nabla\Big(\sum_{i=1}^{n}u_ie_i\Big)=\sum_{i=1}^{n}\Big(\frac{du_i}{dx}-\sum_{j=1}^{n}a_{ij}u_j\Big)e_i.\]
Hence the condition $\nabla u=0$ for $u=\sum_{i=1}^{n}u_ie_i\in\widetilde{K}\otimes_KM$ is equivalent to the equation
\begin{equation}\label{D-modle meromorphic connection over C horizontal codintion}
\frac{d}{dx}u(x)=A(x)u(x)
\end{equation}
for $u(x)=(u_1(x),\dots,u_n(x))\in\widetilde{K}^n$. We have seen that to each meromorphic connection $(M,\nabla)$ endowed with a $K$-basis $\{e_i\}_{1\leq i\leq n}$ of $M$ we can associate a system (\ref{D-modle meromorphic connection over C horizontal codintion}) of ODEs and that the horizontal sections of $(M,\nabla)$ correspond to solutions of (\ref{D-modle meromorphic connection over C horizontal codintion}). Conversely, to any $A=(a_{ij}(x))\in\mathcal{M}_n(K)$ we can associate a meromorphic connection $(M_A,\nabla_A)$ given by 
\[M_A=\bigoplus_{i=1}^{n}Ke_i,\quad \nabla e_j=-\sum_{i=1}^{n}a_{ij}(x)e_i.\]
Under this correspondence we easily see the following.

\begin{lemma}\label{D-modle meromorphic connection over C isomorphic iff}
Two systems of ODEs
\[\frac{d}{dx}u(x)=A(x)u(x),\quad A(x)\in\mathcal{M}_n(K)\]
and 
\[\frac{d}{dx}v(x)=B(x)v(x),\quad B(x)\in\mathcal{M}_n(K)\]
and equivalent if and only if the associated meromorphic connections $(M_A,\nabla_A)$ and $(M_B,\nabla_B)$ are isomorphic.
\end{lemma}

Let $(M,\nabla)$ and $(N,\nabla)$ be meromorphic connections. Then $M\otimes_KN$ and $\Hom_K(M,N)$ are endowed with structures of meromorphic connections by
\begin{align*}
\nabla(u\otimes v)=\nabla u\otimes v+u\otimes\nabla v,\quad (\nabla\phi)u=\nabla(\phi(u))-\phi(\nabla u)
\end{align*}
where $\phi\in\Hom_K(M,N)$, $u\in M$, $v\in N$. Note that the one-dimensional $K$-module $K$ is naturally endowed with a structure of a meromorphic connection by $\nabla f=\frac{df}{dx}$. In particular, for a meromorphic connection $(M,\nabla)$, the dual space $M^*=\Hom_K(M,K)$ is endowed with a structure of meromorphic connection by
\[\langle\nabla\phi,u\rangle=\frac{d}{dx}\langle\phi,u\rangle-\langle\phi,\nabla u\rangle,\quad \phi\in M^*,u\in M.\]
If $A=(a_{ij}(x))\in\mathcal{M}_n(K)$ is the connection matrix of $M$ with respect to a $K$-basis $\{e_i\}_{1\leq i\leq n}$ of $M$, then the connection matrix $A^*$ of $M^*$ with respect to the dual basis $\{e_i^*\}_{1\leq i\leq n}$ is given by $A^*=-A^t$.

\paragraph{Meromorphic connections with regular singularities}\label{D-module mero conn over C regularity paragraph}
For an open interval $(a,b)\sub\R$ and $\eps>0$ we set
\[S^\eps_{(a,b)}=\{x:0<|x|<\eps,\arg(x)\in(a,b)\}.\]
This is a subset of (the universal covering of) $\C\setminus\{0\}$, called an \textbf{open angular sector}. A function $f\in\widetilde{K}$ is said to have \textbf{moderate growth} (or to be in the \textbf{Nilsson class}) at $x=0$ if it satisfies the following condition: For any open interval $(a,b)\sub\R$ and $\eps>0$ such that $f$ is defined on $S^\eps_{(a,b)}$, there exist constants $C>0$ and $N\gg 0$ such that $|f(x)|\leq C|x|^{-N}$ for $x\in S^\eps_{(a,b)}$. We denote by $\widetilde{K}^{mod}$ the set of $f\in\widetilde{K}$ which have moderate growth at $x=0$. Note that in the case where $f$ is single-valued $f$ has moderate growth if and only if it is meromorphic.\par
Let us consider a system of ODEs:
\begin{equation}\label{D-module regular ODE n-dimension equation}
\frac{d}{dx}u(x)=A(x)u(x)
\end{equation}
for $A(x)=(a_{ij}(x))\in\mathcal{M}_n(K)$. It is well known in the theory of linear ODEs that the set of solutions $u\in\widetilde{K}^n$ to (\ref{D-module regular ODE n-dimension equation}) forms a vector space of dimension $n$ over $\C$. Let us take $n$ linearly independent solutions $u_1(x),\dots,u_n(x)$ to this equation. Then the matrix $S(x)=(u_1(x),\dots,u_n(x))$ is called a \textbf{fundamental solution matrix} of (\ref{D-module regular ODE n-dimension equation}). Since the analytic continuation of $S(x)$ along a circle around $x=0\in\C$ is again a solution matrix of (\ref{D-module regular ODE n-dimension equation}), there exists an invertible matrix $G\in\GL_n(\C)$ such that
\[\lim_{t\to 2\pi}S(e^{\i t}x)=S(x)G.\]
The matrix $G$ is called the \textbf{monodromy matrix} of the equation (\ref{D-module regular ODE n-dimension equation}). Let us take a matrix $\Gamma\in\mathcal{M}_n(\C)$ such that $\exp(2\pi\i\Gamma)=G$ and set $T(x)=S(x)\exp(-\Gamma\log(x))$. Then we can easily check that the entries of $T(x)$ are singlevalued functions. Thus we obtained a decomposition $S(x)=T(x)\exp(\Gamma\log(x))$ of $S(x)$, in which the last part $\exp(\Gamma\log(x))$ has the same monodromy as that of $S(x)$. The following well-known fact is fundamental.

\begin{theorem}\label{D-module ODE n-dimension equation regular def}
The following three conditions on the system (\ref{D-module regular ODE n-dimension equation}) are equivalent:
\begin{enumerate}
    \item[(\rmnum{1})] The system (\ref{D-module regular ODE n-dimension equation}) is equivalent to the system
    \[\frac{d}{dx}v(x)=\frac{\Gamma(x)}{x}v(x)\]
    for some $\Gamma(x)\in\mathcal{M}_n(\mathscr{O})$.
    \item[(\rmnum{2})] The system (\ref{D-module regular ODE n-dimension equation}) is equivalent to the system
    \[\frac{d}{dx}v(x)=\frac{\Gamma}{x}v(x)\]
    for some $\Gamma\in\mathcal{M}_n(\C)$.
    \item[(\rmnum{3})] All solutions to (\ref{D-module regular ODE n-dimension equation}) in $\widetilde{K}^n$ belong to $(\widetilde{K}^{mod})^n$.
\end{enumerate}
\end{theorem}
\begin{proof}

\end{proof}

On a neighborhood of $x=0$ in $\C$ consider an ordinary differential equation
\begin{equation}\label{D-module regular ODE n-order equation}
P(x,\partial)u=0,\quad P(x,\partial)=\sum_{i=0}^{n}a_i(x)\partial^i,\quad \partial=\frac{d}{dx}
\end{equation}
where $a_i(x)$ is holomorphic on a neighborhood of $x=0$ and $a_n(x)$ is not identically zero (i.e., the order of $P(x,\partial)$ is $n$). We can rewrite $P$ in the form
\[P(x,\partial)=\sum_{i=0}^{n}b_i(x)\theta^i,\quad b_i(x)\in K\]
with $b_n(x)=0$ and $\theta=x\partial$. Recall the following classical result.
\begin{theorem}[Fuchs, 1866]\label{D-module ODE n-order regular def}
For $P$ as above the following conditions are equivalent:
\begin{enumerate}
    \item[(\rmnum{1})] All solutions of (\ref{D-module regular ODE n-order equation}) belong to $\widetilde{K}^{mod}$.
    \item[(\rmnum{2})] We have $\ord_0(a_i/a_n)\geq-(n-i)$ for $0\leq i\leq n$.
    \item[(\rmnum{3})] $b_i/b_n$ are holomorphic for $0\leq i\leq n$.
\end{enumerate}
\end{theorem}

We say that a meromorphic connection $(M,\nabla)$ at $x=0$ is regular if there exists a finitely generated $\mathscr{O}$-submodule $L\sub M$ which is stable by the action of $\theta=x\nabla$ and generates $M$ over $K$. We call such an $\mathscr{O}$-submodule $L$ an \textbf{$\mathscr{O}$-lattice} of $(M,\nabla)$.

\begin{lemma}\label{D-module regular meromorphic connection O-lattice free}
Let $(M,\nabla)$ be a regular meromorphic connection. Then any $\mathscr{O}$-lattice $L$ of $(M,\nabla)$ is a free $\mathscr{O}$-module of rank $\dim_K(M)$.
\end{lemma}
\begin{proof}
Since $L$ is a torsion free finitely generated module over the principal ideal domain $\mathscr{O}$, it is free of finite-rank. Hence it is sufficient to show that the canonical homomorphism $K\otimes_\mathscr{O}L\to M$ is an isomorphism. The surjectivity is clear; to show the injectivity take a free basis $\{e_i\}_{1\leq i\leq n}$ of $L$. It is sufficient to show that $\{e_i\}_{1\leq i\leq n}$ is linearly independent over $K$. Assume $\sum_{i=1}^{n}f_ie_i=0$ for $f_i\in K$. For $N\gg 0$ we have $a_i:=x^Nf_i\in\mathscr{O}$ for any $i=1,\dots,n$. Then from $\sum_{i=1}^{n}a_ie_i=0$ we obtain $a_i=0$, and hence $f_i=0$.
\end{proof}

By this lemma and the invariance of $\mathscr{O}$-lattices under $\theta=x\nabla$, we easily see that a meromorphic connection $(M,\nabla)$ is regular if and only if there exists a $K$-basis $\{e_i\}_{1\leq i\leq n}$ of $M$ such that the associated system of ODEs is of the form
\[\frac{d}{dx}u(x)=\frac{\Gamma(x)}{x}u(x),\quad \Gamma(x)\in\mathcal{M}_n(\mathscr{O}).\]

\begin{proposition}\label{D-module mero conn over C regular iff}
For a meromorphic connection $(M,\nabla)$ at $x=0$, the following three conditions are equivalent:
\begin{enumerate}
    \item[(\rmnum{1})] $(M,\nabla)$ is regular.
    \item[(\rmnum{2})] All the horizontal sections of $(M,\nabla)$ belong to $\widetilde{K}^{mod}\otimes_KM$.
    \item[(\rmnum{3})] For any $u\in M$ there exists a finitely generated $\mathscr{O}$-submodule $L$ of $M$ such that $u\in L$ and $\theta L\sub L$, i.e., $M$ is a union of $\theta$-stable finitely generated $\mathscr{O}$-submodules.
    \item[(\rmnum{4})] For any $u\in M$ there exists a polynomial $F(t)\in\mathscr{O}[t]$ such that $F(\theta)u=0$.
\end{enumerate}
\end{proposition}
\begin{proof}
We have remarked the equivalence of (\rmnum{1}) and (\rmnum{2}) from \cref{D-module ODE n-dimension equation regular def}. Also, if $(M,\nabla)$ is regular and $L$ is an $\mathscr{O}$-lattice, then $M=\bigcup_{n\geq 0}x^{-n}L$ and each $x^{-n}L$ is a $\theta$-stable finitely generated $\mathscr{O}$-submodule of $M$, whence (\rmnum{3}). Conversely, if (\rmnum{3}) is satisfied, then by taking a $K$-basis $\{e_1,\dots,e_n\}$ of $M$ and choose a family of $\theta$-stable finitely generated $\mathscr{O}$-submodule $L_i$ of $M$ such that $e_i\in L_i$, we see that the sum $L=\sum_{i=1}^{n}L_i\sub M$ is an $\mathscr{O}$-lattice of $(M,\nabla)$.\par
Finally, we note that if (\rmnum{3}) is true, then for each $u\in M$ we can take a $\theta$-stable finitely generated $\mathscr{O}$-submodule $L\sub M$ such that $u\in L$, and set $L_i=\mathscr{O}u+\mathscr{O}\theta u+\cdots+\mathscr{O}\theta^{i-1}u$. Then $(L_i)_{i\geq 1}$ is an increasing sequence of $\mathscr{O}$-submodules of $L$. Since $L$ is Noetherian over $\mathscr{O}$, there exists $m>0$ such that $\bigcup_{i\geq 1}L_i=L_m$. The condition $L_m=L_{m+1}$ then implies that $\theta^mu=-\sum_{i=0}^{m-1}a_{m-i}\theta^iu$ for some $a_i\in\mathscr{O}$, whence the assertion of (\rmnum{4}). Conversely, if (\rmnum{4}) is satisfied and $F(t)=t^m+a_1t^{m-1}+\cdots+a_m$, then $L=\mathscr{O}u+\mathscr{O}\theta u+\cdots+\mathscr{O}\theta^{m-1}u$ is a $\theta$-stable finitely generated $\mathscr{O}$-submodule such that $u\in L$.
\end{proof}

\begin{proposition}\label{D-module mero conn over C regular and exact sequence}
Let $0\to (M',\nabla)\to (M,\nabla)\to (M'',\nabla)\to 0$ be an exact sequence of meromorphic connections. Then $(M,\nabla)$ is regular if and only if $(M',\nabla)$ and $(M'',\nabla)$ are regular.
\end{proposition}
\begin{proof}
By the condition (\rmnum{4}) of \cref{D-module mero conn over C regular iff}, $(M',\nabla)$ and $(M'',\nabla)$ are regular if $(M,\nabla)$ is regular. Let us prove the converse. For $u\in M$ there exist $m\geq 0$ and $F(t)\in\mathscr{O}[t]$ such that
\[F(\theta)u\in M'\]
by the regularity of $(M'',\nabla)$. Also by the regularity of $(M',\nabla)$, there exists $G(t)\in\mathscr{O}[t]$ such that
\[G(\theta)F(\theta)u=0.\]
It then follows from \cref{D-module mero conn over C regular iff} that $(M,\nabla)$ is regular.
\end{proof}

\begin{proposition}\label{D-module mero conn over C regular Hom and tensor}
Assume that $M$ and $N$ are regular meromorphic connections. Then $\Hom_K(M,N)$ and $M\otimes_K N$ are also regular meromorphic connections.
\end{proposition}
\begin{proof}
This can be easily checked by examining the connection matrices.
\end{proof}

\paragraph{Regularity of \texorpdfstring{$D$}{D}-modules on algebraic curves}\label{D-module mero conn on algebraic curve paragraph}
We also have the notion of meromorphic connections in the algebraic category. In the algebraic situation the ring $\mathscr{O}=\C\{\!\{x\}\!\}$ is replaced by the stalk $\mathscr{O}_{C,p}$, where $C$ is a smooth algebraic curve and $p$ is a point of $C$. We denote by $K_{C,p}$ the quotient field of $\mathscr{O}_{C,p}$. Note that $\mathscr{O}_{C,p}$ is a discrete valuation ring and hence a principal ideal domain.\par
Let $M$ be a finite dimensional $K_{C,p}$-module and
\[\nabla:M\to\Omega_{C,p}^1\otimes_{\mathscr{O}_{C,p}}M\]
be a $\C$-linear map. The pair $(M,\nabla)$ is called an \textbf{algebraic meromorphic connection} at $p\in C$ if
\[\nabla(fu)=df\otimes u+f\nabla u,\quad f\in K_{C,p},u\in M.\]
By a morphism $\varphi:(M,\nabla)\to (N,\nabla)$ of algebraic meromorphic connections at $p\in C$ we mean a $K_{C,p}$-linear map $\varphi:M\to N$ satisfying $\nabla\circ\varphi=(\id\otimes\varphi)\circ\nabla$.\par
Algebraic meromorphic connections at $p\in C$ naturally form an abelian category. Choose a local parameter $x\in\mathscr{O}_{C,p}$ at $p$ and set $\partial=\frac{d}{dx}$. Then we have $K_{C,p}=\mathscr{O}_{C,p}[x^{-1}]$. Identifying $\Omega_{C,p}^1$ with $\mathscr{O}_{C,p}$ by $\mathscr{O}_{C,p}\ni f\mapsto fdx\in\Omega_{C,p}^1$, an algebraic meromorphic connection at $p\in C$ is a finite-dimensional $K_{C,p}$-module endowed with a $\C$-linear map $\nabla:M\to M$ satisfying
\[\nabla(fu)=\frac{df}{dx}u+f\nabla u,\quad f\in K_{C,p},u\in M.\]
An algebraic meromorphic connection $(M,\nabla)$ at $p\in C$ is called \textbf{regular} if there exists a finitely generated $\mathscr{O}_{C,p}$-submodule $L$ of $M$ such that $M=K_{C,p}L$ and $x\nabla(L)\sub\Omega_{C,p}^1\otimes_{\mathscr{O}_{C,p}}L$ for some (and hence any) local parameter $x$ at $p$. We call such an $\mathscr{O}_{C,p}$-submodule $L$ an \textbf{$\mathscr{O}_{C,p}$-lattice} of $(M,\nabla)$. Algebraic meromorphic connections share some basic properties with analytic ones. For example, \cref{D-module regular meromorphic connection O-lattice free}, \cref{D-module mero conn over C regular iff} and \cref{D-module mero conn over C regular and exact sequence} remain valid also in the algebraic category.

\begin{lemma}\label{D-module mero conn over curve regular iff analytic}
Let $(M,\nabla)$ be an algebraic meromorphic connection at $p\in C$. Choose a local parameter $x$ at $p$, and denote by $(M^{\an},\nabla)$ the corresponding (analytic) meromorphic connection at $x=0$, i.e., $M^{\an}=\C\{\!\{x\}\!\}[x^{-1}]\otimes_{K_{C,p}}M$. Then $(M,\nabla)$ is regular if and only if $(M^{\an},\nabla)$ is as well.
\end{lemma}
\begin{proof}
We may identify $\Omega_{C,p}^1$ with the local parameter $x$. If $(M,\nabla)$ is regular, then we can take an $\mathscr{O}_{C,p}$-lattice $L$ of $(M,\nabla)$, and $\C\{\!\{x\}\!\}[x^{-1}]\otimes_{K_{C,p}}L$ is an $\C\{\!\{x\}\!\}$ lattice of $(M^{\an},\nabla)$, so $(M^{\an},\nabla)$ is regular.\par
Conversely, assume that $(M^{\an},\nabla)$ is regular. We take a finitely generated $\mathscr{O}_{C,p}$-submodule $L_0$ of $M$ which generates $M$ over $K_{C,p}$. By \cref{D-module mero conn over C regular iff}, $L_0$ and hence $L=\mathscr{O}_{C,p}[\theta]L_0$ must be contained in a $\theta$-stable finitely generated $\C\{\!\{x\}\!\}$-submodule, so $L^{\an}=\C\{\!\{x\}\!\}\otimes_{\mathscr{O}}L$ is also finitely generated over $\C\{\!\{x\}\!\}$. Since $\C\{\!\{x\}\!\}$ is faithfully flat over $\mathscr{O}_{C,p}$, this implies the finiteness of $L$ over $\mathscr{O}_{C,p}$, so $(M,\nabla)$ is regular.
\end{proof}

Let us globalize the above definition of regularity. Let $\mathscr{M}$ be an integrable connection on an algebraic curve $C$. Take a smooth completion $\widebar{C}$ of $C$ and denote by $j:C\hookrightarrow\widebar{C}$ the open immersion. Note that $C$ is unique up to isomorphisms because it is a curve. Let us consider the $\mathscr{D}_{\widebar{C}}$-module $j_*(\mathscr{M})$ (note that $R^ij_*(\mathscr{M})=0$ for $i\neq 0$ since $j$ is affine open immersion). Since $\mathscr{M}$ is locally free over $\mathscr{O}_C$, it is free on a non-trivial (Zariski) open subset $U=C\setminus V$ of $C$, where $V$ consists of finitely many points, hence $j_*(\mathscr{M})|_{\widebar{C}\setminus V}$ is also free over $\widebar{C}\setminus V$. In particular, $j_*(\mathscr{M})$ is locally free over $j_*(\mathscr{O}_C)$ (of finite rank). Let $p\in\widebar{C}\setminus C$, then since $j_*(\mathscr{M})_p$ is a $\mathscr{D}_{\widebar{C},p}$-module, it is naturally endowed with a structure of an algebraic meromorphic connection at $p\in C$ by $\nabla(m)=dx\otimes\partial m$, where $x$ is a local parameter at $p$ and $\partial=dx$. We call this $\mathscr{D}_{\widebar{C}}$-module $j_*(\mathscr{M})$ the \textbf{algebraic meromorphic extension} of $M$.
\begin{definition}
Let $\mathscr{M}$ be an integrable connection on a smooth algebraic curve $C$. For a boundary point $p\in\widebar{C}\setminus C$, we say that $\mathscr{M}$ has \textbf{regular singularity at $\bm{p}$} (or $p$ is a \textbf{regular singular point} of $\mathscr{M}$) if the algebraic meromorphic connection $(j_*(\mathscr{M})_p,\nabla)$ is regular. Moreover, an integrable connection $\mathscr{M}$ on $C$ is called \textbf{regular} if it has regular singularity at any boundary point $p\in\widebar{C}\setminus C$.
\end{definition}

\begin{proposition}\label{D-module integral connection on curve restriction regular}
Let $\mathscr{M}$ be an integrable connection on $C$. Then for any open subset $U$ of $C$ the restriction $\mathscr{M}|_U$ has regular singularity at any point of $C\setminus U$.
\end{proposition}
\begin{proof}
This is easily checked from the definition of regularity.
\end{proof}

\begin{proposition}\label{D-module integral connection on curve regular and exact sequence}
Let $0\to \mathscr{M}'\to \mathscr{M}\to \mathscr{M}''\to 0$ be an exact sequence of integrable connections on $C$. Then $\mathscr{M}$ is regular if and only if $\mathscr{M}'$ and $\mathscr{M}''$ are regular.
\end{proposition}
\begin{proof}
This follows easily from \cref{D-module mero conn over C regular iff} and \cref{D-module mero conn over curve regular iff analytic}.
\end{proof}

\begin{proposition}\label{D-module integral connection on curve regular tensor and Hom}
Let $\mathscr{M}$ and $\mathscr{N}$ be regular integrable connections on $C$. Then the integrable connections $\mathscr{M}\otimes_{\mathscr{O}_C}\mathscr{N}$ and $\sHom_{\mathscr{O}_C}(\mathscr{M},\mathscr{N})$ are also regular.
\end{proposition}
\begin{proof}
For $p\in\widebar{C}\setminus C$, we have
\[j_*(\mathscr{M}\otimes_{\mathscr{O}_C}\mathscr{N})_p\cong j_*(\mathscr{M})_p\otimes_{K_{C,p}}j_*(\mathscr{N})_p,\quad j_*(\sHom_{\mathscr{O}_C}(\mathscr{M},\mathscr{N}))_p\cong\Hom_{K_{C,p}}(j_*(\mathscr{M})_p,j_*(\mathscr{N})_p).\]
Hence the assertion follows from \cref{D-module mero conn over curve regular iff analytic} and \cref{D-module mero conn over C regular Hom and tensor}.
\end{proof}

\begin{proposition}\label{D-module integral connection on curve regular at open subset iff}
Let $V$ be a subset of $\widebar{C}\setminus C$ and set $C'=C\cup V$. We denote by $j:C\to C'$ the embedding. For each point $p\in V$, we fix a local parameter $x_p$ and set $\theta_p=x_p\frac{d}{dx_p}$. Then the following three conditions for an integrable connection $\mathscr{M}$ on $C$ are equivalent:
\begin{enumerate}
    \item[(\rmnum{1})] $\mathscr{M}$ has regular singularity at any $p\in V$.
    \item[(\rmnum{2})] $j_*(\mathscr{M})$ is a union of coherent $\mathscr{O}_{C'}$-submodules which are stable under the action of $\theta_p$ for any $p\in V$.
    \item[(\rmnum{3})] There exists a coherent $\mathscr{D}_{C'}$-module $\mathscr{M}'$ such that $\mathscr{M}'|_C\cong\mathscr{M}$ and $\mathscr{M}'$ is a union of coherent $\mathscr{O}_{C'}$-submodules which are stable under the action of $\theta_p$ for any $p\in V$.
\end{enumerate}
\end{proposition}
\begin{proof}
It is clear that (\rmnum{2})$\Rightarrow$(\rmnum{3}), and for $\mathscr{M}'$ as in (\rmnum{3}) we have $j_*(\mathscr{M})_p=K_{C',p}\otimes_{\mathscr{O}_{C',p}}\mathscr{M}'_p$ for $p\in V$. Therefore, \cref{D-module mero conn over C regular iff} implies that $\mathscr{M}$ has regular singulatiry at $p$. Now assume that $\mathscr{M}$ has regular singularity at any $p\in V$. For $p\in V$ we take an $\mathscr{O}_{C',p}$-lattice $L_p$ of $(j_*(\mathscr{M})_p,\nabla)$. Then $x_p^{-i}L_p$ is also an $\mathscr{O}_{C',p}$-lattice of $(j_*(\mathscr{M})_p,\nabla)$ for each integer $i\geq 1$, and we have $j_*(\mathscr{M})_p=\bigcup_ix_p^{-i}L_p$. Note that there exists an open subset $U_p$ of $C\cup\{p\}$ containing $p$ such that $x_p^{-i}L_p$ is extended to a coherent $\mathscr{O}_{U_p}$-submodule $\mathscr{L}_p^i$ of $j_*(\mathscr{M})|_{U_p}$ satisfying $\mathscr{L}_p^i|_{U_p\cap C}=\mathscr{M}|_{U_p\cap C}$. Then $\mathscr{L}_p^i$ for $p\in V$ can be glued together and we obtain a coherent $\mathscr{O}_{C'}$-submodule $\mathscr{L}^i$ of $j_*(\mathscr{M})$ which is satable under the action of $\theta_p$ for $p\in V$. We then have $j_*(\mathscr{M})=\bigcup_i\mathscr{L}^i$.
\end{proof}

We now proceed to the definition of regular holonomic systems over an algebraic curve. Recall that such a system is locally free over an open dense subset by \cref{D-module holonomic generically locally free}. In the one-dimensional case, the converse is also true.
\begin{lemma}\label{D-module on curve holonomic iff generaically locally free}
Let $C$ be an algebraic curve. Then a coherent $\mathscr{D}_C$-module $\mathscr{M}$ is holonomic if and only if it is generically an integrable connection.
\end{lemma}
\begin{proof}
The only if part follows from \cref{D-module holonomic generically locally free}. Assume that $\mathscr{M}$ is generically an integrable connection, i.e., there exists an open dense subset $U$ of $C$ such that $\mathscr{M}|_U$ is an integrable connection. Note that $V=C\setminus U$ consists of finitely many points. We see from our assumption that the characteristic variety $\Ch(\mathscr{M})$ of $\mathscr{M}$ is contained in $T^*_CC\cup\bigcup_{p\in V}T^*_pC$. By $\dim(T^*_CC)=\dim(T^*_pC)=1$, we have $\dim(\Ch(\mathscr{M}))\leq 1$, and hence $\mathscr{M}$ is holonomic.
\end{proof}

\begin{definition}\label{D-module holonomic on curve regular def}
A holonomic $\mathscr{D}_C$-module $\mathscr{M}$ on an algebraic curve $C$ is said to be \textbf{regular} if there exists an open dense subset $U$ of $C$ such that $\mathscr{M}|_U$ is a regular integrable connection on $U$. An object $\mathscr{M}$ of $D^b_h(\mathscr{D}_C)$ is said to be regular if all of the cohomology sheaves $\mathscr{M}$ are regular.
\end{definition}

By definition, a holonomic $\mathscr{D}_C$-module supported on a finite set is regular. This definition of regularity is compatible with the one defined for ODEs, as the following example shows.

\begin{example}
Consider an algebraic differential equation $P(x,\partial)u=0$ on $\A^1=\C$. Then the holonomic $\mathscr{D}_C$-module $\mathscr{M}=\mathscr{D}_{\C}u=\mathscr{D}_{\C}/\mathscr{D}_{\C}P(x,\partial)$ is regular if and only if the equation $P(x,\partial)u=0$ has a regular singular point (in the classical sense) at any point in $\P^1=\C\cup\{\infty\}$ (i.e. $P(x,\partial)u=0$ is a Fuchsian ODE).
\end{example}

The following proposition plays a crucial role in defining the regularity of holonomic $D$-modules over higher-dimensional varieties.

\begin{proposition}\label{D-module holonomic on curve regular and functor}
Let $f:C\to C'$ be a dominant morphism of algebraic curves. Then
\begin{enumerate}
    \item[(a)] $\mathscr{M}\in\Mod_h(\mathscr{D}_{C'})$ is regular if and only if $f^!(\mathscr{M})$ is regular.
    \item[(b)] $\mathscr{N}\in\Mod_h(\mathscr{D}_{C})$ is regular if and only if $f_+(\mathscr{M})$ is regular. 
\end{enumerate}
\end{proposition}
\begin{proof}
We may assume that $C=\widebar{C}$ and $C'=\widebar{C}'$, and take an open subset $C'_0$ of $C'$ such that $f_0:C_0\to C'_0$ is \'etale and $\mathscr{M}|_{C'_0}$ and $\mathscr{N}_{C_0}$ are integrable connection (where $C_0=f^{-1}(C'_0)$). For $p\in C\setminus C_0$ (resp $p'\in C'\setminus C'_0$). we take a local parameter $x_0$ (resp. $y_{p'}$) and set $\theta_p=x_p\partial_{x_p}$ (resp. $\theta_{p'}=y_{p'}\partial_{y_{p'}}$). If $p'=f(p)$, then we may assume that $y_{p'}=x_p^{m_p}$ for some integer $m_p$, so that $\theta_p=m_p\theta_{p'}$. We denote by $j:C_0\to C$ and $j:C'_0\to C'$ the canonical immersions.\par
To prove (a), we may assume that $\mathscr{M}=j'_*(\mathscr{M}|_{C'_0})$. Note that $Lf^*(\mathscr{M})|_{C_0}=f_0^*(\mathscr{M}|_{C'_0})$ is an integrable connection, so $\mathscr{M}$ (resp. $f^!(\mathscr{M})$) is regular if and only if $\mathscr{M}_{p'}$ (resp. $j_*f_0^*(\mathscr{M}|_{C'_0})_p$) is a regular algebraic meromorphic connection for any $p'\in C'\setminus C'_0$ (resp. $p\in C\setminus C_0$). Suppose that $p\in C\setminus C_0$ and $p'=f(p)$, then we have $\mathscr{O}_{C',p'}\sub\mathscr{O}_{C,p}$ by the hypothesis on $f$, and
\begin{align*}
j_*f_0^*(\mathscr{M}|_{C'_0})_p&\cong K_{C,p}\otimes_{\mathscr{O}_{C,p}}f^*(\mathscr{M})_p\cong K_{C,p}\otimes_{\mathscr{O}_{C',p'}}\mathscr{M}_{p'}\\
&\cong (K_{C,p}\otimes_{\mathscr{O}_{C',p'}}K_{C',p'})\otimes_{K_{C',p'}}\mathscr{M}_{p'}\\
&\cong K_{C,p}\otimes_{K_{C',p'}}\mathscr{M}_{p'}.
\end{align*}
Therefore, if $\mathscr{M}_{p'}$ has an $\mathscr{O}_{C',p'}$-lattice $L$, then $\mathscr{O}_{C,p}\otimes_{\mathscr{O}_{C',p'}}L$ is an $\mathscr{O}_{C,p}$-lattice of $K_{C,p}\otimes_{K_{C',p'}}\mathscr{M}_{p'}$. COnversely, assume that $K_{C,p}\otimes_{K_{C',p'}}\mathscr{M}_{p'}$ is a regular algebraic meromorphic connection at $p$. Then by \cref{D-module mero conn over C regular iff} we have $K_{C,p}\otimes_{K_{C',p'}}\mathscr{M}_{p'}=\bigcup_iL_i$, where $L_i$ is a $\theta_p$-stable finitely generated $\mathscr{O}_{C,p}$-module. Since $\mathscr{O}_{C,p}$ is finitely generated over $\mathscr{O}_{C',p'}$, $L'_i:=L_i\cap(1\otimes M_{p'})$ is finitely generated over $\mathscr{O}_{C',p'}$. Moreover, by the relation $\theta_p=m_p\theta_{p'}$, we see that $L'_i$ is $\theta_{p'}$-stable. It then follows from \cref{D-module mero conn over C regular iff} that $\mathscr{M}_{p'}=1\otimes\mathscr{M}_{p'}$ is also regular, and this proves assertion (a).\par
Now consider assertion (b). We have $f_+(\mathscr{N})|_{C'_0}=(f_0)_*(\mathscr{N}|_{C_0})$ and $(f_0)_*(\mathscr{N}|_{C_0})$ is an integrable connection. Moreover, $\mathscr{N}$ (resp. $f_+(\mathscr{N})$) is regular if and only if $j_*(\mathscr{N}|_{C_0})$ (resp. $j'_*(f_0)_*(\mathscr{N}|_{C_0})$) is a union of coherent $\mathscr{O}_C$ (resp. $\mathscr{O}_{C'}$)-modules which are stable under $\theta_p$ (resp. $\theta_{p'}$) for any $p\in C\setminus C_0$ (resp. $p'\in C'\setminus C'_0$). Note that $j'_*(f_0)_*(\mathscr{N}|_{C_0})\cong f_*j_*(\mathscr{N}|_{C_0})$, so if $j_*(\mathscr{N}|_{C_0})$ is a union of coherent $\mathscr{O}_C$-modules $\mathscr{L}_i$ which are stable udner $\theta_p$ for $p\in C\setminus C_0$, then $f_*j_*(\mathscr{N}|_{C_0})$ is a union of $\mathscr{O}_{C'}$-modules $f_*(\mathscr{L}_i)$ which are stable under $\theta_{p'}$ for $p'\in C'\setminus C'_0$. Conversely, if $f_+(\mathscr{N})$ is regular, then $Lf^*f_+(\mathscr{N})$ is also regular by (a). The restriction of the canonical morphism $\mathscr{N}\to Lf^*f_+(\mathscr{N})$ to $C_0$ is given by $\mathscr{N}|_{C_0}\to f^*f_*(\mathscr{N}_0)$, whence a monomorphism. This implies the regularity of $\mathscr{N}$ and completes the proof.
\end{proof}

Let us give comments on the difference of the notion of regularity in algebraic and analytic situations. Let $C$ be a one-dimensional complex manifold and $V$ be a finite subset of $C$. We denote by $j:U:=C\setminus V\to C$ the canonical embedding. Let $\mathscr{M}$ be an integrable connection on $U$. We say that a coherent $\mathscr{D}_C$-module $\bigtilde{\mathscr{M}}$ is a meromorphic extension of $\mathscr{M}$ if $\bigtilde{\mathscr{M}}|_U\cong\mathscr{M}$ and $\bigtilde{\mathscr{M}}$ is isomorphic as an $\mathscr{O}_C$-module to a locally free $\mathscr{O}_C(V)$-module, where $\mathscr{O}_C(V)$ denotes the sheaf of meromorphic functions on $C$ with possible poles on $V$. The following example shows that in the analytic situation a meromorphic extension of an integrable connection is not uniquely determined and one cannot define the notion of the regularity of an integrable connection at a boundary point unless its meromorphic extension is specified. Nevertheless, as we see later the uniqueness of a regular meromorphic extension in the analytic situation holds true as a part of the Riemann-Hilbert correspondence.

\begin{example}
We regard $C=\C$ as an algebraic curve, and let $j:U:=C\setminus\{0\}\to C$ be the embedding. Let us consider two (algebraic) integrable connections $\mathscr{M}=\mathscr{D}_U/\mathscr{D}_U\partial$ and $\mathscr{N}=\mathscr{D}_U/\mathscr{D}_U(x^2\partial-1)$ on $U$. We have an isomorphism $\mathscr{M}^{\an}\cong\mathscr{N}^{\an}$ given by
\[\mathscr{M}^{\an}\to\mathscr{N}^{\an},\quad [P\mod\mathscr{D}_{U^{\an}}\partial]\mapsto [P\exp(1/x)\mod\mathscr{D}_{U^{\an}}(x^2\partial-1)].\]
We consider meromorphic extensions $j_*(\mathscr{M})^{\an}$ and $j_*(\mathscr{N})^{\an}$ of $\mathscr{M}^{\an}$ and $\mathscr{N}^{\an}$, respectively. Let us show that they are not isomorphic. Note that $\mathscr{M}$ is regular since it is isomorphic to $\mathscr{O}_U$ as a $\mathscr{D}_U$-module, so $j_*(\mathscr{M})^{\an}_0$ is a regular meromorphic connection. It is then sufficient to show that $j_*(\mathscr{N})^{\an}_0$ is not regular as a meromorphic connection, which can be easily shown by checking that its horizontal sections do not have moderate growth.
\end{example}

\subsection{Regular meromorphic connections on complex manifolds}
\paragraph{Meromorphic connections in higher dimensions}
Let $X$ be a complex manifold and $D$ be a divisor (complex hypersurface) of $X$. We denote by $\mathscr{O}_X(D)$ the sheaf of meromorphic functions associated to $D$. For a local defining equation $g\in\mathscr{O}_X$ of $D$, we have $\mathscr{O}_X(D)=\mathscr{O}_X[g^{-1}]$, so $\mathscr{O}_X(D)$ is a coherent sheaf of rings. A \textbf{meromorphic connection $\mathscr{M}$ along the divisor $\bm{D}$} is defined to be a coherent $\mathscr{O}_X(D)$-module $\mathscr{M}$ endowed with a $\C$-linear morphism $\nabla:\mathscr{M}\to\Omega_X^1\otimes_{\mathscr{O}_X}\mathscr{M}$ satisfying the conditions
\begin{alignat}{2}
\nabla(fs)&=df\otimes s+f\nabla s,&\quad\quad&f\in\mathscr{O}_X(D),s\in\mathscr{M},\label{D-module mero conn def-1}\\
[\nabla_v,\nabla_w]&=\nabla_{[v,w]},&\quad\quad&v,w\in\Theta_X.\label{D-module mero conn def-2}
\end{alignat}
A morphism $\varphi:(\mathscr{M},\nabla)\to (\mathscr{N},\nabla)$ of meromorphic connections along $D$ is defined to be an $\mathscr{O}_X(D)$-linear morphism $\varphi:M\to N$ satisfying $\nabla\circ\varphi=(\id\otimes\varphi)\circ\nabla$. Finally, for a meromorphic connection $(\mathscr{M},\nabla)$ along $D$, we set $\mathscr{M}^\nabla=\{s\in\mathscr{M}:\nabla s=0\}$, whose elements are called \textbf{horizontal sections} of $(\mathscr{M},\nabla)$.\par
We denote by $\Conn(X,D)$ the category of meromorphic connections along $D$. Note that $\Conn(X,D)$ is an abelian category and an object of $\Conn(X,D)$ is a $\mathscr{D}_X$-module which is isomorphic as an $\mathscr{O}_X$-module to a coherent $\mathscr{O}_X(D)$-module, and a morphism $(\mathscr{M},\nabla)\to (\mathscr{N},\nabla)$ is just a morphism of the corresponding $\mathscr{D}_X$-modules. Therefore, $\Conn(X,D)$ is naturally regarded as a subcategory of $\Mod(\mathscr{D}_X)$. For $(\mathscr{M},\nabla)\in\Conn(X,D)$, the restriction $\mathscr{M}|_{X\setminus D}$ of $\mathscr{M}$ to $X\setminus D$ belongs to $\Conn(X)$; i.e., $\mathscr{M}|_{X\setminus D}$ is locally free over $\mathscr{O}_{X\setminus D}$ (cf. \cref{D-module coherent over O_X iff locally free}). In that sense, a meromorphic connection is an extension of a vector bundle with integrable connection on $X\setminus D$ to an object on $X$ with singularities along $D$.

\begin{remark}
Assume that $\dim(X)=1$ and $D$ has simple multiplicities. Let $p\in D$ and take a local coordinate $x$ such that $x(p)=0$. Then the stalk $\mathscr{O}_X(D)_p$ at $p\in D$ is identified with the quotient field $\C\{\!\{x\}\!\}[x^{-1}]$ of $\mathscr{O}_{X,p}\cong\C\{\!\{x\}\!\}$. Since $\mathscr{O}_{X}(D)_p$ is a field, any coherent $\mathscr{O}_X(D)$-module is free on a open neighborhood of $p$. Hence the stalk $(\mathscr{M}_p,\nabla_p)$ of $(\mathscr{M},\nabla)\in\Conn(X,D)$ at $p\in D$ turns out to be a meromorphic connection in the sense of \ref{D-module mero conn over C paragraph} by identifying $\Omega_X^1$ with $\mathscr{O}_X$ via $dx\in\Omega_X^1$ (note that condition (\ref{D-module mero conn def-2}) is automatically satisfied in the one-dimensional situation).
\end{remark}

For $(\mathscr{M},\nabla),(N,\nabla)\in\Conn(X,D)$, the $\mathscr{O}_X(D)$-modules $\mathscr{M}\otimes_{\mathscr{O}_X(D)}\mathscr{N}$ and $\sHom_{\mathscr{O}_X(D)}(\mathscr{M},\mathscr{N})$ are endowed with structures of meromorphic connections along $D$ by
\begin{align*}
\nabla(s\otimes t)&=\sum_i\omega_i\otimes(s_i\otimes t)+\sum_j\alpha_j\otimes(s\otimes t_j),\\
(\nabla\varphi)(s)&=(\id\otimes\varphi)(\nabla s)-\nabla(\varphi(s)),
\end{align*}
where $\nabla s=\sum_i\omega_i\otimes s_i$ and $\nabla t=\sum_j\alpha_j\otimes t_j$. In particular, for $(\mathscr{M},\nabla)\in\Conn(X,D)$, its dual $\mathscr{M}^*=\sHom_{\mathscr{O}_X(D)}(\mathscr{M},\mathscr{O}_X(D))$ is naturally endowed with a structure of a meromorphic connection along $D$. The following simple observation will be effectively used in proving the classical Riemann-Hilbert correspondence.

\begin{lemma}\label{D-module mero conn horizontal of Hom char}
For $(\mathscr{M},\nabla),(N,\nabla)\in\Conn(X,D)$, we have
\[\Gamma(X,\sHom_{\mathscr{O}_X(D)}(\mathscr{M},\mathscr{N})^\nabla)=\Hom_{\Conn(X,D)}((\mathscr{M},\nabla),(\mathscr{N},\nabla)).\]
\end{lemma}
\begin{proof}
This follows from the definition of the connection $\nabla$ for $\sHom_{\mathscr{O}_X(D)}(\mathscr{M},\mathscr{N})$.
\end{proof}

\begin{proposition}\label{D-module mero conn isomorphism iff}
Let $\varphi:\mathscr{M}\to\mathscr{N}$ be a morphism of meromorphic connections along $D$. If $\varphi|_{X\setminus D}$ is an isomorphism, then $\varphi$ is an isomorphism.
\end{proposition}
\begin{proof}
We note that the kernel and cokernel of $\varphi$ are coherent $\mathscr{O}_X(D)$-modules supported by $D$, so it suffices to prove that any coherent $\mathscr{O}_X(D)$-module $\mathscr{M}$ whose support is contained in $D$ is trivial. To this end, take a local defining equation $g$ of $D$. For a section $s\in\mathscr{M}$ whose support is contained in $D$, consider the $\mathscr{O}_X$-coherent submodule $\mathscr{O}_Xs\sub\mathscr{M}$. Since the support of $\mathscr{O}_Xs$ is contained in $D$, we have $g^Ns=0$ for $N\gg 0$ by Hilbert's Nullstellensatz, so $s=g^{-N}g^Ns=0$.
\end{proof}

\begin{corollary}\label{D-module mero conn reflexive}
Any meromorphic connection $\mathscr{M}$ along $D$ is reflexive in the sense that the canonical morphism $\mathscr{M}\to\mathscr{M}^{**}$ is an isomorphism.
\end{corollary}
\begin{proof}
This follows from \cref{D-module mero conn isomorphism iff} and the fact that $\mathscr{M}|_{X\setminus D}$ is locally free.
\end{proof}
Let $f:Y\to X$ be a morphism of complex manifolds such that $f^{-1}(D)$ is a divisor on $Y$. Then we have
\[\mathscr{O}_Y(f^{-1}(D))\cong\mathscr{O}_Y\otimes_{f^{-1}(\mathscr{O}_X)}f^{-1}(\mathscr{O}_X(D))\cong\mathscr{O}_Y\otimes_{f^{-1}(\mathscr{O}_X)}^Lf^{-1}(\mathscr{O}_X(D)).\]
Indeed, since $\mathscr{O}_X(D)$ is flat over $\mathscr{O}_X$, we have
\[H^i(\mathscr{O}_Y\otimes_{f^{-1}(\mathscr{O}_X)}^Lf^{-1}(\mathscr{O}_X(D)))=0,\quad i>0.\]
Moreover, for a local defining equation $g$ of $D$, we have $\mathscr{O}_X(D)=\mathscr{O}_X[g^{-1}]$ and $\mathscr{O}_Y(f^{-1}(D))=\mathscr{O}_Y[(g\circ f)^{-1}]$, whence
\[\mathscr{O}_Y(f^{-1}(D))\cong\mathscr{O}_Y\otimes_{f^{-1}(\mathscr{O}_X)}f^{-1}(\mathscr{O}_X(D)).\]

\begin{proposition}\label{D-module mero conn inverse image exact}
Let $f:Y\to X$ be a morphism of complex manifolds such that $f^{-1}(D)$ is a divisor on $Y$. Then for any $\mathscr{M}\in\Conn(X,D)$ we have $H^i(Lf^*(\mathscr{M}))=0$ for $i>0$ and $H^0(Lf^*(\mathscr{M}))\in\Conn(Y,f^{-1}(D))$. In particular, the inverse image functor of the category of $\mathscr{O}$-modules induces an exact functor
\[f^*:\Conn(X,D)\to\Conn(Y,f^{-1}(D)).\]
\end{proposition}
\begin{proof}
In fact, we have
\begin{align*}
Lf^*(\mathscr{M})&\cong\mathscr{O}_Y\otimes_{f^{-1}(\mathscr{O}_X)}^Lf^{-1}(\mathscr{M})\cong\mathscr{O}_Y(f^{-1}(D))\otimes_{f^{-1}(\mathscr{O}_X(D))}^Lf^{-1}(\mathscr{M})\\
&\cong\mathscr{O}_Y(f^{-1}(D))\otimes_{f^{-1}(\mathscr{O}_X(D))}f^{-1}(\mathscr{M}),
\end{align*}
which proves the claim.
\end{proof}

We consider the unit disk $\D=\{x\in\C:|x|<1\}$. For a morphism $i:\D\to X$ such that $i^{-1}(D)=\{0\}$, the stalk $i^*(\mathscr{M})_0$ at $0\in\D$ is a meromorphic connection of one-variable in the sense of \ref{D-module mero conn over C paragraph}. A meromorphic connection $\mathscr{M}$ on $X$ along $D$ is called \textbf{regular} if $i^*(\mathscr{M})_0$ is regular in the sense of \ref{D-module mero conn over C regularity paragraph} for any morphism $i:\D\to X$ such that $i^{-1}(D)=\{0\}$. We denote by $\Conn^{\reg}(X,D)$ the category of regular meromorphic connections along $D$.

\begin{proposition}\label{D-module mero conn regular prop}
Let $D$ be a divisor of the complex manifold $X$.
\begin{enumerate}
    \item[(a)] Let $0\to\mathscr{M}'\to\mathscr{M}\to\mathscr{M}''\to 0$ be a short exact sequence of meromorphic connections along $D$. Then $\mathscr{M}$ is regular if and only if $\mathscr{M}'$ and $\mathscr{M}''$ are regular.
    \item[(b)] Let $\mathscr{M}$ and $\mathscr{N}$ be regular meromorphic connections along $D$. Then the meromorphic connections $\mathscr{M}\otimes_{\mathscr{O}_X(D)}\mathscr{N}$ and $\sHom_{\mathscr{O}_X(D)}(\mathscr{M},\mathscr{N})$ are also regular.
\end{enumerate}
\end{proposition}
\begin{proof}
By definition we can reduce the problem to the case when $X$ is the unit disk $\D\sub\C$. Then (a) follows from \cref{D-module integral connection on curve regular and exact sequence} and we can prove (b) by using \cref{D-module mero conn over C regular Hom and tensor}.
\end{proof}

Ameromorphic connection on $X$ along $D$ is called \textbf{effective} if it is generated as an $\mathscr{O}_X(D)$-module by a coherent $\mathscr{O}_X$-submodule. We will see later that any regular meromorphic connection is effective.

\begin{proposition}\label{D-module mero conn direct image under proper birational}
Let $f:X'\to X$ be a proper surjective morphism of complex manifolds such that $D'=f^{-1}(D)$ is a divisor on $X'$ and $f|_{X'\setminus D'}:X'\setminus D'\to X\setminus D$ is an isomorphism. Assume that $\mathscr{N}$ is an effective meromorphic connection on $X'$ along $D'$.
\begin{enumerate}
    \item[(a)] We have $H^i(f_+(\mathscr{N}))=0$ for $i>0$ and $H^0(f_+(\mathscr{N}))$ is an effective meromorphic connection on $X$ along $D$.
    \item[(b)] If $\mathscr{N}$ is regular, then so is $H^0(f_+(\mathscr{N}))$. 
\end{enumerate}
\end{proposition}
\begin{proof}
We denote by $\mathscr{D}_{X'}(D')$ the subalgebra of $\sEnd_\C(\mathscr{O}_{X'}(D'))$ generated by $\mathscr{D}_{X'}$ and $\mathscr{O}_{X'}(D')$. Then we have
\[\mathscr{D}_{X'}(D')\cong\mathscr{D}_{X'}\otimes_{\mathscr{O}_{X'}}\mathscr{O}_{X'}(D')\cong\mathscr{O}_{X'}(D')\otimes_{\mathscr{O}_{X'}}\mathscr{D}_{X'}.\]
We first show that
\begin{equation}\label{D-module mero conn direct image under proper birational-1}
\mathscr{D}_{X\leftarrow X'}\otimes_{\mathscr{D}_{X'}}^L\mathscr{D}_{X'}(D')\cong\mathscr{D}_{X'}(\mathscr{D}').
\end{equation}
Note that the canonical morphism $f^{-1}(\Omega_X)\to\Omega_{X'}$ induces an isomorphism $\mathscr{O}_{X'}(D')\otimes_{f^{-1}(\mathscr{O}_X)}f^{-1}(\Omega_X)\to\mathscr{O}_{X'}(D')\otimes_{\mathscr{O}_{X'}}\Omega_{X'}$ by \cref{D-module mero conn isomorphism iff} and the hypothesis on $f$. We therefore have
\begin{align*}
\mathscr{D}_{X\leftarrow X'}\otimes_{\mathscr{D}_{X'}}^L\mathscr{D}_{X'}(D')&\cong \mathscr{D}_{X\leftarrow X'}\otimes_{\mathscr{O}_{X'}}^L\mathscr{O}_{X'}(D')\cong\mathscr{D}_{X\leftarrow X'}\otimes_{\mathscr{O}_{X'}}\mathscr{O}_{X'}(D')\\
&\cong f^{-1}(\mathscr{D}_X)\otimes_{f^{-1}(\mathscr{O}_X)}\mathscr{O}_{X'}(D').
\end{align*}
Let us show that the canonical morphism $\mathscr{D}_{X'}(D')\to f^{-1}(\mathscr{D}_X)\otimes_{f^{-1}(\mathscr{O}_X)}\mathscr{O}_{X'}(D')$ induced by the canonical section $1\otimes 1$ of the right $\mathscr{D}_{X'}(D')$-module $f^{-1}(\mathscr{D}_X)\otimes_{f^{-1}(\mathscr{O}_X)}\mathscr{O}_{X'}(D')$ is an isomorphism. For this, it suffices to show that $F_p(\mathscr{D}_{X'})(D')\to f^{-1}(F_p(\mathscr{D}_X))\otimes_{f^{-1}(\mathscr{O}_X)}\mathscr{O}_{X'}(D')$ is an isomorphism for each $p\in\Z$, which follows from \cref{D-module mero conn isomorphism iff}. This completes the proof of (\ref{D-module mero conn direct image under proper birational-1}).\par
By hypothesis, there exists a coherent $\mathscr{O}_{X'}$-submodule $\mathscr{L}$ of $\mathscr{N}$ such that $\mathscr{N}\cong\mathscr{O}_{X'}(D')\otimes_{\mathscr{O}_{X'}}\mathscr{L}$. Then by (\ref{D-module mero conn direct image under proper birational-1}) and $f^{-1}(\mathscr{O}_X(D))\otimes_{f^{-1}(\mathscr{O}_X)}\mathscr{O}_{X'}\cong\mathscr{O}_{X'}(D')$, we have
\begin{align*}
f_+(\mathscr{N})&=Rf_*(\mathscr{D}_{X\leftarrow X'}\otimes_{\mathscr{D}_{X'}}^L\mathscr{N})\cong Rf_*(\mathscr{D}_{X\leftarrow X'}\otimes_{\mathscr{D}_{X'}}^L\mathscr{D}_{X'}(D')\otimes_{\mathscr{D}_{X'}(D')}^L\mathscr{N})\\
&\cong Rf_*(\mathscr{N})\cong Rf_*(\mathscr{O}_{X'}(D')\otimes_{\mathscr{O}_{X'}}\mathscr{L})\cong Rf_*(f^{-1}(\mathscr{O}_X(D))\otimes_{f^{-1}(\mathscr{O}_X)}\mathscr{L})\\
&\cong\mathscr{O}_X(D)\otimes_{\mathscr{O}_X}Rf_*(\mathscr{L})
\end{align*}
so $H^i(f_+(\mathscr{N}))\cong\mathscr{O}_X(D)\otimes_{\mathscr{O}_X}R^if_*(\mathscr{L})$ and $H^0(f_+(\mathscr{N}))$ is effective. Since $R^if_*(\mathscr{L})$ is coherent over $\mathscr{O}_X$ for any $i$ by Grauert direct image theorem, we see that $H^i(f_+(\mathscr{N}))$ is coherent over $\mathscr{O}_X(D)$. Moreover, we have $H^i(f_+(\mathscr{N}))=0$ for $i>0$ by $R^if_*(\mathscr{L})|_{X\setminus D}=0$ and \cref{D-module mero conn isomorphism iff}, whence statement (a).\par
Now assume that $\mathscr{N}$ is regular. Let $i:\D\to X$ be a morphism from the unit disk $\D$ satisfying $i^{-1}(D)=\{0\}$. Since $f$ is proper, there exists a lift $j:\D\to X'$ satisfying $f\circ j=i$. Then we have
\[i^*H^0(f_+(\mathscr{N}))\cong i^*f_+(\mathscr{N})\cong j^*f^*(f_+(\mathscr{N})).\]
Since the canonical morphism $\mathscr{N}\to f^*(f_+(\mathscr{N}))$ is an isomorphism on $X'\setminus D'$, it is an isomorphism on $X'$ by \cref{D-module mero conn isomorphism iff}. We thus obtain that $i^*H^0(f_+(\mathscr{N}))\cong j^*(\mathscr{N})$, so $H^0(f_+(\mathscr{N}))$ is regular.
\end{proof}

\paragraph{Meromorphic connections with logarithmic poles}
We now consider the case where $D$ is a normal crossing divisor on a complex manifold, i.e. we assume that $D$ is locally defined by a function of the form $x_1\cdots x_r$, where $(x_1,\dots,x_n)$ is a local coordinate for $X$. Let $p\in D$ and fix such a coordinate at $p\in D$. We denote by $D_k$ the (local) irreducible component of $D$ defined by $x_k$ for each $k$.\par
The meromorphic connections $\mathscr{M}$ on $X$ along $D$ which we will consider in this paragraph are also of very special type. First, we assume that there exists a holomorphic vector bundle (locally free $\mathscr{O}_X$-module of finite rank) $\mathscr{L}$ on $X$ such that $\mathscr{M}=\mathscr{O}_X(D)\otimes_{\mathscr{O}_X}\mathscr{L}$ as an $\mathscr{O}_X(D)$-module. Hence taking a local defining equation $x_1\cdots x_r=0$ of $D$ and choosing a basis $e_1,\dots,e_m$ of $\mathscr{L}$ around a point $P\in D$, the associated $\C$-linear morphism $\nabla:\mathscr{M}\to\Omega_X^1\otimes_{\mathscr{O}_X}\mathscr{M}$ can be expressed as
\begin{equation}\label{D-module mero conn locally free expression}
\nabla e_i=\sum_{k,j}a_{ij}^k\frac{dx_k}{x_k}\otimes e_j
\end{equation}
where $a_{ij}^k\in\mathscr{O}_X(D)$. If the functions $a_{ij}^k$ are holomorphic, we say the meromorphic connection $\mathscr{M}$ along the normal crossing divisor $D$ has a \textbf{logarithmic pole} with respect to the lattice $\mathscr{L}$ at $p$. If this is the case at any $p\in M$, we say that $\mathscr{M}$ has a \textbf{logarithmic pole} along $D$ with respect to $\mathscr{L}$. Note that this definition does not depend on the choice of the coordinates $\{x_k\}$ and the basis $\{e_i\}$ of $\mathscr{L}$.\par
Let $\mathscr{M}$ be a meromorphic connection along $D$ which has a logarithmic pole with respect to the lattice $\mathscr{L}$. Take a basis $\{e_1,\dots,e_m\}$ of $\mathscr{L}$ and set $A_k=(a_{ij}^k)$ for $1\leq k\leq n$ as in (\ref{D-module mero conn locally free expression}). Since $A_k$ belongs to $\mathcal{M}_m(\mathscr{O}_X)$ by hypothesis, we can consider its restriction $A_k|_{D_k}\in\mathcal{M}_{m}(\mathscr{O}_{D_k})$. Then $A_k|_{D_k}$ defines a canonical section $\Res^{\mathscr{L}}_{D_k}(\nabla)$ of the vector bundle $\sEnd_{\mathscr{O}_{D_k}}(\mathscr{L}|_{D_k})$ on $D_k$. Indeed, we can check easily that $A_k|_{D_k}\in\mathcal{M}_{m}(\mathscr{O}_{D_k})\cong\sEnd_{\mathscr{O}_{D_k}}(\mathscr{L}|_{D_k})$ does not depend on the choice of a local coordinate and a basis of $\mathscr{L}$. The section $\Res^{\mathscr{L}}_{D_k}(\nabla)$ is called the \textbf{residue} of $(\mathscr{M},\nabla)$ along $D_k$.

\begin{proposition}\label{D-module mero conn logarithmic pole residue prop}
Let $\mathscr{M}$ be a meromorphic connection along $D$ which has a logarithmic pole with respect to the lattice $\mathscr{L}$.
\begin{enumerate}
    \item[(a)] On $D_k\cap D_l$ we have $[\Res^{\mathscr{L}}_{D_k}(\nabla),\Res^{\mathscr{L}}_{D_l}(\nabla)]=0$.
    \item[(b)] The eigenvalues of $\Res^{\mathscr{L}}_{D_k}(\nabla)(x)\in\End_{\C}(\mathscr{L}_x/\m_x\mathscr{L}_x)$ are locally constant along $D_l$.
\end{enumerate}
\end{proposition}
\begin{proof}
With the notations of (\ref{D-module mero conn locally free expression}), we have $\nabla_{\partial_k}=\frac{A^k}{x_k}$, so the integrability condition $[\nabla_{\partial_k},\nabla_{\partial_l}]$ expands out to
\[\frac{\partial}{\partial x_k}\Big(\frac{A^l}{x_l}\Big)-\frac{\partial}{\partial x_l}\Big(\frac{A^k}{x_k}\Big)=[\frac{A^k}{x_k},\frac{A^l}{x_l}].\]
After rearranging the terms, this becomes
\[x_k\frac{\partial A^l}{\partial x_k}-x_l\frac{\partial A^k}{\partial x_l}=[A^k,A^l],\]
so the restriction of the two matrices $A^k$ and $A^l$ to the set $x_k=x_l=0$ commute with each other.\par
For the proof of (b), let $\widebar{\mathscr{L}}$, $\bar{A}^k$ be the restriction of $\mathscr{L}$, $A^k$ to $D_l$, respectiely. Then the formula
\[\widebar{\nabla}\bar{e}_i=\sum_{j,k\neq l}\bar{a}_{ij}^k\frac{dx_k}{x_k}\otimes\bar{e}_j,\quad \bar{A}^k=(\bar{a}_{ij}^k)\]
defines an integrable connection $\widebar{\nabla}$ on $\mathscr{L}|_{D_l}$, and one checks that $\bar{A}^l=\Res^\mathscr{L}_{D_l}(\nabla)$ is a horizontal section of $\sEnd_{\mathscr{O}_{D_l}}(\widebar{\mathscr{L}})$ with respect to the induced connection. From this we can easily check that the eigenvalues of the matrix $\bar{A}^l$ are locally free along $D_l$.
\end{proof}

\begin{proposition}\label{D-module mero conn logarithmic pole regular}
Let $\mathscr{M}$ be a meromorphic connection which has a logarithmic pole along $D$ with respect to a lattice $\mathscr{L}$. Then $\mathscr{M}$ is regular.
\end{proposition}
\begin{proof}
For any morphism $i:\D\to X$ from the unit disk $\D$ such that $i^{-1}(D)=\{0\}$, we easily see that the meromorphic connection $i^*(\mathscr{M})$ on $\D$ has a logarithmic pole along $\{0\}$ with respect to the lattice $i^*(\mathscr{L})$. Then the stalk $i^*(\mathscr{M})_0$ is regular by \cref{D-module ODE n-dimension equation regular def}.
\end{proof}

The following construction enables us to extend analytic integrable connections on $X\setminus D$ to regular meromorphic connections along the divisor $D\sub X$.

\begin{theorem}\label{D-module mero conn logarithmic pole unique extension}
Let $D$ be a normal crossing divisor on $X$. We fix a section $\tau:\C/\Z\to\C$ of the projection $\C\to\C/\Z$. Then for any integrable connection $\mathscr{M}$ on $X\setminus D$, there exists a unique locally free $\mathscr{O}_X$-module $\mathscr{L}_\tau$ satisfying the following two conditions:
\begin{enumerate}
    \item[(a)] We have $\mathscr{L}_\tau|_{X\setminus D}=\mathscr{M}$.
    \item[(b)] The connection $\nabla:\mathscr{M}\to\Omega_{X\setminus D}^1\otimes_{\mathscr{O}_{X\setminus D}}\mathscr{M}$ can be uniquely extended to a $\C$-linear morphism
    \[\nabla:\mathscr{M}_\tau\to\Omega_X^1\otimes_{\mathscr{O}_X}\mathscr{M}_\tau,\]
    where $\mathscr{M}_\tau=\mathscr{O}_X(D)\otimes_{\mathscr{O}_X}\mathscr{L}_\tau$, so that $(\mathscr{M}_\tau,\nabla)$ is a meromorphic connection which has a logarithmic pole along $D$ with respect to $\mathscr{L}_\tau$.
    \item[(c)] At any irreducible component $D_0$ of $D$, the eigenvalues of the residue $\Res^{\mathscr{L}_\tau}_{D_0}(\nabla)$ of $(\mathscr{M}_\tau,\nabla)$ along $D_0$ are contained in $\tau(\C/\Z)\sub\C$.
\end{enumerate}
Moreover, with the above choice of $\mathscr{L}_\tau$, the restriction map
\[\Gamma(X,\mathscr{M}_\tau^\nabla)\to \Gamma(X\setminus D,\mathscr{M}^\nabla)\]
is an isomorphism.
\end{theorem}
\begin{proof}
Let us start with the local existence, since that is easier. Since we are working locally, we can assume that $X=\D^n$, where $\D$ is the unit disk in $\C$. The divisor $D$ is given by the equation $x_1\cdots x_r=0$, so $X\setminus D=(\D^*)^r\times\D^{n-r}$. Let $\mathscr{L}$ and $\mathscr{L}'$ be locally free $\mathscr{O}_X$-modules of rank $m$ satisfying the above conditions, and
\[\nabla:\mathscr{O}_X(D)\otimes_{\mathscr{O}_X}\mathscr{L}\to\Omega_X^1\otimes_{\mathscr{O}_X}\mathscr{O}_X(D)\otimes_{\mathscr{O}_X}\mathscr{L},\quad \nabla:\mathscr{O}_X(D)\otimes_{\mathscr{O}_X}\mathscr{L}'\to\Omega_X^1\otimes_{\mathscr{O}_X}\mathscr{O}_X(D)\otimes_{\mathscr{O}_X}\mathscr{L}'\]
be the correponding connections. Take a basis $\{e_i\}$ of $\mathscr{L}$ and a basis $\{e'_i\}$ of $\mathscr{L}'$. Then we can write
\[\nabla e_i=\sum_{k,j}a_{ij}^k\frac{dx_k}{x_k}\otimes e_j,\quad \nabla' e'_i=\sum_{k,j}a_{ij}'^k\frac{dx_k}{x_k}\otimes e'_j.\]
We set $\omega=\sum_kA^k\frac{dx_k}{x_k}$ and $\omega'=\sum_kA'^k\frac{dx_k}{x_k}$. By assumption $\mathscr{L}|_{X\setminus D}$ and $\mathscr{L}'|_{X\setminus D}$ are isomorphic. After a short calculation, the isomorphism between the two bundles with connection translates into the existence of an invertible matrix $S\in\GL_m(\mathscr{O}_{X\setminus D})$ such that
\begin{equation}\label{D-module mero conn logarithmic pole unique extension-1}
dS=S\omega-\omega'S.
\end{equation}
The entries of $S$ are holomorphic functions on $X\setminus D$, possibly with essential singularities along $D$. To prove the uniqueness statement, it is enough to show that $S\in\GL_m(\mathscr{O}_X)$, meaning that the entries of $S$ can be extended to holomorphic functions on $X$. By Hartog's theorem, holomorphic functions extend over subsets of codimension $\geq 2$, so we only need to to prove that the entries of $S$ extend over the generic point of each irreducible component of $D$. To keep the notation simple, we will check this at points of $D_1\setminus\bigcup_{k\neq 1}D_k$, meaning at points where $x_1=0$ but $x_2\cdots x_r\neq 0$. Now in view of the relation (\ref{D-module mero conn logarithmic pole unique extension-1}), we have
\begin{equation}\label{D-module mero conn logarithmic pole unique extension-2}
x_1\frac{\partial S}{\partial x_1}=SA^1-A'^1S,
\end{equation}
and after taking the matrix norm of both sides, we obtain that
\[|x_1|\cdot\|\frac{\partial S}{\partial x_1}\|\leq C\|S\|,\]
where $C>0$ is a constant that depends on the size of the (holomorphic) entries of the two matrices $A^1$ and $A'^1$. We can now apply Gr\"onwall's inequality to deduce that the entries of $S$ have moderate growth near $x_1$, hence are meromorphic functions on the set where $x_2\cdots x_r\neq 0$.\par
To show that $S$ is actually holomorphic on $D_1\setminus\bigcup_{k\neq 1}D_k$, we consider the Laurent expansion
\[S=\sum_{j=p}^{\infty}S_jx^j\]
where $S_p\neq 0$ is the leading term. After substituting this into (\ref{D-module mero conn logarithmic pole unique extension-2}), we get
\[\sum_{j=p}^{\infty}jS_jx_1^j=\sum_{j=p}^{\infty}(S_jA^1-A'^1S_j)x_1^j,\]
in which the coefficients at $x^p$ equals to
\[pS_p=S_p\cdot A^1|_{x_1=0}-A'^1|_{x_1=0}\cdot S_p=S_p\cdot\Res_{D_1}^{\mathscr{L}}(\nabla)-\Res_{D_1}^{\mathscr{L}'}(\nabla')\cdot S_p.\]
Since $\Res_{D_1}^{\mathscr{L}}(\nabla)$ and $\Res_{D_1}^{\mathscr{L}'}(\nabla')$ have their eigenvalues contained in $\tau(\C/\Z)$, this relation forces $p=0$. Indeed, suppose that $v$ is a nontrivial eigenvector
for $\Res_{D_1}^{\mathscr{L}}(\nabla)$, with eigenvalue $\lambda$. Then
\[p(S_pv)=\lambda(S_pv)-\Res_{D_1}^{\mathscr{L}'}(\nabla')(S_pv),\]
so $S_pv$ is an eigenvector for $\Res_{D_1}^{\mathscr{L}'}(\nabla')$, with eigenvalue $\lambda-p$. As the difference of these two eigenvalues is an integer, this can only happen for $p=0$. The conclusion is that $S$ extends holomorphically to all of $X$, proving the desired uniqueness.\par
Next we prove the existence of the extension (as a vector bundle) $\mathscr{L}_\tau$ of $\mathscr{M}$. If there exists locally such an extension $\mathscr{L}_\tau$, we can glue these local extensions to get the global one by the uniqueness of Lτ proved above. Hence we may assume that $X\setminus D=(\D^*)^r\times\D^{n-r}\sub X=\D^n$. By \cref{D-module analytic integral connection and local system} the integrable connection $\mathscr{M}$ on $X\setminus D$ is uniquely determined by the monodromy representation
\[\rho:\pi_1(X\setminus D)\to\GL_m(\C)\]
defined by the local system corresponding to $\mathscr{M}$. Note that $\pi_1(X\setminus D)=\Z^r$, so this corresponds to $r$ commuting matrices $C_1,\dots,C_r$ of $\GL_m(\C)$. It is a simple exercise to show that there are uniquely determined matrices $\Gamma^i\in\mathcal{M}_m(\C)$ such that
\begin{enumerate}
    \item[(a)] $\exp(2\pi\i\Gamma^i)=C_i$,
    \item[(b)] all the eigenvalues of $\Gamma^i$ belong to $\tau(\C/\Z)$,
    \item[(c)] the $\Gamma^i$'s are mutuallt commuting matrices.
\end{enumerate}
We can now define $\mathscr{L}_\tau=\mathscr{O}_X^{\otimes m}$, and put a meromorphic connection on $\mathscr{M}_\tau=\mathscr{O}_X(D)\otimes_{\mathscr{O}_X}\mathscr{L}_\tau$ by the formula
\[\nabla e_i=\sum_{j,k}\Gamma_{i,j}^k\frac{dx_k}{x_k}\otimes e_j.\]
From the construction, it is clear that this has the three properties in the statement of the theorem. Moreover, a horizontal section of $\mathscr{M}$ is the same thing as a monodromy invariant vector $v\in\C^m$, meaning one with $C^1v=\cdots=C^rv=0$. This is equivalent to $\Gamma^1v=\cdots=\Gamma^rv=0$, so $v$ also represents a horizontal section of $\mathscr{M}_\tau$.
\end{proof}

\paragraph{Deligne's Riemann-Hilbert correspondence}
In \cref{D-module mero conn logarithmic pole unique extension} we proved that an integrable connection $\mathscr{M}$ defined on the complement $X\setminus D$ of a normal crossing divisor $D$ on $X$ can be extended to a meromorphic connection $\mathscr{M}_\tau=\mathscr{O}_X(D)\otimes_{\mathscr{O}_X}\mathscr{L}_\tau$ on $X$, regular along $D$. We now generalize this result to arbitrary divisors on $X$.\par
Let $D$ be a (not necessarily normal crossing) divisor on $X$ and $(\mathscr{M},\nabla)$ be a meromorphic connection on $X$ which is meromorphic along $D$. We consider the following condition (R) on $(\mathscr{N},\nabla)$, which is a priori weaker than the regularity along $D$ (in fact, we will see that these two conditions are equivalent).
\begin{enumerate}[leftmargin=40pt]
    \item[(R)] There exists an open subset $U$ of the regular part $D_{\reg}$ of $D$ which intersects with each connected component of $D_{\reg}$ and satisfies the following condition: There exist an open neighborhood $\widetilde{U}$ of $U$ in $X$ and an isomorphism $\varphi:\D\times U\stackrel{\sim}{\to}\widetilde{U}$ such that $\varphi|_{\{0\}\times U}=\id_U$ and for each $x\in U$ the pull-back $(\varphi_x^*(\mathscr{M}),\varphi_x^*(\nabla))$ with respcet to $\varphi_x=\varphi|_{\D\times\{x\}}:\D\times\{x\}\to X$ is regular along $\{0\}\times\{x\}$.
\end{enumerate}
It is clear that if $(\mathscr{M},\nabla)$ is regular along $D$, then it satisfies the condition (R).

\begin{lemma}\label{D-module mero conn condition R horizontal section isomorphism}
Assume that a meromorphic connection $(\mathscr{M},\nabla)$ satisfies the condition (R). Then the restriction map
\[\Gamma(X,\mathscr{M}^\nabla)\to\Gamma(X\setminus D,\mathscr{M}^\nabla)\]
\end{lemma}
\begin{proof}
The injectivity follows from \cref{D-module mero conn isomorphism iff}. We need to show that any $s\in\Gamma(X\setminus D,\mathscr{M}^\nabla)$ can be extended to a section of $\mathscr{M}^\nabla$ on $X$. By \cref{D-module mero conn reflexive}, it is sufficient to show that for any $p\in D$ and any $u\in\mathscr{N}_p^*=\sHom_{\mathscr{O}_X(D)}(\mathscr{N},\mathscr{O}_X(D))_p$, the function $g=\langle u,s\rangle$ is meromorphic at $p$. By Hartgos' theorem, it suffices to consider the case $p\in D_{\reg}$.\par
We first consider the case where $p\in U\sub D_{\reg}$, where $U$ is as in condition (R). We take a local coordinate $(x_1,\dots,x_n)$ at $p$ such that $D$ is defined by $x_1=0$, and we may assume that $U=\{0\}\times\D^{n-1}$. Let
\[g(x)=\sum_{k\in\Z}g_k(x_2,\dots,x_n)x_1^k\]
by the Laurent expansion of $g$ with respect to $x_1$. Condition (R) then implies that for each $x'=(x_2,\dots,x_n)\in\D^{n-1}$ the restriction $g|_{\D^*\times\{x'\}}$ is meromorphic at the point $\{0\}\times\{x'\}$, which means for each $x'=(x_2,\dots,x_n)\in\D^{n-1}$, we have $g_k(x')=0$ for $k\ll 0$. For $k\in\Z$, we set
\[U_k=\{x'=(x_2,\dots,x_n)\in\D^{n-1}:\text{$g_i(x')=0$ for $i\leq k$}\}.\]
Then we have $\D^{n-1}=\bigcup_{k\in\Z}U_k$ and each $U_k$ is a closed analytic subset of $\D^{n-1}$. It then follows Baire's category theorem that $U_k$ has nonempty interior for some $k$, and hence $g$ is meromorphic at $p$.\par
Let us consider the general case $p\in D_{\reg}$. We denote by $K$ the subset of $D_{\reg}$ consisting of $p\in D_{\reg}$ such that $g=\langle u,s\rangle$ is meromorphic at $p$ for any $u\in\mathscr{N}_p^*$. Note that $K$ is an open subset of $D_{\reg}$ containing $U$; in particular, it intersects with any connected component of $D_{\reg}$, so it suffices to show that $K$ is also a closed subset of $D_{\reg}$. Let $q\in\widebar{K}$; we take a local coordinate $(x_1,\dots,x_n)$ at $q$ such that $D$ is defined by $x_1=0$. For $u\in\mathscr{N}_p^*$, we consider the expansion
\[g(x)=\sum_{k\in\Z}g_k(x_2,\dots,x_n)x_1^k\]
of $g=\langle u,s\rangle$. Since $g$ is meromorphic on $K$, there exists some integer $r\in\Z$ such that $g_k=0$ on $K$ for $k\leq r$. It follows from continuity that $g_k=0$ for any $k\leq r$ on an open neighborhood of $q$, so $q\in K$.
\end{proof}

\begin{lemma}\label{D-module mero conn condition R Hom set isomorphism}
Let $(\mathscr{M},\nabla)$ and $(\mathscr{N},\nabla)$ be meromorphic connections along $D$ satisfying the condition (R). Then the restriction to $X\setminus D$ induces an isomorphism
\[\Hom_{\Conn(X,D)}((\mathscr{M},\nabla),(\mathscr{N},\nabla))\stackrel{\sim}{\to} \Hom_{\Conn(X\setminus D)}((\mathscr{M}|_{X\setminus D},\nabla),(\mathscr{N}|_{X\setminus D},\nabla))\]
\end{lemma}
\begin{proof}
By \cref{D-module mero conn horizontal of Hom char} we have
\[\Gamma(X,\sHom_{\mathscr{O}_X(D)}(\mathscr{M},\mathscr{N})^\nabla)=\Hom_{\Conn(X,D)}((\mathscr{M},\nabla),(\mathscr{N},\nabla)).\]
Therefore, it suffices to apply \cref{D-module mero conn condition R horizontal section isomorphism} to the meromorphic connection $\sHom_{\mathscr{O}_X(D)}(\mathscr{M},\mathscr{N})$, which satisfies the condition (R) by \cref{D-module mero conn regular prop}~(b).
\end{proof}

\begin{theorem}[\textbf{Deligne}]\label{D-module mero conn Deligne correspondence}
Let $X$ be a complex manifold and $D$ be a (not necessarily normal crossing) divisor on $X$. Then the restriction functor $\mathscr{N}\mapsto\mathscr{N}|_{X\setminus D}$ induces an equivalence
\[\Conn^{\reg}(X,D)\stackrel{\sim}{\to} \Conn(X\setminus D)\]
of categories.
\end{theorem}
\begin{proof}
Since a regular meromorphic connection along $D$ satisfies the condition (R), the restriction functor is fully faithful by \cref{D-module mero conn condition R Hom set isomorphism}. Let us prove the essential surjectivity. We take an integrable connection $\mathscr{M}$ on $X\setminus D$ and consider the problem of extending $\mathscr{M}$ to a regular meromorphic connection on the whole $X$. By Hironaka's theorem there exists a proper surjective morphism $f:X'\to X$ of complex manifolds such that $D'=f^{-1}(D)$ is a normal crossing divisor on $X$ and the restriction $g:X'\setminus D'\to X\setminus D$ of $f$ is an isomorphism. By \cref{D-module mero conn logarithmic pole unique extension} we can extend the integrable connection $g^*(\mathscr{M})$ to a meromorphic connection $\mathscr{N}$ on $X'$ along $D'$ which has a logarithmic pole with respect to a lattice $\mathscr{L}$. Then $H^0(f_+(\mathscr{N}))$ satisfies the desired property by \cref{D-module mero conn direct image under proper birational}.
\end{proof}

When $D$ is normal crossing, we proved in \cref{D-module mero conn logarithmic pole unique extension} the uniqueness of the regular meromorphic extension of an integrable connection on $X\setminus D$ under an additional condition about the lattice $\mathscr{L}_\tau$. \cref{D-module mero conn Deligne correspondence} above asserts that this condition was not really necessary.\par
By \cref{D-module analytic integral connection and local system}, we have the following topological interpretation of \cref{D-module mero conn Deligne correspondence}.

\begin{corollary}\label{D-module regular mero conn and local system}
Let $X$ be a complex manifold and $D$ be a divisor on $X$. Then we have an equivalence
\[\Conn^{\reg}(X,D)\stackrel{\sim}{\to} \Loc(X\setminus D)\]
of categories.
\end{corollary}
We call this result \textbf{Deligne's Riemann-Hilbert correspondence}. This classical Riemann-Hilbert correspondence became the prototype of the Riemann-Hilbert correspondence for analytic regular holonomic $D$-modules.

\begin{corollary}\label{D-module mero conn condition R is regular}
Let $D$ be a (not necessarily normal crossing) divisor on a complex manifold $X$ and let $\mathscr{M}$ be a meromorphic connection along $D$.
\begin{enumerate}
    \item[(a)] If $\mathscr{M}$ satisfies the condition (R), then $\mathscr{N}$ is regular along $D$.
    \item[(b)] If $\mathscr{M}$ is regular along $D$, then $\mathscr{M}$ is an effective meromorphic connection along $D$.
\end{enumerate}
\end{corollary}
\begin{proof}
Assume that $\mathscr{M}$ satisfies condition (R). By \cref{D-module mero conn Deligne correspondence}, there exists a regular meromorphic connection $\mathscr{N}$ along $D$ such that $\mathscr{N}|_{X\setminus D}\cong\mathscr{M}|_{X\setminus D}$. Since both $\mathscr{M}$ and $\mathscr{N}$ satisfy the condition (R), this isomorphism can be extended to a morphism $\mathscr{M}\stackrel{\sim}{\to}\mathscr{N}$ of meromorphic connections on $X$ by \cref{D-module mero conn condition R Hom set isomorphism}. This is in fact an isomorphism by \cref{D-module mero conn isomorphism iff}, and hence $\mathscr{M}$ is regular along $D$.\par
Now if $\mathscr{M}$ is regular along $D$, then in the proof of \cref{D-module mero conn Deligne correspondence} we explicitly constructed a regular meromorphic extension of $\mathscr{M}|_{X\setminus D}$, which is isomorphic to $\mathscr{M}$ and has the required property.
\end{proof}

Assume that $D$ is a normal crossing divisor on $X$. We define a subsheaf of the sheaf $\Theta_X$ of holomorphic vector fields on $X$ by
\[\Theta_X[D]=\{v\in\Theta_X:v\mathscr{I}\sub\mathscr{I}\},\]
where $\mathscr{I}$ is the defining ideal of $D$. If $\{x_i,\partial_i\}$ is a local coordinate system of $X$ in which $D$ is defined by $x_1\cdots x_r=0$, then $\Theta_X[D]$ is generated by $x_1\partial_1,\dots,x_r\partial_r,\partial_{r+1},\dots,\partial_n$ over $\mathscr{O}_X$. 

\begin{corollary}\label{D-module mero conn regular iff union of Theta stable submodule}
Let $D$ be a normal crossing divisor on a complex manifold $X$. Then the following conditions on a meromorphic connection $\mathscr{M}$ along $D$ are equivalent:
\begin{enumerate}
    \item[(\rmnum{1})] $\mathscr{M}$ is regular along $D$.
    \item[(\rmnum{2})] $\mathscr{M}$ is a union of $\Theta_X[D]$-stable coherent $\mathscr{O}_X$-submodules.
\end{enumerate}
\end{corollary}
\begin{proof}
Assume that $\mathscr{M}$ is regular along $D$. By \cref{D-module mero conn logarithmic pole unique extension}, for a section $\tau:\C/\Z\to\C$ of $\C\to\C/\Z$ we have a locally free $\mathscr{O}_X$-module $\mathscr{L}_\tau$ such that $\mathscr{N}|_{X\setminus D}\cong\mathscr{L}_\tau|_{X\setminus D}$ and $\mathscr{O}_X(D)\otimes_{\mathscr{O}_X}\mathscr{L}_\tau$ is a regular meromorphic connection along $D$. Then by \cref{D-module mero conn logarithmic pole unique extension} we have $\mathscr{M}\cong\mathscr{O}_X(D)\otimes_{\mathscr{O}_X}\mathscr{L}_\tau$. Take a local coordinate system $\{x_i\}$ of $X$ such that $D$ is defined by $g(x)=x_1\cdots x_r=0$, we have
\[\mathscr{O}_X(D)\otimes_{\mathscr{O}_X}\mathscr{L}_\tau=\bigcup_{k\geq 0}g^{-k}\mathscr{O}_X\otimes_{\mathscr{O}_X}\mathscr{L}_\tau.\]
Since for each $k$ the definition of the $\mathscr{O}_X$-coherent subshaef $g^{-k}\mathscr{O}_X\otimes_{\mathscr{O}_X}\mathscr{L}_\tau$ of $\mathscr{O}_X(D)\otimes_{\mathscr{O}_X}\mathscr{L}_\tau$ does not depend on the local coordinate $\{x_i\}$ and the defining equation $g$, it is globally defined on $X$. It is clear that each $g^{-k}\mathscr{O}_X\otimes_{\mathscr{O}_X}\mathscr{L}_\tau$ is $\Theta_X[D]$-stable, since $\mathscr{L}_\tau$ is $\Theta_X[D]$-stable.\par
Conversely, assume that $\mathscr{M}$ is a union of $\Theta_X[D]$-stable coherent $\mathscr{O}_X$-submodules. By \cref{D-module mero conn condition R is regular}~(a) it suffices to check that $\mathscr{M}$ satisfies the condition (R). If we restrict $\mathscr{M}$ to a unit disk $\D$ in the condition (R), then the restricted meromorphic connection satisfies condition (\rmnum{2}) on the unit disk $\D$. By \cref{D-module mero conn over C regular iff}, this means that the restriction is a regular meromorphic connection at $0\in\D$. So $\mathscr{N}$ satisfies the condition (R), and hence regular.
\end{proof}

\begin{theorem}[\textbf{Deligne}]\label{D-module mero conn regular de Rham functor isomorphism}
Let $D$ be a divisor on a complex manifold $X$ and let $j:Y=X\setminus D\to X$ be the embedding. Let $\mathscr{M}$ be a regular meromorphic connection along $D$. Then the natural morphisms
\[DR_X(\mathscr{M})\to Rj_*j^{-1}DR_X(\mathscr{M}),\quad R\Gamma(X,DR_X(\mathscr{M}))\to R\Gamma(Y,DR_Y(\mathscr{M}|_Y))\]
are isomorphisms.
\end{theorem}
\begin{proof}
It suffices to prove that $DR_X(\mathscr{M})\to Rj_*j^{-1}DR_X(\mathscr{M})$ is an isomorphism, since the second assertion follows by taking $R\Gamma$. We first consider the case where $D$ is normal crossing. The problem being local on $X$, we may assume that $X=\D^n$ and $Y=(\D^*)^r\times\D^{n-r}$, where $\D$ is the unit disk in $\C$ and $\D^*=\D\setminus\{0\}$. Recall that $\Conn^{\reg}(X,D)$ is equivalent to $\Loc(Y)$, so by $\pi_1(Y)=\pi_1(((\C^\times)^r\times\C^{n-r})^{\an})$, we can assume that $X=(\C^n)^{\an}$ and $Y=((\C^\times)^r\times\C^{n-r})^{\an}$, where $\C^n,\C^\times$ and $\C^{n-r}$ are regareded as algebraic varieties. We can assume also that $\mathscr{M}$ is a simple object of $\Conn^{\reg}(X,D)$. Indeed, let
\[\begin{tikzcd}
0\ar[r]&\mathscr{M}_1\ar[r]&\mathscr{M}_2\ar[r]&\mathscr{M}_3\ar[r]&0
\end{tikzcd}\]
be an exact sequence in this category, and denote by $\Phi_i:DR_X(\mathscr{M}_i)\to Rj_*j^{-1}(\mathscr{M}_i)$ the natural morphisms, where $i=1,2,3$. Then $\Phi_2$ is an isomorphism if $\Phi_1$ and $\Phi_3$ are as well. By $\pi_1(Y)\cong\Z^r$, we see that there exists $\lambda_1,\dots,\lambda_r\in\C$ such that
\begin{equation}
\mathscr{M}\cong(\mathscr{M}_{\lambda_1}\boxtimes\cdots\boxtimes\mathscr{M}_{\lambda_r}\boxtimes\mathscr{O}_{\C^{n-r}})^{\an}
\end{equation}
where for $\lambda\in\C$ we denote by $\mathscr{M}_\lambda$ the (algebraic) $\mathscr{D}_{\C}$-module given by $\mathscr{M}_\lambda=\mathscr{D}_\C/\mathscr{D}_\C(x\partial-\lambda)$. By (\cite{Hotta} Proposition 4.7.8), we then obtain
\[DR_X(\mathscr{M})\cong DR_{\C}(\mathscr{M}_{\lambda_1})\boxtimes_{\C}\cdots\boxtimes_{\C}DR_{\C}(\mathscr{M}_{\lambda_r})\boxtimes_{\C}\C_{(\C^{n-r})^{\an}}.\]
Therefore, it suffices to show that $DR_\C(\mathscr{M}_\lambda)\cong Rj_*j^{-1}(\mathscr{M}_\lambda)$ where $j:\C^\times\to\C$ is the canonical embedding. Since the canonical morphism $DR_\C(\mathscr{M}_\lambda)\cong Rj_*j^{-1}(\mathscr{M}_\lambda)$ is an isomorphism outside of the origin, we only need to show the isomorphism $DR_\C(\mathscr{M}_\lambda)_0\cong Rj_*j^{-1}(\mathscr{M}_\lambda)_0$ for the stalks at $0$. Set $\nabla=\partial-\frac{\lambda}{x}$, then $DR_\C(\mathscr{M}_\lambda)_0$ and $ Rj_*j^{-1}(\mathscr{M}_\lambda)_0$ are represented, respectively, by the complexes
\[[\mathscr{K}\stackrel{\nabla}{\longrightarrow}\mathscr{K}],\quad [\bigtilde{\mathscr{K}}\stackrel{\nabla}{\longrightarrow}\bigtilde{\mathscr{K}}],\]
where $\mathscr{K}=\mathscr{O}_{\C^{\an}}[x^{-1}]$ and $\bigtilde{K}=j_*(\mathscr{O}_{(\C^\times)^\an})$. From this we easily see by considering the Laurent series expansions of functions in $\mathscr{K}$ and $\bigtilde{\mathscr{K}}$ that $DR_{\C}(\mathscr{M}_\lambda)_0\to Rj_*j^{-1}(\mathscr{M}_\lambda)_0$ is an isomorphism.\par
Now we consider the general case where $D$ is an arbitrary divisor on $X$. By Hironaka's theorem there exists a proper surjective morphism $f:X'\to X$ of complex manifolds such that $D'=f^{-1}(D)$ is a normal crossing divisor on $X'$ and the restriction $X'\setminus D'\to X\setminus D$ of $f$ is an isomorphism. We denote by $j':X'\setminus D'\to X'$ the embedding. By \cref{D-module mero conn Deligne correspondence} and \cref{D-module mero conn direct image under proper birational}, there exists a regular meromorphic connection $\mathscr{M}'$ on $X'$ along $D'$ such that $\mathscr{N}\cong f_+(\mathscr{M}')$. Then we have
\begin{align*}
DR_X(\mathscr{M})\cong DR_X(f_+(\mathscr{M}'))\cong Rf_*DR_{X'}(\mathscr{M}')\cong Rf_*Rj'_*j'^{-1}DR_{X'}(\mathscr{M}')\cong Rh_*j^{-1}DR_X(\mathscr{M})
\end{align*}
by \cref{D-module analytic DR_X and higher direct image}, which completes the proof.
\end{proof}

\subsection{Regular integrable connections on algebraic varieties}\label{D-module integrable connection regular subsection}
In this subsection $X$ denotes a smooth algebraic variety. The corresponding complex manifold is denoted by $X^{\an}$. Assume that we are given an open embedding $j:X\to V$ of $X$ into a smooth variety $V$ such that $D:=V\setminus X$ is a divisor on $V$. We set $\mathscr{O}_V(D)=j_*(\mathscr{O}_X)$. As in the analytic situation, $\mathscr{O}_V(D)$ is a coherent sheaf of rings. We say that a $\mathscr{D}_V$-module is an \textbf{algebraic meromorphic connection along $\bm{D}$} if it is isomorphic as an $\mathscr{O}_V$-module to a coherent $\mathscr{O}_V(D)$-module. We denote by $\Conn(V,D)$ the category of algebraic meromorphic connections along $D$, which is an abelian category. Unlike the analytic situation, an extension of an integrable connection on $X$ to an algebraic meromorphic connection on $V$ is unique as follows.

\begin{lemma}\label{D-module algebraic mero conn equivalence of cat}
The functor $j^{-1}:\Conn(V,D)\to\Conn(X)$ induces an equivalence of categories, whose quasi-inverse is given by $j_*$.
\end{lemma}
\begin{proof}
This follows easily from the fact that the category of coherent $\mathscr{O}_V(D)$-modules is naturally equivalent to that of coherent $\mathscr{O}_X$-modules.
\end{proof}
It follows that $\Conn(V,D)$ is a subcategory of $\Mod_h(\mathscr{D}_V)$ by \cref{D-module direct and inverse image of holonomic module prop}. An integrable connection $\mathscr{M}$ on $X$ is called \textbf{regular} if for any morphism $i_C:C\to X$ from a smooth algebraic curve $C$ the induced integrable connection $i^*_C(\mathscr{M})$ on $C$ is regular in the sense of \ref{D-module mero conn on algebraic curve paragraph}. We denote by $\Conn^{\reg}(X)$ the full subcategory $\Conn(X)$ consisting of regular integrable connections.

\begin{proposition}\label{D-module algebraic mero conn regular prop}
Let $X$ be a smooth algebraic variety.
\begin{enumerate}
    \item[(a)] Let $0\to\mathscr{M}'\to\mathscr{M}\to\mathscr{M}''\to 0$ be an exact sequence of integrable connections on $X$. Then $\mathscr{M}$ is regular if and only if $\mathscr{M}'$ and $\mathscr{M}''$ are regular.
    \item[(b)] Let $\mathscr{M}$ and $\mathscr{N}$ be regular integrable connections on $X$. Then the integrable connections $\mathscr{M}\otimes_{\mathscr{O}_X}\mathscr{N}$ and $\sHom_{\mathscr{O}_X}(\mathscr{M},\mathscr{N})$ are regular. 
\end{enumerate}

\end{proposition}
\begin{proof}
This follows from \cref{D-module mero conn over C regular and exact sequence} and \cref{D-module mero conn over C regular Hom and tensor}.
\end{proof}

We give below some criteria for the regularity of integrable connections. Let us take a smooth completion $j:X\hookrightarrow\widebar{X}$ of $X$ such that $D=\widebar{X}\setminus X$ is a divisor on $X$. Such a completion always exists thanks to Hironaka"s theorem (in fact, we can take a completion $X$ so that $D=\widebar{X}\setminus X$ is a normal crossing divisor). We call such a completion $\widebar{X}$ of $X$ a \textbf{divisor completion}. For a divisor completion $j:X\hookrightarrow\widebar{X}$ of $X$, we can consider the analytic meromorphic connection
\[j_*(\mathscr{M})^{\an}=\mathscr{O}_{\widebar{X}^{\an}}\otimes_{\mathscr{O}_{\widebar{X}}}j_*(\mathscr{M})\in\Conn(\widebar{X}^{\an},D^{\an})\]
on $\widebar{X}^{\an}$ along $D^{\an}$.

\begin{proposition}\label{D-module algebraic mero conn regular iff divisorial completion}
The following three conditions on an integrable connection $\mathscr{M}$ on $X$ are equivalent:
\begin{enumerate}
    \item[(\rmnum{1})] $\mathscr{M}$ is a regular integrable connection.
    \item[(\rmnum{2})] For some divisor completion $j:X\hookrightarrow\widebar{X}$ of $X$ the analytic meromorphic connection $j_*(\mathscr{M})^{\an}$ is regular.
    \item[(\rmnum{3})] For any divisor completion $j:X\hookrightarrow\widebar{X}$ of $X$ the analytic meromorphic connection $j_*(\mathscr{M})^{\an}$ is regular.
\end{enumerate}
\end{proposition}
\begin{proof}
We first prove the part (\rmnum{2})$\Rightarrow$(\rmnum{1}). Assume that for a divisor completion $j:X\hookrightarrow\widebar{X}$ the meromorphic connection $j_*(\mathscr{M})^{\an}$ is regular. We need to show that for any morphism $i_C:C\to X$ from an algebraic curve $C$ the induced integrable connection $i_C^*(\mathscr{M})$ is regular. We may assume that the image of $C$ is not a single point. We take a smooth completion $j_C:C\hookrightarrow\widebar{C}$ of $C$ and a morphism $i_{\widebar{C}}:\widebar{C}\to\widebar{X}$ so that the following diagram
\[\begin{tikzcd}
C\ar[r,"j_C"]\ar[d,swap,"i_C"]&\widebar{C}\ar[d,"i_{\widebar{C}}"]\\
X\ar[r,"j"]&\widebar{X}
\end{tikzcd}\]
is commutative. We may also assume that this diagram is cartesian by replacing $C$ with $i_{\widebar{C}}^{-1}(X)$ (see \cref{D-module integral connection on curve restriction regular}). In this situation we have a natural isomorphism
\[((j_C)_*i_C^*(\mathscr{M}))^{\an}\cong i_{\widebar{C}}^*j_*(\mathscr{M})^{\an}\cong (i_{\widebar{C}}^{\an})^*(j_*(\mathscr{M})^{\an}).\]
Since $j_*(\mathscr{M})^{\an}$ is regular, $(i_{\widebar{C}}^{\an})^*(j_*(\mathscr{M})^{\an})$ (and hence $((j_C)_*i_C^*(\mathscr{M}))^{\an}$) is regular by the definition of (analytic) regular meromorphic connections. It follows that $i_C^*(\mathscr{M})$ is regular by \cref{D-module mero conn over curve regular iff analytic}.\par
It remains to show that (\rmnum{1})$\Rightarrow$(\rmnum{3}). By \cref{D-module mero conn condition R is regular}~(a), it is sufficient to verify the condition (R) for $j_*(\mathscr{M})^{\an}$. We can take $\varphi$ in the condition (R) so that $\varphi_x=\varphi|_{\D\times\{x\}}$ comes from an algebraic morphism, for which the condition (R) can be easily checked by the argument used in the proof of (\rmnum{2})$\Rightarrow$(\rmnum{1}).
\end{proof}

Let $j:X\hookrightarrow\widebar{X}$ be a divisor completion of $X$ such that $D=\widebar{X}-X$ is normal crossing. In this situation we give another criterion of the regularity of an integrable connection $\mathscr{M}$ on $X$. Let $\mathscr{D}$ be the defining ideal of $D$ and consider the sheaf
\[\Theta_{\widebar{X}}[D]=\{v\in\Theta_X:v\mathscr{I}\sub\mathscr{I}\}\]
as in the analytic case. We denote by $\mathscr{D}_{\widebar{X}}[D]$ the subalgebra of $\mathscr{D}_{\widebar{X}}$ generated by $\Theta_{\widebar{X}}$ and $\mathscr{O}_{\widebar{X}}$. In terms of a local coordinate $\{x_i,\partial_i\}$ of $\widebar{X}$ for which $D$ is defined by $x_1\cdots x_r=0$, $\Theta_{\widebar{X}}[D]$ is generated by $x_1\partial_1,\dots,x_r\partial_r,\partial_{r+1},\dots,\partial_n$ over $\mathscr{O}_{\widebar{X}}$. 

\begin{theorem}[\textbf{Deligne}]\label{D-module algebraic mero conn divisorial NC regular iff}
Under the above notation the following three conditions on an integrable connection $\mathscr{M}$ on $X$ are equivalent to each other:
\begin{enumerate}
    \item[(\rmnum{1})] $\mathscr{M}$ is regular.
    \item[(\rmnum{2})] The $\mathscr{D}_{\widebar{X}}$-module $j_*(\mathscr{M})$ is a union of $\mathscr{O}_{\widebar{X}}$-coherent $\mathscr{D}_{\widebar{X}}[D]$-submodules.
    \item[(\rmnum{3})] For any irreducible component $D_0$ of $D$, there exists an open dense subset $D'\sub D_0$ satisfying the condition: For each point $p\in D'$, there exists an algebraic curve $\widebar{C}\sub\widebar{X}$ which intersects with $D'$ transversally at $p$ and such that the integrable connection $i_C^*(\mathscr{M})$ on $C=\widebar{C}-\{p\}$ (where $i_C:C\hookrightarrow X$) has a regular singularity at $p\in\widebar{C}$.
\end{enumerate}
\end{theorem}
\begin{proof}
It is clear that (\rmnum{1})$\Rightarrow$(\rmnum{3}). Conversely, under the condition (\rmnum{3}), the corresponding analytic meromorphic connection $\mathscr{N}=j_*(\mathscr{M})^{\an}$ satisfies the condition (R), so $j_*(\mathscr{M})^{\an}$ is regular by \cref{D-module mero conn condition R is regular}~(a).\par
Now assume that $\mathscr{M}$ is regular. Then $\mathscr{N}=j_*(\mathscr{M})^{\an}$ is an analytic meromorphic connection along $D^{\an}$. By \cref{D-module mero conn regular iff union of Theta stable submodule}, $\mathscr{N}$ is a union of $\Theta_{\widebar{X}^{\an}}[D^{\an}]$-stable coherent $\mathscr{O}_{\widebar{X}^{\an}}$-submodules $\bigtilde{\mathscr{L}}_i$. Since $\widebar{X}$ is projective, for each $i$ there exists a coherent $\mathscr{O}_{\widebar{X}}$-submodule $\mathscr{L}_i$ of $j_*(\mathscr{M})$ such that $\mathscr{L}_i^{\an}=\widetilde{\mathscr{L}}_i$. Denote by $\mathscr{N}_i$ the image of $\Theta_{\widebar{X}}[D]\otimes_{\C}\mathscr{L}_i\to j_*(\mathscr{M})$, then by $\mathscr{N}_i^{\an}\sub\mathscr{L}_i^{\an}$, we obtain $\mathscr{N}_i\sub\mathscr{L}_i$ by GAGA. Namely, each $\mathscr{L}_i$ is $\Theta_{\widebar{X}}[D]$-stable. Since we have $\bigcup_i\mathscr{L}_i=j_*(\mathscr{M})$, the condition of (\rmnum{2}) holds.\par
Conversely, if (\rmnum{2}) holds, then the $\mathscr{D}_{\widebar{X}^{\an}}$-module $j_*(\mathscr{M})^{\an}$ is a union of $\Theta_{\widebar{X}^{\an}}[D^{\an}]$-stable coherent $\mathscr{O}_{\widebar{X}^{\an}}$-submodules, and hence is a regular meromorphic connection along $D^{\an}$ by \cref{D-module mero conn regular iff union of Theta stable submodule}. Therefore, $\mathscr{M}$ is regular by \cref{D-module algebraic mero conn regular iff divisorial completion}.
\end{proof}

The following version of the Riemann-Hilbert correspondence in the algebraic situation will play fundamental roles in establishing more general correspondence for algebraic regular holonomic $\mathscr{D}_X$-modules.

\begin{theorem}[\textbf{Deligne}]\label{D-module algebraic regular equivalence}
Let $X$ be a smooth algebraic variety. Then the functor $\mathscr{M}\mapsto\mathscr{M}^{\an}$ induces an equivalence of categories
\[\Conn^{\reg}(X)\stackrel{\sim}{\to} \Conn(X^{\an})\]

\end{theorem}

\begin{corollary}\label{D-module algebraic regular equivalent to Loc}
For a smooth algebraic variety $X$ we have an equivalence of categories
\[\Conn^{\reg}(X)\stackrel{\sim}{\to} \Loc(X^{\an}).\]
\end{corollary}
\begin{proof}
This follows from \cref{D-module algebraic regular equivalence} and \cref{D-module analytic integral connection and local system}.
\end{proof}

The rest of this paragraph is devoted to the proof of \cref{D-module algebraic regular equivalence}. We fix a divisor completion $j:\widebar{X}\hookrightarrow X$ of $X$ and set $D=\widebar{X}\setminus X$. We denote by $\Conn^{\reg}(\widebar{X},D)$ the full subcategory of $\Conn(\widebar{X},D)$ consisting of $\mathscr{M}\in\Conn(\widebar{X},D)$ such that $\mathscr{M}|_X$ is regular. Then we have the following commutative diagram
\[\begin{tikzcd}
\Conn^{\reg}(\widebar{X},D)\ar[r]\ar[d]&\Conn^{\reg}(\widebar{X}^{\an},D^{\an})\ar[d]\\
\Conn^{\reg}(X)\ar[r]&\Conn(X^{\an})
\end{tikzcd}\]
where vertical arrows are given by restrictions and horizontal arrows are given by $\mathscr{M}\mapsto\mathscr{M}^{\an}$. Since the vertical arrows are equivalences by \cref{D-module algebraic mero conn equivalence of cat} and \cref{D-module mero conn Deligne correspondence}, our assertion is equivalent to the equivalence of
\begin{equation}\label{D-module algebraic regular equivalence-1}
\Conn^{\reg}(\widebar{X},D)\to\Conn^{\reg}(\widebar{X}^{\an},D^{\an}).
\end{equation}
We denote by $\Coh(\mathscr{O}_{\widebar{X}}(D))$ (resp. $\Coh^e(\mathscr{O}_{\widebar{X}^{\an}}(D^{\an}))$) the category of coherent $\mathscr{O}_{\widebar{X}}(D)$-modules (resp. the category of coherent $\mathscr{O}_{\widebar{X}^{\an}}(D^{\an})$-modules generated by a coherent $\mathscr{O}_{\widebar{X}^{\an}}$-submodule.) Note that any coherent $\mathscr{O}_{\widebar{X}}(D)$-module is generated by its coherent $\mathscr{O}_X$-submodule.\par
By \cref{D-module mero conn condition R is regular}, any regular meromorphic connection on $\widebar{X}^{\an}$ along $D^{\an}$ is effective. We denote by $\Conn^e(\widebar{X}^{\an},D^{\an})$ the full subcategory of effective meromorphic connections on $\widebar{X}^{\an}$ along $D^{\an}$. By \cref{D-module algebraic mero conn regular iff divisorial completion} the equivalence of (\ref{D-module algebraic regular equivalence-1}) can be deduced from the equivalence of
\begin{equation}\label{D-module algebraic regular equivalence-2}
\Conn(\widebar{X},D)\to\Conn^e(\widebar{X}^{\an},D^{\an}).
\end{equation}
To see the equivalence (\ref{D-module algebraic regular equivalence-2}), we first prove the following lemma.

\begin{lemma}\label{D-module module along divisor analytic prop}
The functor
\[\Coh(\mathscr{O}_{\widebar{X}}(D))\to\Coh^e(\mathscr{O}_{\widebar{X}^{\an}}(D^{\an}))\]
given by $\mathscr{M}\mapsto\mathscr{M}^{\an}$ is an equivalence of categories.
\end{lemma}
\begin{proof}

\end{proof}

Note that $\Conn(\widebar{X},D)$ consists of pairs $(\mathscr{M},\nabla)$ of $\mathscr{M}\in\Coh(\mathscr{O}_{\widebar{X}}(D))$ and a flat connection $\nabla\in\Hom_{\C}(\mathscr{M},\Omega_{\widebar{X}}^1\otimes_{\mathscr{O}_{\widebar{X}}}\mathscr{M})$. In view of \cref{D-module module along divisor analytic prop}, $\Conn^e(\widebar{X}^{\an},D^{\an})$ is equivalent to the category consisting of pairs $(\mathscr{M},\widetilde{\nabla})$ of $\mathscr{M}\in\Coh(\mathscr{O}_{\widebar{X}}(D))$ and a flat connection $\widetilde{\nabla}\in\Hom_{\C}(\mathscr{M}^{\an},\Omega_{\widebar{X}^\an}^1\otimes_{\mathscr{O}_{\widebar{X}^{\an}}}\mathscr{M}^{\an})$. It then suffices to show that for $\mathscr{M}\in\Mod(\mathscr{O}_{\widebar{X}}(D))$ the set $\Lambda$ of flat connections $\nabla\in\Hom_{\C}(\mathscr{M},\Omega_{\widebar{X}}^1\otimes_{\mathscr{O}_{\widebar{X}}}\mathscr{M})$ are in bijective correspondence to the set $\tilde{\Lambda}$ flat connections $\widetilde{\nabla}\in\Hom_{\C}(\mathscr{M}^{\an},\Omega_{\widebar{X}^\an}^1\otimes_{\mathscr{O}_{\widebar{X}^{\an}}}\mathscr{M}^{\an})$. Since these two sets are defined by $\C$-linear morphisms (not by $\mathscr{O}$-linear morphisms), we cannot directly use GAGA. We will show the correspondence by rewriting the conditions in terms of $\mathscr{O}$-linear morphisms.\par
We first show that the set $\Lambda_1$ of connections $\nabla\in\Hom_{\C}(\mathscr{M},\Omega_{\widebar{X}}^1\otimes_{\mathscr{O}_{\widebar{X}}}\mathscr{M})$ are in bijective correspondence to the set $\tilde{\Lambda}_1$ of connections $\widetilde{\nabla}\in\Hom_{\C}(\mathscr{M}^{\an},\Omega_{\widebar{X}^\an}^1\otimes_{\mathscr{O}_{\widebar{X}^{\an}}}\mathscr{M}^{\an})$. For this, we need the notaion of differential operators. Let $Y$ be a complex manifold or a smooth algebraic variety. For $\mathscr{O}_Y$-modules $\mathscr{K}$ and $\mathscr{L}$, we define subsheaves $F_p\mathscr{D}(\mathscr{K},\mathscr{L})$ (for $p\in\Z$) of $\sHom_{\C}(\mathscr{K},\mathscr{L})$ recursively by $F_p\mathscr{D}(\mathscr{K},\mathscr{L})=0$ for $p<0$ and
\[F_p\mathscr{D}(\mathscr{K},\mathscr{L})=\{P\in\sHom_{\C}(\mathscr{K},\mathscr{L}):\text{$[P,f]\in F_{p-1}\mathscr{D}(\mathscr{K},\mathscr{L})$ for $f\in\mathscr{O}_Y$}\}\]
for $p\geq 0$. The sections of $F_p\mathscr{D}(\mathscr{K},\mathscr{L})$ are called differential operators of order $p$.\par
We can also give a different description of $F_p\mathscr{D}(\mathscr{K},\mathscr{L})$. Let $\Delta:Y\to Y\times Y$ be the diagonal embedding and let $\pr_i:Y\times Y\to Y$ ($i=1,2$) be the projections. We denote by $\mathfrak{I}\sub\mathscr{O}_{Y\times Y}$ the defining ideal of $\Delta(Y)$. By taking $\Delta^{-1}$ of the canonical morphism $\pr_i^{-1}(\mathscr{O}_Y)\to\mathscr{O}_{Y\times Y}$, we obtain two ring homomorphisms
\[\alpha_i:\mathscr{O}_Y=\Delta^{-1}\pr_i^{-1}(\mathscr{O}_Y)\to\Delta^{-1}(\mathscr{O}_{Y\times Y}).\]
In particular, we have tow $\mathscr{O}_Y$-module structures on $\Delta^{-1}(\mathscr{O}_{Y\times Y})$. Since $\mathfrak{I}$ is an ideal of $\mathscr{O}_{Y\times Y}$, we also have two $\mathscr{O}_Y$-module structure on each $\Delta^{-1}(\mathfrak{I}^k)$ and $\Delta^{-1}(\mathfrak{I}^k/\mathfrak{I}^{l})$ for $k<l$. Note that the two $\mathscr{O}_Y$-module structure on $\Delta^{-1}(\mathfrak{I}^k/\mathfrak{I}^{k+1})$ coincide, and that $\Delta^{-1}(\mathfrak{I}/\mathfrak{I}^2)$ is identified with $\Omega_Y^1$.\par 
Now consider the sheaf $\sHom_{\mathscr{O}_Y}(\Delta^{-1}(\mathscr{O}_{Y\times Y})\otimes_{\mathscr{O}_Y}\mathscr{K},\mathscr{L})$, where the tensor $\Delta^{-1}(\mathscr{O}_{Y\times Y})\otimes_{\mathscr{O}_Y}\mathscr{K}$ is taken with respect to the $\mathscr{O}_Y$-module structure induced by $\alpha_2$, and it is regarded as an $\mathscr{O}_Y$-module via the $\mathscr{O}_Y$-module structure on $\Delta^{-1}(\mathscr{O}_{Y\times Y})$ induced by $\alpha_1$. Define
\[\beta:\sHom_{\mathscr{O}_Y}(\Delta^{-1}(\mathscr{O}_{Y\times Y})\otimes_{\mathscr{O}_Y}\mathscr{K},\mathscr{L})\to\sHom_{\C}(\mathscr{K},\mathscr{L}),\quad \psi\mapsto (s\mapsto\psi(1\otimes s)).\]

\begin{lemma}\label{D-module differential operator char by sHom image}
The morphism $\beta$ induces an isomorphism
\[\sHom_{\mathscr{O}_Y}(\Delta^{-1}(\mathscr{O}_{Y\times Y}/\mathfrak{I}^{p+1})\otimes_{\mathscr{O}_Y}\mathscr{K},\mathscr{L})\cong F_p\mathscr{D}(\mathscr{K},\mathscr{L}).\]
\end{lemma}
We now return to the proof of (\ref{D-module algebraic regular equivalence-2}). Note that we have
\[\Lambda_1\sub F_1\mathscr{D}(\mathscr{M},\Omega_{\widebar{X}}^1\otimes_{\mathscr{O}_{\widebar{X}}}\mathscr{M}),\quad \tilde{\Lambda}_1\sub F_1\mathscr{D}(\mathscr{M}^{\an},\Omega_{\widebar{X}^{\an}}^1\otimes_{\mathscr{O}_{\widebar{X}^{\an}}}\mathscr{M}^{\an}).\] 
By examining the connection condition, we see by \cref{D-module differential operator char by sHom image} that $\Lambda_1$ is in bijective correspondence with the set
\[\{\varphi\in\Hom_{\mathscr{O}_{\widebar{X}}}(\Delta^{-1}(\mathscr{O}_{\widebar{X}\times\widebar{X}}/\mathfrak{I}^2)\otimes_{\mathscr{O}_{\widebar{X}}}\mathscr{M},\Omega_{\widebar{X}}^1\otimes_{\mathscr{O}_{\widebar{X}}}\mathscr{M}):\varphi|_{\Omega_{\widebar{X}}^1\otimes_{\mathscr{O}_{\widebar{X}}}\mathscr{M}}=\id\},\]
where we identify $\Delta^{-1}(\mathfrak{I}/\mathfrak{I}^2)$ with $\Omega_{\widebar{X}}^1$. The same argument holds true in the analytic category and we have a similar description of $\tilde{\Lambda}_1$. Now we can apply GAGA to conclude that $\tilde{\Lambda}_1$ is in bijective correspondence with $\Lambda_1$.\par
We finaly give a reformulation of the flatness condition for connections. For a connection $\nabla\in\Hom_{\C}(\mathscr{M},\Omega_{\widebar{X}}^1\otimes_{\mathscr{O}_{\widebar{X}}}\mathscr{M})$, we define $\nabla^1\in\Hom_{\C}(\Omega_{\widebar{X}}^1\otimes_{\mathscr{O}_{\widebar{X}}}\mathscr{M},\Omega_{\widebar{X}}^2\otimes_{\mathscr{O}_{\widebar{X}}}\mathscr{M})$ by the formula
\[\nabla^1(\omega\otimes s)=d\omega\otimes s-\omega\wedge\nabla s.\] 
Then we have $\nabla^1\circ\nabla\in\Hom_{\mathscr{O}_{\widebar{X}}}(\mathscr{M},\Omega^2_{\widebar{X}}\otimes_{\mathscr{O}_{\widebar{X}}}\mathscr{M})$, and $\nabla$ is a flat connection if and only if $\nabla^1\circ\nabla=0$ (in fact, $\nabla$ can be seen as an extension of $\nabla$, and the curvature operator is given by $\nabla^1\circ\nabla$). This gives a reformulation of the flatness condition in terms of an $\mathscr{O}$-linear morphism. In the analytic category we also have a similar reformulation, and we can then apply GAGA to obtain the desired bijection $\Lambda\cong\tilde{\Lambda}$. The proof of \cref{D-module algebraic regular equivalence} is now complete.

\subsection{Regular holonomic \texorpdfstring{$D$}{D}-modules}
There are several mutually equivalent ways to define the regularity of holonomic $D$-modules. Here, following the notes of Bernstein \cite{Ber3}, we adopt a definition based on the classification theorem of simple holonomic $D$-modules (\cref{D-module holonomic simple module char by minimal extension}) and the regularity of integrable connections. One of the advantages of this definition is that it gives a concrete description of regular holonomic $D$-modules.

\begin{definition}\label{D-module holonomic regular def}
Let $X$ be a smooth algebraic variety. We say that a holonomic $\mathscr{D}_X$-module $\mathscr{M}$ is regular if any composition factor of $\mathscr{M}$ is isomorphic to the minimal extension $L(Y,\mathscr{N})$ of some regular integrable connection $\mathscr{N}$ on a locally closed smooth subvariety $Y$ of $X$ such that the inclusion $i:Y\to X$ is affine.
\end{definition}

We denote by $\Mod_{rh}(\mathscr{D}_X)$ the full subcategory of $\Mod_h(\mathscr{D}_X)$ consisting of regular holonomic $\mathscr{D}_X$-modules and by $D^b_{rh}(\mathscr{D}_X)$ the full subcategory of $D^b_h(\mathscr{D}_X)$ consisting of $\mathscr{M}\in D^b_h(\mathscr{D}_X)$ such that $H^i(\mathscr{M})\in\Mod_{rh}(\mathscr{D}_X)$ for each $i\in\Z$. It follows immediately from the above definition that the category $\Mod_{rh}(\mathscr{D}_X)$ of regular holonomic $\mathscr{D}_X$-modules is closed under the operations of taking submodules, quotient modules, and extensions inside $\Qcoh(\mathscr{D}_X)$. Consequently, $\Mod_{rh}(\mathscr{D}_X)$ is an abelian subcategory of $\Mod_h(\mathscr{D}_X)$, and $D^b_{rh}(\mathscr{D}_X)$ is a triangulated subcategory of $D^b_h(\mathscr{D}_X)$.

\begin{remark}
By \cref{D-module algebraic mero conn regular prop} an integrable connection is regular in the sense of \autoref{D-module integrable connection regular subsection} if and only if all of its composition factors are as well. Therefore, we have $\Conn^{\reg}(X)=\Conn(X)\cap\Mod_{rh}(\mathscr{D}_X)$.
\end{remark}

\begin{remark}
Let $C$ be a smooth curve. Then any simple holonomic $\mathscr{D}_C$-module is of the form $L(Y,\mathscr{N})$, where $Y$ consists of a single point or is a (connected) nonempty open subset of $C$, and $\mathscr{N}$ is an integrable connection on $Y$. If $Y$ consists of a single point, then $L(Y,\mathscr{N})$ is always a regular integrable connection, so a holonomic $\mathscr{D}_C$-module is regular in the sense of \cref{D-module holonomic regular def} if and only if it is regular in the sense of \cref{D-module holonomic on curve regular def}.
\end{remark}

The main results of this subsection are the following two theorems.

\begin{theorem}\label{D-module holonomic regular functorial prop}
Let $X$ be a smooth algebraic variety.
\begin{enumerate}
    \item[(a)] The duality functor $D_X$ preserves $D^b_{rh}(\mathscr{D}_X)$.
    \item[(b)] Let $f:X\to Y$ be a morphism of algebraic varieties. Then the functors $f_+,f_!$ sends $D^b_{rh}(\mathscr{D}_X)$ to $D^b_{rh}(\mathscr{D}_Y)$ and the functors $f^+,f^!$ sends $D^r_{rh}(\mathscr{D}_Y)$ to $D^b_{rh}(\mathscr{D}_X)$. 
\end{enumerate}
\end{theorem}

\begin{theorem}[\textbf{Curve testing criterion}]\label{D-module holonomic regular curve testing}
Let $X$ be a smooth algebraic variety. The following conditions on $\mathscr{M}\in D^b_{rh}(\mathscr{D}_X)$ are equivalent:
\begin{enumerate}
    \item[(\rmnum{1})] $\mathscr{M}\in D^b_{rh}(\mathscr{D}_X)$.
    \item[(\rmnum{2})] $i_C^!(\mathscr{M})\in D^b_{rh}(\mathscr{D}_C)$ for any immersion $i_C:C\hookrightarrow X$ of a smooth algebraic curve $C$.
    \item[(\rmnum{3})] $j^!(\mathscr{M})\in D^b_{rh}(\mathscr{D}_C)$ for any morphism $j:C\to X$ from a smooth algebraic curve $C$.
\end{enumerate}
\end{theorem}

\section{Riemann-Hilbert correspondence}
This section is concerned with one of the most important theorems in $D$-module theory. This fundamental theorem, which is now called the Riemann-Hilbert correspondence, establishes an equivalence between the category of regular holonomic $D$-modules and that of perverse sheaves. It builds a bridge from analysis to topology leading us to a number of applications in various fields in mathematics.

\subsection{Commutativity with de Rham functors}
Recall that for a smooth algebraic variety $X$ we have the duality functors
\[D_X:D^b_h(D_X)\to D^b_h(\mathscr{D}_X)^{\op},\quad D_X:D^b_c(X)\to D^b_c(X)^{\op},\]
and for a morphism $f:X\to Y$ of smooth algebraic varieties, we have functors
\begin{alignat*}{3}
f_+&:D^b_h(\mathscr{D}_X)\to D^b_h(\mathscr{D}_Y),&\quad\quad&& Rf_*:D^b_c(X)\to D^b_c(Y),\\
f_!&:D^b_h(\mathscr{D}_X)\to D^b_h(\mathscr{D}_Y),&\quad\quad&& Rf_!:D^b_c(X)\to D^b_c(Y),\\
f^!&:D^b_h(\mathscr{D}_Y)\to D^b_h(\mathscr{D}_X),&\quad\quad&& f^!:D^b_c(Y)\to D^b_c(X),\\
f^+&:D^b_h(\mathscr{D}_Y)\to D^b_h(\mathscr{D}_X),&\quad\quad&& f^{-1}:D^b_c(Y)\to D^b_c(X).
\end{alignat*}

By \cref{D-module holonomic regular functorial prop}, all the functors $D_X$, $f_+,f_!,f^!,f^+$ preserve $D^b_{rh}$. We also know that
\begin{equation}\label{D-module holonomic regular de Rham functor commutativity-1}
D_X(DR_X(\mathscr{M}))\cong DR_X(D_X(\mathscr{M})),\quad \mathscr{M}\in D^b_h(\mathscr{D}_X),
\end{equation}
(see \cref{D-module holonomic dual of DR_X and Sol_X char} and (\cite{Hotta} Proposition 4.7.9)), i.e. the de Rham functor commutes with the duality functors. In this subsection we will also prove the commutativity of the de Rham functor on $D^b_{rh}$ with the inverse and direct image functors.\par

We first note that there exists a canonical morphism
\begin{equation}\label{D-module holonomic regular de Rham functor commutativity-2}
DR_Y(f_+(\mathscr{M}))\to Rf_*(DR_X(\mathscr{M})),\quad \mathscr{M}\in D^b_h(\mathscr{D}_X)
\end{equation}
by (\cite{Hotta} Proposition 4.7.5). Hence by (\ref{D-module holonomic regular de Rham functor commutativity-1}), we also have a canonical morphism
\begin{equation}\label{D-module holonomic regular de Rham functor commutativity-3}
Rf_!(DR_X(\mathscr{M}))\to DR_Y(f_!(\mathscr{M})),\quad \mathscr{M}\in D^b_h(\mathscr{D}_X).
\end{equation}
On the other hand, we also have a canonical morphism
\begin{equation}\label{D-module holonomic regular de Rham functor commutativity-4}
DR_X(f^!(\mathscr{N}))\to f^!(DR_Y(\mathscr{N})),\quad \mathscr{N}\in D^b_h(\mathscr{D}_Y)
\end{equation}
as the image of $\id_{f^!(\mathscr{N})}$ under the composition of morphisms
\begin{align*}
\Hom_{D^b_h(\mathscr{D}_X)}(f^!(\mathscr{N}),f^!(\mathscr{N}))&\cong\Hom_{D^b_h(\mathscr{D}_Y)}(f_!f^!(\mathscr{N}),\mathscr{N})\to \Hom_{D^b_c(Y)}(DR_Y(f_!f^!(\mathscr{N})),DR_Y(\mathscr{N}))\\
&\to \Hom_{D^b_c(Y)}(Rf_!(DR_X(f^!(\mathscr{N}))),DR_Y(\mathscr{N}))\\
&\cong\Hom_{D^b_c(X)}(DR_X(f^!(\mathscr{N})),f^!(DR_Y(\mathscr{N}))).
\end{align*}
Hence by (\ref{D-module holonomic regular de Rham functor commutativity-1}), we also have a canonical morphism
\begin{equation}\label{D-module holonomic regular de Rham functor commutativity-5}
f^{-1}(DR_Y(\mathscr{N}))\to DR_X(f^+(\mathscr{N})),\quad \mathscr{N}\in D^b_h(\mathscr{D}_Y).
\end{equation}

\begin{theorem}\label{D-module holonomic regular de Rham functor isomorphism}
Let $f:X\to Y$ be a morphism of smooth algebraic varieties. Then the canonical morphisms (\ref{D-module holonomic regular de Rham functor commutativity-2})--(\ref{D-module holonomic regular de Rham functor commutativity-5}) are isomorphisms if $\mathscr{M}\in D^b_{rh}(\mathscr{D}_X)$ and $\mathscr{N}\in D^b_{rh}(\mathscr{D}_Y)$. Namely, we have the following isomorphisms of functors:
\begin{align*}
DR_Y\circ f_+\cong f_*\circ DR_X&:D^b_{rh}(\mathscr{D}_X)\to D^b_c(Y),\\
DR_Y\circ f_!\cong Rf_!\circ DR_X&:D^b_{rh}(\mathscr{D}_X)\to D^b_c(Y),\\
DR_X\circ f^!\cong f^!\circ DR_Y&:D^b_{rh}(\mathscr{D}_Y)\to D^b_c(X),\\
DR_X\circ f^+\cong f^{-1}\circ DR_Y&:D^b_{rh}(\mathscr{D}_Y)\to D^b_c(X).
\end{align*}
\end{theorem}
\begin{proof}
Let us show that (\ref{D-module holonomic regular de Rham functor commutativity-2}) is an isomorphism for $\mathscr{M}\in D^b_{rh}(\mathscr{D}_X)$. Note that this is already verified if $f$ is projective (\cite{Hotta} Proposition 4.7.5). We first deal with the case $\mathscr{M}\in\Conn^{\reg}(X)$. By a theorem of Hironaka, $f$ can be factorized as $f=p\circ j$, where $j:X\hookrightarrow\widebar{X}$ is an open embedding such that $\widebar{X}\setminus X$ is a normal crossing divisor on $X$ and $p:\widebar{X}\to Y$ is projective. Hence we may assume that $f=j$. In this case, the assertion follows from \cref{D-module mero conn regular de Rham functor isomorphism} and \cref{D-module algebraic mero conn regular iff divisorial completion}. Now we treat the general case. We may assume $\mathscr{M}\in\Mod_{rh}(\mathscr{D}_X)$. By induction on $\dim(\supp(\mathscr{M}))$, we may also assume that $\mathscr{M}=i_+(\mathscr{L})$, where $i:Z\to X$ is an affine embedding of a smooth locally closed subvariety $Z$ of $X$ and $\mathscr{L}$ is a regular integrable connection on $\mathscr{Z}$. Then we have
\begin{align*}
DR_Y(f_+(\mathscr{M}))&=DR_Y(f_+(i_+(\mathscr{L})))\cong DR_Y((f\circ i)_+(\mathscr{L}))\cong R(f\circ i)_*(DR_Z(\mathscr{L}))\\
&\cong Rf_*(Ri_*(DR_Z(\mathscr{L})))\cong Rf_*(DR_X(i_+(\mathscr{L})))=Rf_*(DR_X(\mathscr{M})).
\end{align*}

Next we show that (\ref{D-module holonomic regular de Rham functor commutativity-4}) is an isomorphism for $\mathscr{N}\in D^b_{rh}(\mathscr{D}_Y)$. Note that this is already verified if $f$ is smooth (\cite{Hotta} Proposition 4.3.3). By factorizing $f$ into a composite of the graph morphism $\Gamma_f:X\to X\times Y$ and the projection $p:X\times Y\to Y$, we have only to deal with the case where $f$ is a closed embedding $i:X\hookrightarrow Y$. Let $j:Y\setminus X\hookrightarrow Y$ be the corresponding open embedding. Then for $\mathscr{N}^b_{rh}(\mathscr{D}_Y)$ we have the following morphism of distinguished triangles:
\[\begin{tikzcd}
DR_Y(i_+i^!(\mathscr{N}))\ar[r]\ar[d,"\psi"]&XR_Y(\mathscr{N})\ar[r]\ar[d,equal]&DR_Y(j_+j^!(\mathscr{N}))\ar[r,"+1"]\ar[d,"\varphi"]&{}\\
Ri_*i^!(DR_Y(\mathscr{N}))\ar[r]&DR_Y(\mathscr{N})\ar[r]&Rj_*j^!(DR_Y(\mathscr{N}))\ar[r,"+1"]&{}
\end{tikzcd}\]
Since $j$ is smooth, we have $DR_{Y\setminus X}j^!(\mathscr{N})\cong j^!(DR_Y(\mathscr{N}))$, so by (\ref{D-module holonomic regular de Rham functor commutativity-2}) applied to $j^!(\mathscr{N})\in D^b_{rh}(\mathscr{D}_{Y\setminus X})$, we have
\[DR_Y(j_+j^!(\mathscr{N}))\cong Rj_*(DR_{Y\setminus X}(j^!(\mathscr{N})))\cong Rj_*j^!(DR_Y(\mathscr{N})),\]
i.e. the morphism $\varphi$ is an isomorphism. We then conclude that $\psi$ is an isomorphism; by 
\[DR_Y(i_+i^!(\mathscr{N}))\stackrel{\sim}{\to} Ri_*(DR_X(i^!(\mathscr{N})))\]
we obtain an isomorphism
\[Ri_*(DR_X(i^!(\mathscr{N})))\cong Ri_*i^!(DR_Y(\mathscr{N})).\]
Note that $i^{-1}Ri_*=\id$ since $i$ is a closed embedding, so we obtain the desired result by applying $i^{-1}$ to the above isomorphism. The remaining assertions follow from the ones proved thus far in view of (\ref{D-module holonomic regular de Rham functor commutativity-1}).
\end{proof}

\subsection{Riemann-Hilbert correspondence}
Now we can state one of the most important results in the theory of $D$-modules, which is now called the Riemann-Hilbert correspondence.

\begin{theorem}\label{D-module holonomic regular DH correspondence}
For a smooth algebraic variety $X$, the de Rham functor
\[DR_X:D^b_{rh}(\mathscr{D}_X)\to D^b_c(X)\]
gives an equivalence of categories.
\end{theorem}
\begin{proof}[\textbf{Sketch of proof}]
We first prove that the functor $DR_X$ is fully faithful, i.e., there exists
an isomorphism
\begin{equation}\label{D-module holonomic regular DH correspondence-1}
\Hom_{D^b_{rh}(\mathscr{D}_X)}(\mathscr{M},\mathscr{N})\stackrel{\sim}{\to} \Hom_{D^b_c(X)}(DR_X(\mathscr{M}),DR_X(\mathscr{N}))
\end{equation}
for $\mathscr{M},\mathscr{N}\in D^b_{rh}(\mathscr{D}_X)$. In fact, we will prove a more general result
\begin{equation}\label{D-module holonomic regular DH correspondence-2}
\Hom_{\mathscr{D}_X}(\mathscr{M},\mathscr{N})\stackrel{\sim}{\to} \Hom_{\C_{X^{\an}}}(DR_X(\mathscr{M}),DR_X(\mathscr{N})).
\end{equation}
Let $\Delta:X\to X\times X$ be the diagonal morphism and $p:X\to\pt$ be the unique morphism from $X$ to the variety pt consisting of a single point. By (\ref{D-module Hom of coh isomorphism by duality-2}) we have
\begin{equation}\label{D-module holonomic regular DH correspondence-3}
R\Hom_{\mathscr{D}_X}(\mathscr{M},\mathscr{N})\cong p_+(\Delta^!(D_X(\mathscr{M})\boxtimes\mathscr{N})).
\end{equation}
To calculate the right-hand side of (\ref{D-module holonomic regular DH correspondence-2}) we need
\begin{equation}\label{D-module holonomic regular DH correspondence-4}
R\Hom_{\C_{X^\an}}(\mathscr{F},\mathscr{G})\cong Rp_*\Delta^!(D_X(\mathscr{F})\boxtimes\mathscr{G}),\quad \mathscr{F},\mathscr{G}\in D^b_c(X).
\end{equation}
This follows by applying $Rp_*=R\Gamma(X,-)$ to the isomorphism
\begin{align*}
\Delta^!(D_X(\mathscr{F})\boxtimes\mathscr{G})&\cong\Delta^!D_{X\times X}(\mathscr{F}\boxtimes D_X(\mathscr{G}))\cong D_X\Delta^{-1}(\mathscr{F}\boxtimes D_X(\mathscr{G}))\cong D_X(\mathscr{F}\otimes_{\C}D_X(\mathscr{G}))\\
&\cong R\!\sHom_{\C}(\mathscr{F}\otimes_{\C}D_X(\mathscr{G}),\omega_X)\cong R\!\sHom_{\C}(\mathscr{F},R\!\sHom_{\C}(D_X(\mathscr{G}),\omega_X))\\
&\cong R\!\sHom_{\C}(\mathscr{F},D_X^2(\mathscr{G}))\cong R\!\sHom_{\C}(\mathscr{F},\mathscr{G}).
\end{align*}
Therefore, by (\cite{Hotta} Proposition 4.7.8), (\cite{Hotta} Proposition 4.7.9) and \cref{D-module holonomic regular de Rham functor isomorphism}, we obtain the desired result by
\begin{align*}
R\Hom_{\C_{X^{\an}}}(DR_X(\mathscr{M}),DR_X(\mathscr{N}))&\cong Rp_*\Delta^!(DR_X(D_X(\mathscr{M}))\boxtimes DR_X(\mathscr{N}))\\
&\cong Rp_*\Delta^!(D_X(DR_X(\mathscr{M}))\boxtimes DR_X(\mathscr{N}))\\
&\cong Rp_*\Delta^!(DR_{X\times X}(D_X(\mathscr{M})\boxtimes \mathscr{N}))\\
&\cong Rp_*DR_X(\Delta^!(D_X(\mathscr{M})\boxtimes\mathscr{N}))\\
&\cong DR_{\pt}p_+(\Delta^!(D_X(\mathscr{M})\boxtimes\mathscr{N}))\\
&\cong p_+\Delta^!(D_X(\mathscr{M})\boxtimes\mathscr{N})\\
&\cong R\Hom_{\mathscr{D}_X}(\mathscr{M},\mathscr{N}),
\end{align*}
where we note that $DR_{\pt}=\id$.\par
It remains to prove that the functor $DR_X$ is essentially surjective, i.e., for any $\mathscr{F}\in D^b_c(X)$ there exists an object $\mathscr{M}\in D^b_{rh}(\mathscr{D}_X)$ satisfying $DR_X(\mathscr{M})\cong\mathscr{F}$. It is enough to check it for generators of the triangulated category $D^b_c(X)$, hence we may assume that $\mathscr{F}=Ri_*(\mathscr{L})\in D^b_c(\C_X)$ for an affine embedding $i:Z\to X$ of a locally closed smooth subvariety $Z$ of $X$ and a local system $\mathscr{L}$ on $Z^{\an}$. By \cref{D-module algebraic regular equivalent to Loc}, there exists a (unique) regular integrable connection $\mathscr{N}$ on $Z$ such that $DR_Z(\mathscr{N})\cong\mathscr{L}[d_Z]$. Set $\mathscr{M}=i_+(\mathscr{N})[-d_Z]\in D^b_{rh}(\mathscr{D}_X)$, then we have
\[DR_X(\mathscr{M})=DR_X(i_+(\mathscr{N})[-d_Z])\cong Ri_*(DR_Z(\mathscr{N}))[-d_Z]\cong Ri_*(\mathscr{L})=\mathscr{F},\]
which completes the proof.
\end{proof}

\begin{corollary}
The solution functor
\[\Sol_X:D^b_{rh}(\mathscr{D}_X)\to D^b_c(X)^{\op}\]
gives an equivalence of categories.
\end{corollary}
\begin{proof}
This follows from \cref{D-module analytic DR and Sol duality relation}.
\end{proof}

The image of the full subcategory $\Mod_{rh}(\mathscr{D}_X)$ of $D^b_{rh}(\mathscr{D}_X)$ under the de Rham functor $DR_X:D^b_{rh}(\mathscr{D}_X)\to D^b_c(X)$ is described by the following theorem.

\begin{theorem}\label{D-module holonomic regular de Rham image of Mod}
The de Rham functor induces an equivalence
\[DR_X:\Mod_{rh}(\mathscr{D}_X)\to \Perv(\C_X)\]
of categories. In particular, $\Perv(\C_X)$ is an abelian category.
\end{theorem}

The rest of this subsection is devoted to the proof of \cref{D-module holonomic regular de Rham image of Mod}. For $n\in\Z$ we denote by $D^{\geq n}_h(\mathscr{D}_X)$ (resp. $D^{\leq n}_h(\mathscr{D}_X)$) the full subcategory of $D^b_h(\mathscr{D}_X)$ consisting of $\mathscr{M}$ satisfying $H^i(\mathscr{M})=0$ for $i<n$ (resp. $i>n$). We also define full subcategories $D^{\geq n}_c(X)$ and $D^{\leq n}_c(X)$ similarly.

\begin{lemma}\label{D-module holonomic regular D^geq 0 and dual}
For $\mathscr{M}\in D^b_h(\mathscr{D}_X)$ we have $\mathscr{M}\in D^{\geq 0}_h(\mathscr{D}_X)$ if and only if $D_X(\mathscr{M})\in D^{\leq 0}_h(\mathscr{D}_X)$.
\end{lemma}
\begin{proof}
We may assume that $\mathscr{M}\in D^{\geq 0}(\mathscr{D}_X)$ and $\mathscr{M}\neq 0$. Let $i$ be the smallest (non-negative) integer such that $H^i(\mathscr{M})=0$. Then we have a distinguished triangle
\[\begin{tikzcd}
H^i(\mathscr{M})[-i]\ar[r]&\mathscr{M}\ar[r]&\tau^{\geq i+1}\mathscr{M}\ar[r,"+1"]&{}
\end{tikzcd}
\]
Hence by induction on the cohomological length of $\mathscr{M}$, it suffices to show that $D_X(\mathscr{N}[-i])\in D^b_h(\mathscr{D}_X)$ for any $\mathscr{N}\in\Mod_h(\mathscr{D}_X)$ and any $i$. This follows from $D_X(\mathscr{N}[-i])=D_X(\mathscr{N})[i]$ and \cref{D-module dual of holonomic prop}~(c). The proof of the converse direction is similar.
\end{proof}

\begin{corollary}\label{D-module holonomic regular derived heart char by duality}
An object $\mathscr{M}\in D^b_h(\mathscr{D}_X)$ belongs to $\Mod_h(\mathscr{D}_X)$ if and only if $\mathscr{M}$ and $D_X(\mathscr{M})$ both belong to $D^{\geq 0}_h(\mathscr{D}_X)$.
\end{corollary}

\begin{lemma}\label{D-module holonomic regular derived D^geq 0 iff smooth subvariety}
The following conditions on $\mathscr{M}\in D^b_h(\mathscr{D}_X)$ are equivalent:
\begin{enumerate}
    \item[(\rmnum{1})] $\mathscr{M}\in D^{\geq 0}_h(\mathscr{D}_X)$.
    \item[(\Rmnum{2})] For any locally closed subvariety $Y$ of $X$, there exists a smooth open dense subset $Y_0$ of $Y$ such that $i_{Y_0}^!(\mathscr{M})\in D^{\geq 0}_h(\mathscr{D}_{Y_0})$ and $H^i(i_{Y_0}^!(\mathscr{M}))$ is coherent over $\mathscr{O}_{Y_0}$ for any $i$, where $i_{Y_0}:Y_0\to X$ denotes the inclusion.
\end{enumerate}
\end{lemma}
\begin{proof}
Assume that $\mathscr{M}\in D^{\geq 0}_h(\mathscr{D}_X)$. In view of \cref{D-module holonomic generically locally free}, it suffices to show that for any smooth open dense subset $Y_0$ of $Y$, we have $i_{Y_0}^!(\mathscr{M})\in D_h^{\geq 0}(\mathscr{D}_{Y_0})$. This follows from the fact that the right $i_{Y_0}^{-1}(\mathscr{D}_X)$-module $\mathscr{D}_{Y_0\rightarrow X}$ locally admits a free resolution of length $d_X-d_{Y_0}$ (cf. \cref{D-module relative D-module resolution}).\par
Conversely, suppose that we have $H^i(\mathscr{M})\neq 0$ for a negative integer $i<0$. Let $i_0$ be the smallest integer satisfying this property, and set $Y=\supp(H^{i_0}(\mathscr{M}))$. It is sufficient to show that $H^{i_0}(i_{Y_0}^!(\mathscr{M}))\neq 0$ for any smooth open dense subset $Y_0$ of $Y$. By applying $i_{Y_0}^!$ to the distinguished triangle
\[\begin{tikzcd}
H^{i_0}(\mathscr{M})[-i_0]\ar[r]&\mathscr{M}\ar[r]&\tau^{\geq i_0+1}(\mathscr{M})\ar[r,"+1"]&{}
\end{tikzcd}\]
we obtain a distinguished triangle
\[\begin{tikzcd}
i_{Y_0}^!(H^{i_0}(\mathscr{M})[-i_0])\ar[r]&i_{Y_0}^!(\mathscr{M})\ar[r]&i_{Y_0}^!(\tau^{\geq i_0+1}(\mathscr{M}))\ar[r,"+1"]&{}
\end{tikzcd}\]
By $H^i(i_{Y_0}^!(\tau^{i_0+1}\mathscr{M}))=0$ for $i\geq i_0$, we have $H^{i_0}(i_{Y_0}^!(\mathscr{M}))\cong H^0(i_{Y_0}^!(H^{i_0}(\mathscr{M})))$, hence the assertion follows from Kashiwara's equivalence.
\end{proof}

\begin{lemma}\label{D-module holonomic regular derived D^geq 0 iff smooth subvariety inverse}
The following conditions on $\mathscr{M}\in D^b_h(\mathscr{D}_X)$ are equivalent:
\begin{enumerate}
    \item[(\rmnum{1})] $\mathscr{M}\in D^{\leq 0}_h(\mathscr{D}_X)$.
    \item[(\Rmnum{2})] For any locally closed subvariety $Y$ of $X$, there exists a smooth open dense subset $Y_0$ of $Y$ such that $i_{Y_0}^+(\mathscr{M})\in D^{\leq 0}_h(\mathscr{D}_{Y_0})$ and $H^i(i_{Y_0}^+(\mathscr{M}))$ is coherent over $\mathscr{O}_{Y_0}$ for any $i$, where $i_{Y_0}:Y_0\to X$ denotes the inclusion.
\end{enumerate}
\end{lemma}
\begin{proof}
This follows from \cref{D-module holonomic regular derived D^geq 0 iff smooth subvariety} and \cref{D-module holonomic regular D^geq 0 and dual}.
\end{proof}

\begin{proof}[\textbf{Proof of \cref{D-module holonomic regular de Rham image of Mod}}]
By \cref{D-module holonomic regular D^geq 0 and dual} and the commutativity of the de Rham functor with the duality functors, it is sufficient to show that the following conditions on $\mathscr{M}\in D^b_{rh}(\mathscr{D}_X)$ are equivalent:
\begin{enumerate}
    \item[(a)] $\mathscr{M}\in D^{\leq 0}_{rh}(\mathscr{D}_X)$.
    \item[(b)] $\dim(\supp(H^i(DR_X(\mathscr{M}))))\leq -i$ for $i\in\Z$.
\end{enumerate}
If $\mathscr{F}=DR_X(\mathscr{M})$, then by \cref{D-module holonomic regular derived D^geq 0 iff smooth subvariety inverse} and the commutativity of the de Rham functor with the inverse image (on $D^b_{rh}$), the condition (a) is equivalent to the following (cf. \cref{D-module analytic integral connection and local system}):
\begin{enumerate}
    \item[(c)] For any locally closed subvariety $Y$ of $X$, there exists a smooth open dense subset $Y_0$ of $Y$ such that $i_{Y_0}^{-1}(\mathscr{F})\in D^{\leq -d_{Y_0}}_c(\mathscr{D}_{Y_0})$ and $H^i(i_{Y_0}^{-1}(\mathscr{F}))$ is a local system for any $i$, where $i_{Y_0}:Y_0\to X$ denotes the inclusion.
\end{enumerate}
Now set $Y=\supp(H^i(\mathscr{F}))$, and take a smooth open dense subset $Y_0$ of $Y$ as in (c). Then by $H^i(i_{Y_0}^{-1}(\mathscr{F}))=i_{Y_0}^{-1}(H^i(\mathscr{F}))\neq 0$, we have $i\leq -d_{Y_0}$, so $\dim(Y)\leq-i$.\par
Conservely, assume the condition in (b) and let $Y$ be a locally closed subvariety of $X$; we assume that $Y$ is connected. Take a stratification $X=\coprod_\alpha X_\alpha$ of $X$ such that $H^i(\mathscr{F})|_{X_\alpha}$ is a local system for any $\alpha$ and $i$. Then there exists some index $\alpha$ such that $Y\cap X_\alpha$ is open dense in $Y$. Let $Y_0$ be a smooth open dense subset of $Y$ contained in $Y\cap X_\alpha$. Since $H^i(i_{Y_0}^{-1}(\mathscr{F}))\cong i_{Y_0}^{-1}(H^i(\mathscr{F}))$ is a local system, it is nonzero only if $d_{Y_0}\leq -i$ by assumption (b), hence we have $i_{Y_0}^{-1}(\mathscr{F})\in D_c^{\leq -d_{Y_0}}(Y_0)$.
\end{proof}

\subsection{Comparison theorem}
As an application of the Riemann-Hilbert correspondence we give a proof of the comparison theorem. This theorem is concerned with historical motivation of the theory of regular holonomic $D$-modules. It is also important from the viewpoint of applications.\par
Let $\widehat{\mathscr{O}}_{X,x}$ be the formal completion of the local ring $\mathscr{O}_{X,x}$. It is identified with the formal power series ring $\C\llbracket x_1,\dots,x_n\rrbracket$ in the local coordinate $\{x_i\}$ of $X$, and the analytic local ring $\mathscr{O}_{X^{\an},x}$ (the ring of convergent power series at $x$) is naturally a subring of $\widehat{\mathscr{O}}_{X,x}$. For each point $x\in X$ and $\mathscr{M}\in D^b(\mathscr{D}_X)$, the inclusion $\mathscr{O}_{X^{\an},x}\hookrightarrow\widehat{\mathscr{O}}_{X,x}$ induces a morphism
\[\nu_x:R\Hom_{\mathscr{D}_{X,x}}(\mathscr{M}_x,\mathscr{O}_{X^{\an},x})\to R\Hom_{\mathscr{D}_{X,x}}(\mathscr{M}_x,\widehat{\mathscr{O}}_{X,x})\]
of complexes, where $\mathscr{M}_x$ is the stalk of $\mathscr{M}$ at $x$. Note that the left-hand side of $\nu_x$ is isomorphic to the stalk $\Sol_X(\mathscr{M})_x$ of $\Sol_X(\mathscr{M})\in D^b(\C_{X^{\an}})$ at $x$. On the other hand, the right-hand side $R\Hom_{\mathscr{D}_{X,x}}(\mathscr{M}_x,\widehat{\mathscr{O}}_{X,x})$ can be considered as a higher-degree generalization of the formal solutions $\Hom_{\mathscr{D}_{X,x}}(\mathscr{M}_x,\widehat{\mathscr{O}}_{X,x})$ of $\mathscr{M}$ at $x$.

\begin{proposition}\label{D-module holonomic regular formal solution isomorphism}
If $\mathscr{M}\in D^b_{rh}(\mathscr{D}_X)$, then $\nu_x$ is an isomorphism for each $x\in X$.
\end{proposition}
\begin{proof}
By \cref{D-module analytic DR and Sol duality relation} and \cref{D-module holonomic regular de Rham functor isomorphism}, we have ($n=\dim(X)$)
\begin{align*}
\Sol_X(\mathscr{M})_x[n]&\cong DR_X(D_X(\mathscr{M}))_x\cong i_x^{-1}(DR_X(D_X(\mathscr{M})))\\
&\cong DR_{\{x\}}(D_{\{x\}}(i_x^!(\mathscr{M})))\cong D_{\{x\}}(i_x^!(\mathscr{M})),
\end{align*}
where $i_x:\{x\}\hookrightarrow X$ is the inclusion. For a $\mathscr{D}_{X,x}$-free resolution $P\to\mathscr{M}_x$ of $\mathscr{M}_x$, we have
\[i_x^!(\mathscr{M})\cong i_x^!(P)=\C\otimes_{\mathscr{O}_{X,x}}P[-n]\]
and hence $\Sol_X(\mathscr{M})_x\cong(\C\otimes_{\mathscr{O}_{X,x}}P)^*$. On the other hand, since $\C\otimes_{\mathscr{O}_{X,x}}\mathscr{D}_{X,x}=\mathscr{D}_{X,x}/\m_x\mathscr{D}_{X,x}\cong\C[\partial_1,\dots,\partial_n]$ (where $\{x_i,\partial_i\}$ is a local coordinate system at $x$), there exists a natural isomorphism
\begin{align*}
\widehat{\mathscr{O}}_{X,x}\stackrel{\sim}{\to}\Hom_{\C}(\mathscr{D}_{X,x}/\m_x\mathscr{D}_{X,x},\C)=(\C\otimes_{\mathscr{O}_{X,x}}\mathscr{D}_{X,x})^*,\quad f\mapsto[p(\partial)\mapsto (p(\partial)f)(x)].
\end{align*}
Therefore, we get
\begin{align*}
\Hom_{\mathscr{D}_{X,x}}(\mathscr{D}_{X,x},\widehat{\mathscr{O}}_{X,x})\cong\widehat{\mathscr{O}}_{X,x}\cong (\C\otimes_{\mathscr{O}_{X,x}}\mathscr{D}_{X,x})^*,
\end{align*}
from which we obtain
\[\Hom_{\mathscr{D}_{X,x}}(P,\widehat{\mathscr{O}}_{X,x})\cong(\C\otimes_{\mathscr{O}_{X,x}}P)^*.\]
Since $P$ is a free resolution of $\mathscr{M}_x$, the left-hand side is isomorphic to $R\Hom_{\mathscr{D}_{X,x}}(\mathscr{M}_x,\widehat{\mathscr{O}}_{X,x})$, therefore we obtain the desired isomorphism.
\end{proof}